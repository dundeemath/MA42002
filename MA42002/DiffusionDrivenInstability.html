<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.3.450" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>MA42002 – 6  Diffusion driven instability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <h1 class="quarto-secondary-nav-title"></h1>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      MA42002
      </a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/dundeemath/MA42002/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="/MA42002.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/conservationequations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Single species</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/linearreactiondiffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Linear reaction diffusion equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/nonlinearreactiondiffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Non linear reaction diffusion equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Multi species</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/LotkaVolteraPDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>Lotka Voltera model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/BacterialChemotaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>Aggregation via Chemotaxis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/DiffusionDrivenInstability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>6</span>  <span class='chapter-title'>Diffusion driven instability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/SIR_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>7</span>  <span class='chapter-title'>Mathematical modelling of infectious disease</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/NumericalMethods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>8</span>  <span class='chapter-title'>Numerical methods in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/linearstablityanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>9</span>  <span class='chapter-title'>Linear stability analysis of a system of nonlinear ODES</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#spatial-pattern-formation-via-reaction-diffusion-mechanisms" id="toc-spatial-pattern-formation-via-reaction-diffusion-mechanisms"><span class="header-section-number">6.1</span> Spatial Pattern Formation via Reaction-Diffusion Mechanisms</a>
  <ul>
  <li><a href="#pattern-in-developmental-biology" id="toc-pattern-in-developmental-biology"><span class="header-section-number">6.1.1</span> Pattern in Developmental Biology</a></li>
  </ul></li>
  <li><a href="#reaction-diffusion-turing-pre-pattern-mechanisms" id="toc-reaction-diffusion-turing-pre-pattern-mechanisms"><span class="header-section-number">6.2</span> Reaction-diffusion (Turing) Pre-pattern Mechanisms</a>
  <ul>
  <li><a href="#schnackenberg-kinetics" id="toc-schnackenberg-kinetics"><span class="header-section-number">6.2.1</span> Schnackenberg kinetics</a></li>
  <li><a href="#gierer-meinhardt-kinetics" id="toc-gierer-meinhardt-kinetics"><span class="header-section-number">6.2.2</span> Gierer &amp; Meinhardt kinetics</a></li>
  <li><a href="#thomas-kinetics" id="toc-thomas-kinetics"><span class="header-section-number">6.2.3</span> Thomas kinetics</a></li>
  </ul></li>
  <li><a href="#non-dimensionalization" id="toc-non-dimensionalization"><span class="header-section-number">6.3</span> Non-dimensionalization</a>
  <ul>
  <li><a href="#schnakenberg" id="toc-schnakenberg"><span class="header-section-number">6.3.1</span> Schnakenberg</a></li>
  <li><a href="#gierer-meinhardt" id="toc-gierer-meinhardt"><span class="header-section-number">6.3.2</span> Gierer-Meinhardt</a></li>
  <li><a href="#thomas" id="toc-thomas"><span class="header-section-number">6.3.3</span> Thomas</a></li>
  <li><a href="#general" id="toc-general"><span class="header-section-number">6.3.4</span> General</a></li>
  </ul></li>
  <li><a href="#numerical-solution" id="toc-numerical-solution"><span class="header-section-number">6.4</span> Numerical solution</a></li>
  <li><a href="#linear-stability-analysis-and-evolution-of-spatial-pattern-general-conditions-for-diffusion-driven-instability" id="toc-linear-stability-analysis-and-evolution-of-spatial-pattern-general-conditions-for-diffusion-driven-instability"><span class="header-section-number">6.5</span> Linear Stability Analysis and Evolution of Spatial Pattern: General Conditions for Diffusion-driven Instability</a>
  <ul>
  <li><a href="#stability-of-spatially-homogeneous-steady-states-to-spatially-homogeneous-perturbations" id="toc-stability-of-spatially-homogeneous-steady-states-to-spatially-homogeneous-perturbations"><span class="header-section-number">6.5.1</span> Stability of spatially homogeneous steady states to spatially homogeneous perturbations</a></li>
  <li><a href="#stability-of-spatially-homogeneous-steady-states-to-spatially-heterogeneous-spatially-dependent-perturbations" id="toc-stability-of-spatially-homogeneous-steady-states-to-spatially-heterogeneous-spatially-dependent-perturbations"><span class="header-section-number">6.5.2</span> Stability of spatially homogeneous steady states to spatially heterogeneous: spatially dependent, perturbations</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises"><span class="header-section-number">6.6</span> Exercises</a></li>
  <li><a href="#references" id="toc-references"><span class="header-section-number">6.7</span> References</a></li>
  </ul>
</nav>
<section id="spatial-pattern-formation-via-reaction-diffusion-mechanisms" class="level2" data-number="6.1">
<h2 data-number="6.1"><span class="header-section-number">6.1</span> Spatial Pattern Formation via Reaction-Diffusion Mechanisms</h2>
<p>** Insert human embryogenesis image **</p>
<section id="pattern-in-developmental-biology" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1"><span class="header-section-number">6.1.1</span> Pattern in Developmental Biology</h3>
<p>Embryology or developmental biology is that part of biology which is concerned with the formation, growth and development of the embryo from fertilization until birth. From the very moment of conception the embryo undergoes a process of dynamic change, brought about largely by cells responding to various chemical signalling cues e.g. migration, differentiation, proliferation. Figure <span class="math inline">\(\ref{embryogenesis}\)</span> shows some of the major changes in embryonic development which occur up to a few weeks after fertilization. Many of the processes occurring at this early stage are vital for the successful subsequent development of the embryo and also lay down basic structures (e.g. <a href="https://en.wikipedia.org/wiki/Somite">somites</a>) that form the foundation of major body structures later on (e.g. the vertebrae of the spine) cf. Professor Lewis Wolpert: ‘<em>It is not birth, marriage, or death, but gastrulation which is truly the most important time in your life.</em>’</p>
<!--
\url{https://en.wikipedia.org/wiki/Lewis\_Wolpert}]. 
-->
<p>There are two main theories which describe how pattern arises during embryogenesis - one is the <strong>Turing pre-pattern theory</strong>, the other is the <strong>mechano-chemical</strong> theory. In the Turing pre-pattern theory, chemicals, or <a href="https://en.wikipedia.org/wiki/Morphogen">morphogens</a>, react together and, if certain conditions concerning their reaction kinetics and diffusion rates are satisfied (to be derived in the next section), then a ## pre-pattern## of varying chemical concentrations is set up in the spatial domain. This means that throughout the spatial domain, the concentration levels of the chemicals will vary i.e. there will be a ##heterogeneous## distribution of chemical concentrations which is known as a pre-pattern. Any cells in the domain which subsequently encounter these varying levels of morphogens will then respond by, for example, proliferating differentially throughout the domain. In this way, the domain will then contain a {spatially heterogeneous} distribution of cell densities (i.e. a cellular pattern) which have responded to the morphogen pre-pattern. This pre-pattern theory was first proposed by Alan Turing (of Enigma Code fame) in his seminal 1952 paper, <em>The chemical basis of morphogenesis</em> <span class="citation" data-cites="turing1990chemical">Turing (<a href="#ref-turing1990chemical" role="doc-biblioref">1990</a>)</span>. This was developed in more detailed manner by Alfred Gierer and Hans Meinhardt in another ground-breaking paper in 1972, <em>A theory of biological pattern formation</em> <span class="citation" data-cites="gierer1972theory"><span>“A Theory of Biological Pattern Formation”</span> (<a href="#ref-gierer1972theory" role="doc-biblioref">1972</a>)</span>, where they introduced the concept of activating chemicals and inhibiting chemicals. J.D. Murray then applied the theory as an explanation for the generation of patterns observed on animal coats <span class="citation" data-cites="murray1981pre">J. Murray (<a href="#ref-murray1981pre" role="doc-biblioref">1981</a>)</span>.</p>
<p>In the mechano-chemical theory, cells interact with their surroundings and by exerting forces perturb their local environment. The combination of cell migration/proliferation and cell-generated forces is sufficient in certain circumstances to create a spatially heterogeneous distribution of cell densities i.e. the pattern is generated <strong>simultaneously</strong> with the cell migration/proliferation. This alternative pattern formation theory was proposed by Murray and Oster <span class="citation" data-cites="murray1984generation">J. D. Murray and Oster (<a href="#ref-murray1984generation" role="doc-biblioref">1984</a>)</span> and is particularly appropriate for patterns generated in early embryogenesis by <strong>mesenchymal cells</strong> such as fibroblasts.</p>
<!--
\url{http://rstb.royalsocietypublishing.org/content/237/641/37}

\url{http://rstb.royalsocietypublishing.org/content/royptb/237/641/37.full.pdf}

\url{https://en.wikipedia.org/wiki/The_Chemical_Basis_of_Morphogenesis} 


\url{http://link.springer.com/article/10.1007\%2FBF00289234}

\url{http://www.eb.tuebingen.mpg.de/de/forschung/emeriti/hans-meinhardt/home.html}

\url{http://www.eb.tuebingen.mpg.de/fileadmin/uploads/pdf/Emeriti/Hans_Meinhardt/kyb.pdf}

\url{http://www.eb.tuebingen.mpg.de/de/forschung/emeriti/hans-meinhardt/82-book/bur82.html}

\url{http://www.eb.tuebingen.mpg.de/de/forschung/emeriti/hans-meinhardt/pattern7.html}

\url{http://www.eb.tuebingen.mpg.de/fileadmin/uploads/pdf/Emeriti/Hans_Meinhardt/Old_paper_pdf/06-Interv-IJDB.pdf} 

\url{http://www.researchgate.net/publication/238718711_A_Prepattern_formation_mechanism_for_animal_coat_markings}

\url{https://en.wikipedia.org/wiki/James_D._Murray}

\url{http://www.maths.ox.ac.uk/people/james.murray/}

\url{https://www.youtube.com/watch?v=6Yj5Nyb_VyU} 
-->
</section>
</section>
<section id="reaction-diffusion-turing-pre-pattern-mechanisms" class="level2" data-number="6.2">
<h2 data-number="6.2"><span class="header-section-number">6.2</span> Reaction-diffusion (Turing) Pre-pattern Mechanisms</h2>
<p>We now consider our general (dimensional) reaction-diffusion model for two chemicals or morphogens with concentrations <span class="math inline">\(A({\mathbf{x}}, t)\)</span> and <span class="math inline">\(B({\mathbf{x}}, t)\)</span> which react together and diffuse in some spatial domain:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial A}{\partial  t} &amp; =  F(A,B)  + D_A \nabla^2 A, \\
\frac{\partial B}{\partial  t} &amp; =  G(A,B)  + D_B \nabla^2 B,
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(F(A,B)\)</span> and <span class="math inline">\(G(A,B)\)</span> describe the reaction kinetics between the two morphogens and <span class="math inline">\(D_A, D_B &gt; 0\)</span> are the diffusion coefficients. Turing’s theory (Turing, 1952) <em>The chemical basis of morphogenesis</em> proposed that it was the diffusion of the substances <span class="math inline">\(A, B\)</span> which led to the evolution of a spatially heterogeneous solution to arise i.e. a spatial pattern. This has given rise to the phrase <em>diffusion-driven instability</em>. This was a rather revolutionary and counter-intuitive proposal, since, as we have seen, diffusion normally has the opposite tendency i.e. to smooth or average out spatial heterogeneities, and to give rise to spatially homogeneous solutions.</p>
<p>Various forms can be considered for the kinetic functions <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span>. However, we will focus mainly on three specific classes as follows:</p>
<section id="schnackenberg-kinetics" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1"><span class="header-section-number">6.2.1</span> Schnackenberg kinetics</h3>
<p><span class="math display">\[
F(A,B) = k_1 - k_2 A + k_3 A^2 B, \;\;\;\; G(A,B) = k_4 - k_3 A^2 B
\]</span></p>
<p><span class="math inline">\(k_1, k_2, k_3, k_4 &gt;0\)</span>. The term <span class="math inline">\(k_3 A^2 B\)</span> is <strong>autocatalytic</strong>, since the species <span class="math inline">\(A\)</span> upregulates its own production.</p>
</section>
<section id="gierer-meinhardt-kinetics" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2"><span class="header-section-number">6.2.2</span> Gierer &amp; Meinhardt kinetics</h3>
<p>Gierer &amp; Meinhardt developed a model that describes activator-inhibitor kinetics. The total reaction rates are <span class="math display">\[
F(A,B) = k_1 - k_2 A + \frac{k_3 A^2}{B}, \;\;\;\; G(A,B) = k_4 A^2 - k_5 B
\]</span> where <span class="math inline">\(k_1, k_2, k_3, k_4 , k_5 &gt; 0\)</span>. The term <span class="math inline">\(k_3 A^2 / B\)</span> is <strong>autocatalytic</strong>.</p>
</section>
<section id="thomas-kinetics" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3"><span class="header-section-number">6.2.3</span> Thomas kinetics</h3>
<p>Thomas developed a model of substrate inhibition in which <span class="math display">\[
\begin{aligned}
F(A,B) &amp;= k_1 - k_2 A - H(A,B), \\
G(A,B) &amp;= k_4 A^2 - k_4 B -H(A,B), \\
H(A,B) &amp;= \frac{k_5 AB}{k_6 + k_7 + k_8 A^2}.
\end{aligned}
\]</span> with <span class="math inline">\(k_i &gt; 0\)</span>. In the original paper of Thomas (1975), <span class="math inline">\(A\)</span> represents the concentration of oxygen (substrate) and <span class="math inline">\(B\)</span> the concentration of uricase (enzyme). Substrate inhibition is evident in the term <span class="math inline">\(k_8 A^2\)</span>.</p>
</section>
</section>
<section id="non-dimensionalization" class="level2" data-number="6.3">
<h2 data-number="6.3"><span class="header-section-number">6.3</span> Non-dimensionalization</h2>
<p>Before proceeding with our analysis, it is prudent to non-dimensionalize each of the above systems.</p>
<section id="schnakenberg" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1"><span class="header-section-number">6.3.1</span> Schnakenberg</h3>
<p>We illustrate this process for the Schnakenberg kinetics. Using the scaling</p>
<p><span class="math display">\[
u = A \left( \frac{k_3}{k_2} \right)^{1/2}, \quad v = B \left( \frac{k_3}{k_2} \right)^{1/2}, \quad t^* = \frac{D_A t}{L^2},\quad x^* = \frac{x}{L},
\]</span></p>
<p>where <span class="math inline">\(L\)</span> is a typical length scale, the dimensionless reaction-diffusion system with Schnakenberg kinetics becomes (upon dropping the <span class="math inline">\(*\)</span>):</p>
<p><span id="eq-schnackenbergeqns"><span class="math display">\[
\begin{aligned}
\frac{\partial u}{\partial  t} &amp; = \gamma ( a - u + u^2 v ) + \nabla^2 u = \gamma f(u,v)  + \nabla^2 u, \\
\frac{\partial v}{\partial  t} &amp; = \gamma ( b - u^2 v ) + d \nabla^2 v = \gamma g(u,w)  + d \nabla^2 v,
\end{aligned}
\tag{6.1}\]</span></span></p>
<p>where <span class="math display">\[
d = \frac{D_B}{D_A}, \quad a = \frac{k_1}{k_2} \left( \frac{k_3}{k_2} \right)^{1/2}, \quad b = \frac{k_4}{k_2} \left( \frac{k_3}{k_2} \right)^{1/2}, \quad \gamma = \frac{L^2 k_2}{D_A}.
\]</span></p>
</section>
<section id="gierer-meinhardt" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2"><span class="header-section-number">6.3.2</span> Gierer-Meinhardt</h3>
<p>The Gierer-Meinhardt kinetics can be non-dimensionalized as follows:</p>
<p><span class="math display">\[
\begin{aligned}
f(u, v) &amp; =  a - b u + \frac{u^2}{v},
g(u,v) &amp;= u^2 - v, \\
\end{aligned}
\]</span> where <span class="math inline">\(a , b\)</span> are positive parameters (Exercise/Tutorial).</p>
</section>
<section id="thomas" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3"><span class="header-section-number">6.3.3</span> Thomas</h3>
<p>The Thomas kinetics can be non-dimensionalized as follows:</p>
<p><span class="math display">\[
\begin{aligned}
f(u,v) &amp; =  a - u - h(u,v), \\
g(u,v) &amp;= \alpha (b - v) - h(u,v), \\
h(u,v) &amp; =  \frac{\rho u v}{1 + u + K u^2},
\end{aligned}
\]</span> where <span class="math inline">\(a , b, \alpha, \rho , K\)</span> are positive parameters (Exercise/Tutorial).</p>
</section>
<section id="general" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4"><span class="header-section-number">6.3.4</span> General</h3>
<p>Any reaction-diffusion system can be non-dimensionalized and scaled following the above procedure to take the following general form:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial u}{\partial  t} &amp; = \gamma f(u,v)  + \nabla^2 u, \\
\frac{\partial v}{\partial  t} &amp; = \gamma g(u,w)  + d \nabla^2 v,
\end{aligned}
\]</span></p>
<p>where the parameter <span class="math inline">\(d\)</span> is the ratio of the diffusion coefficients from the dimensional system and the parameter <span class="math inline">\(\gamma\)</span> can be interpreted in any one of the following ways:</p>
<ul>
<li><span class="math inline">\(\gamma^{1/2}\)</span> is proportional to the <strong>linear size</strong> of the spatial domain in one-dimension. In two-dimensions, <span class="math inline">\(\gamma\)</span> is proportional to the area.</li>
<li><span class="math inline">\(\gamma\)</span> represents the relative strength of the reaction terms – an increase in <span class="math inline">\(\gamma\)</span> may represent an increase in the activity of some rate-limiting step in the reaction sequence.</li>
<li>An increase in <span class="math inline">\(\gamma\)</span> is equivalent to a decrease in the diffusion coefficient, <span class="math inline">\(d\)</span>.</li>
</ul>
<p>Note that in the case where the parameter <span class="math inline">\(d &gt; 1\)</span>, this means that the original diffusion coefficients are not equal. Specifically, in the case of the Gierer-Meinhardt activator-inhibitor system, <span class="math inline">\(d &gt;1\)</span> implies that the inhibitor <em>diffuses more quickly</em> than the activator [<span class="math inline">\(d &gt; 1 \Rightarrow D_B &gt; D_A\)</span> ]. The spatial implications of this are shown in <span class="citation" data-cites="fig_ai">(<a href="#ref-fig_ai" role="doc-biblioref"><strong>fig_ai?</strong></a>)</span> – the inhibitor diffuses a greater distance than the activator, giving rise to what is known as <em>local activation, long-range inhibition</em>.</p>
<p>** Insert activator_inhibitor here **</p>
</section>
</section>
<section id="numerical-solution" class="level2" data-number="6.4">
<h2 data-number="6.4"><span class="header-section-number">6.4</span> Numerical solution</h2>
<p>In <a href="#fig-schnack_ddi_pde">Figure <span class="quarto-unresolved-ref">fig-schnack_ddi_pde</span></a> we plot numerical solutions of <a href="#eq-schnackenbergeqns">Equation <span class="quarto-unresolved-ref">eq-schnackenbergeqns</span></a> with no flux boundary conditions.</p>
<p>In this numerical solution the initial condition are the spatially homogeneous steady state perturbed by uniformly sampled noise. As time evolves, a spatial pattern emerges. The main idea from a biological perspeftive is that an unpatterned region of an embryo could undergo chemical reactions, with the result being a patterned chemcial field.</p>
<p>Some question that might arise:</p>
<ul>
<li>How does pattern formation depend on model parameters?</li>
<li>How does pattern formation depend on domain size?</li>
<li>How does the pattern wavelength depend on model parameters?</li>
<li>How does the pattern depend on the initial conditions?</li>
<li>How can we numerically solve the reaction diffusion PDEs?</li>
</ul>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">3</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>L<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>gamma<span class="op">=</span><span class="fl">650.0</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span><span class="fl">1.3</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>d<span class="op">=</span><span class="fl">30.0</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>N_x<span class="op">=</span><span class="dv">80</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>N_t<span class="op">=</span><span class="dv">50</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.linspace(<span class="dv">1</span>,T,N_t)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.linspace(<span class="dv">0</span>,L,N_x)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>(a<span class="op">+</span>b)<span class="op">*</span>np.ones_like(x)<span class="op">+</span><span class="fl">0.01</span><span class="op">*</span>np.random.uniform(low<span class="op">=-</span><span class="fl">1.0</span>, high<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>(N_x,))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>v_0<span class="op">=</span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(a<span class="op">+</span>b)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>np.ones_like(x)<span class="op">+</span><span class="fl">0.01</span><span class="op">*</span>np.random.uniform(low<span class="op">=-</span><span class="fl">1.0</span>, high<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>(N_x,))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>np.concatenate((u_0,v_0))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>dx<span class="op">=</span>L<span class="op">/</span>(N_x<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>dt<span class="op">=</span>T<span class="op">/</span>(N_t<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ShcnackPDErhs(sol,t):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    N_x<span class="op">=</span><span class="bu">int</span>(np.ceil(<span class="bu">len</span>(sol)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    u<span class="op">=</span>sol[<span class="dv">0</span>:N_x]</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    v<span class="op">=</span>sol[N_x:]</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    f_u<span class="op">=</span>np.zeros_like(u)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    f_v<span class="op">=</span>np.zeros_like(u)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      f_u[i]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u[i]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    f_u[i]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span>u[i]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    f_u[i]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span>u[i])</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>      f_v[i]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>v[i]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    f_v[i]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span>v[i]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    f_v[i]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span>v[i])</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    reaction_u<span class="op">=</span>gamma<span class="op">*</span>(a<span class="op">-</span>u<span class="op">+</span>(u<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>v)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    reaction_v<span class="op">=</span>gamma<span class="op">*</span>(b<span class="op">-</span>(u<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>v)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    f_u<span class="op">=</span>f_u<span class="op">+</span>reaction_u</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    f_v<span class="op">=</span>f_v<span class="op">+</span>reaction_v</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    f<span class="op">=</span> np.concatenate((f_u,f_v)) </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f  </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>sol<span class="op">=</span>odeint(ShcnackPDErhs,u_0,t)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>u<span class="op">=</span>sol[:,<span class="dv">0</span>:N_x]</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>v<span class="op">=</span>sol[:,N_x:]</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x,u[<span class="dv">0</span>,:],<span class="st">&#39;r&#39;</span>)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x,u[<span class="dv">16</span>,:],<span class="st">&#39;b&#39;</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x,u[<span class="dv">32</span>,:],<span class="st">&#39;m&#39;</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x,u[<span class="dv">48</span>,:],<span class="st">&#39;k&#39;</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;$x$&#39;</span>)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">&#39;$u$&#39;</span>)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, v[<span class="dv">0</span>,:],<span class="st">&#39;r--&#39;</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, v[<span class="dv">16</span>,:],<span class="st">&#39;b--&#39;</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, v[<span class="dv">32</span>,:],<span class="st">&#39;m--&#39;</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x, v[<span class="dv">48</span>,:],<span class="st">&#39;k--&#39;</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">&#39;$x$&#39;</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">&#39;$v$&#39;</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;t&#39;</span><span class="op">+</span> <span class="bu">str</span>(t[<span class="dv">0</span>]),<span class="st">&#39;t=&#39;</span><span class="op">+</span> <span class="bu">str</span>(t[<span class="dv">4</span>]),<span class="st">&#39;t=&#39;</span><span class="op">+</span> <span class="bu">str</span>(t[<span class="dv">8</span>]),<span class="st">&#39;t=&#39;</span><span class="op">+</span> <span class="bu">str</span>(t[<span class="dv">12</span>])])</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;$x$&#39;</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-schnack_ddi_pde" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="DiffusionDrivenInstability_files/figure-html/fig-schnack_ddi_pde-output-1.png" width="597" height="429" /></p>
<figcaption>Figure 6.1: DDI with Schnackenberg kinetics</figcaption>
</figure>
</div>
</div>
</div>
<p>In Figure <a href="#fig-schnack_ddi_pde_2d">Figure <span class="quarto-unresolved-ref">fig-schnack_ddi_pde_2d</span></a> we consider a numerical solution of the Schnackenberg model on a 2D square domain with no-flux boundary conditions. Note</p>
<div class="cell" data-cache="true" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> odeint</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>T<span class="op">=</span><span class="dv">5</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>L<span class="op">=</span><span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>gamma<span class="op">=</span><span class="fl">650.0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span><span class="fl">1.3</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>d<span class="op">=</span><span class="fl">25.0</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>N_x<span class="op">=</span><span class="dv">20</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>N_t<span class="op">=</span><span class="dv">30</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>np.linspace(<span class="dv">1</span>,T,N_t)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.linspace(<span class="dv">0</span>,L,N_x)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.linspace(<span class="dv">0</span>,L,N_x)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>[x,y]<span class="op">=</span>np.meshgrid(x,y)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>(a<span class="op">+</span>b)<span class="op">*</span>np.ones_like(x)<span class="op">+</span><span class="fl">0.01</span><span class="op">*</span>np.random.uniform(low<span class="op">=-</span><span class="fl">1.0</span>, high<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>(N_x,N_x))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>v_0<span class="op">=</span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(a<span class="op">+</span>b)<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>np.ones_like(x)<span class="op">+</span><span class="fl">0.01</span><span class="op">*</span>np.random.uniform(low<span class="op">=-</span><span class="fl">1.0</span>, high<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>(N_x,N_x))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>np.concatenate((np.ravel(u_0),np.ravel(v_0)))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>dx<span class="op">=</span>L<span class="op">/</span>(N_x<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>dt<span class="op">=</span>T<span class="op">/</span>(N_t<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ShcnackPDErhs2d(sol,t):</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    num_nodes<span class="op">=</span><span class="bu">int</span>(np.ceil(<span class="bu">len</span>(sol)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    u<span class="op">=</span>sol[<span class="dv">0</span>:num_nodes]</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    v<span class="op">=</span>sol[num_nodes:]</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    u<span class="op">=</span>np.reshape(u,(N_x,N_x))</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    v<span class="op">=</span>np.reshape(v,(N_x,N_x))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    f_u<span class="op">=</span>np.zeros_like(u)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    f_v<span class="op">=</span>np.zeros_like(u)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">4</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">4</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span> </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>      f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>      f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>      f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>      f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>])   </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    j<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>        f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,N_x<span class="op">-</span><span class="dv">2</span>):</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>        f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">3</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>])  </span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    j<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    j<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">+</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    j<span class="op">=</span><span class="dv">0</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i,j<span class="op">+</span><span class="dv">1</span>]) </span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    i<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    j<span class="op">=</span>N_x<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    f_u[i,j]<span class="op">=</span><span class="dv">1</span><span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>u[i,j]<span class="op">+</span>u[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">+</span>u[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    f_v[i,j]<span class="op">=</span>d<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>v[i,j]<span class="op">+</span>v[i<span class="op">-</span><span class="dv">1</span>,j]<span class="op">+</span>v[i,j<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    reaction_u<span class="op">=</span>gamma<span class="op">*</span>(a<span class="op">-</span>u<span class="op">+</span>(u<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>v)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    reaction_v<span class="op">=</span>gamma<span class="op">*</span>(b<span class="op">-</span>(u<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>v)</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    f_u<span class="op">=</span>f_u<span class="op">+</span>reaction_u</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    f_v<span class="op">=</span>f_v<span class="op">+</span>reaction_v</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    f<span class="op">=</span> np.concatenate((np.ravel(f_u),np.ravel(f_v))) </span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f  </span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>sol<span class="op">=</span>odeint(ShcnackPDErhs2d,u_0,t)</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a><span class="co">#soln = solve_ivp(ShcnackPDErhs,(0, T), u_0, method=&#39;Radau&#39;)</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>sol[<span class="dv">0</span>,<span class="dv">0</span>:N_x<span class="op">**</span><span class="dv">2</span>]</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>v_0<span class="op">=</span>sol[<span class="dv">0</span>,N_x<span class="op">**</span><span class="dv">2</span>:]</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>u_0<span class="op">=</span>np.reshape(u_0,(N_x,N_x))</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>v_0<span class="op">=</span>np.reshape(v_0,(N_x,N_x))</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>u_m<span class="op">=</span>sol[<span class="dv">20</span>,<span class="dv">0</span>:N_x<span class="op">**</span><span class="dv">2</span>]</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>v_m<span class="op">=</span>sol[<span class="dv">20</span>,N_x<span class="op">**</span><span class="dv">2</span>:]</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>u_m<span class="op">=</span>np.reshape(u_m,(N_x,N_x))</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>v_m<span class="op">=</span>np.reshape(v_m,(N_x,N_x))</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>u<span class="op">=</span>sol[<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>:N_x<span class="op">**</span><span class="dv">2</span>]</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>v<span class="op">=</span>sol[<span class="op">-</span><span class="dv">1</span>,N_x<span class="op">**</span><span class="dv">2</span>:]</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>u<span class="op">=</span>np.reshape(u,(N_x,N_x))</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>v<span class="op">=</span>np.reshape(v,(N_x,N_x))</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">0</span>].imshow(u_0)</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">0</span>].imshow(v_0)</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">1</span>].imshow(u_m)</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">1</span>].imshow(v_m)</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>,<span class="dv">2</span>].imshow(u)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>,<span class="dv">2</span>].imshow(v)</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].plot(x,u[0,:],&#39;r&#39;)</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].plot(x,u[16,:],&#39;b&#39;)</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].plot(x,u[32,:],&#39;m&#39;)</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].plot(x,u[48,:],&#39;k&#39;)</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].set_xlabel(&#39;$x$&#39;)</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a><span class="co">ax[0].set_ylabel(&#39;$u$&#39;)</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].plot(x, v[0,:],&#39;r--&#39;)</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].plot(x, v[16,:],&#39;b--&#39;)</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].plot(x, v[32,:],&#39;m--&#39;)</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].plot(x, v[48,:],&#39;k--&#39;)</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].set_xlabel(&#39;$x$&#39;)</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a><span class="co">ax[1].set_ylabel(&#39;$v$&#39;)</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;$x$&#39;</span>)</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-schnack_ddi_pde_2d" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="DiffusionDrivenInstability_files/figure-html/fig-schnack_ddi_pde_2d-output-1.png" width="566" height="416" /></p>
<figcaption>Figure 6.2: DDI with Schnackenberg kinetics in 2D</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-stability-analysis-and-evolution-of-spatial-pattern-general-conditions-for-diffusion-driven-instability" class="level2" data-number="6.5">
<h2 data-number="6.5"><span class="header-section-number">6.5</span> Linear Stability Analysis and Evolution of Spatial Pattern: General Conditions for Diffusion-driven Instability</h2>
<p>Let <span class="math inline">\(\Omega\subset \mathbb R^n\)</span> be a domain with smooth (sufficiently regular) boundary <span class="math inline">\(\partial \Omega\)</span>, with outward unit normal <span class="math inline">\({\mathbf{n}}\)</span>. Our general, non-dimensional reaction-diffusion system is then:</p>
<p><span id="eq-pp"><span class="math display">\[
\begin{aligned}
&amp;\frac{\partial u}{\partial  t} = \gamma\, f(u,v)  +  \nabla^2 u, \qquad x\in \Omega, \quad t&gt;0, \\
&amp;\frac{\partial v}{\partial  t} = \gamma\, g(u,v)  + d \nabla^2 v, \qquad x\in \Omega, \quad t&gt;0, \\
&amp;
\end{aligned}
\tag{6.2}\]</span></span> together with boundary and initial Conditions <span id="eq-pp_bc"><span class="math display">\[
\begin{aligned}
\nabla u \cdot {\mathbf{n} } = 0, \qquad \nabla v \cdot {\mathbf{n} } = 0, \qquad x\in \partial \Omega, \quad t&gt;0, \\
u(x,0)  = u_0(x), \qquad  v(x,0)  = v_0(x), \qquad x\in \Omega\; .
\end{aligned}
\tag{6.3}\]</span></span></p>
<p>A <strong>spatially homogeneous steady-state</strong> of <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a> and <a href="#eq-pp_bc">Equation <span class="quarto-unresolved-ref">eq-pp_bc</span></a> satisfies <span class="math display">\[
f(u,v) = 0 , \qquad g(u,v) =0
\]</span> and we denote it by <span class="math inline">\((u_0, v_0)\)</span>.</p>
<section id="stability-of-spatially-homogeneous-steady-states-to-spatially-homogeneous-perturbations" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1"><span class="header-section-number">6.5.1</span> Stability of spatially homogeneous steady states to spatially homogeneous perturbations</h3>
<p>Before we consider the effect of the spatial terms (i.e. diffusion) in <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a> and <a href="#eq-pp_bc">Equation <span class="quarto-unresolved-ref">eq-pp_bc</span></a>, we first of all explore the stability of the underlying spatially homogeneous steady state.</p>
<p>Consider the following perturbations to the steady state <span class="math inline">\((u_0 , v_0)\)</span>: <span class="math display">\[
u(x,t) = u_0 + \tilde u(t), \quad  v(x,t) = v_0 + \tilde v(t), \qquad \|\tilde u(t) \| \ll 1, \quad  \|\tilde v(t) \| \ll 1.
\]</span></p>
<p>Upon substitution into <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a> <span id="eq-pp_1"><span class="math display">\[
\begin{aligned}
\frac{d\tilde u}{d t} = \gamma\, f(u_0 + \tilde u,v_0 + \tilde v),  \\
\frac{d \tilde v}{d  t} = \gamma\, g(u_0 + \tilde u,v_0 + \tilde v).
\end{aligned}
\tag{6.4}\]</span></span></p>
<p>Using a Taylor expansion of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> about <span class="math inline">\((u_0, v_0)\)</span> we obtain the linearised system <span id="eq-linear_pp"><span class="math display">\[
\begin{pmatrix}
\tilde u_t \\
\tilde v_t
\end{pmatrix}  = \gamma J  \begin{pmatrix}
\tilde u \\
\tilde v
\end{pmatrix},
\tag{6.5}\]</span></span> where <span class="math display">\[
J =J(u_0, v_0) =  \begin{pmatrix}
f_u &amp; f_v  \\
g_u &amp; g_v
\end{pmatrix}_{(u_0 , v_0)} \; .  
\]</span></p>
<p>The general solution of <a href="#eq-linear_pp">Equation <span class="quarto-unresolved-ref">eq-linear_pp</span></a> is</p>
<p><span class="math display">\[
\begin{pmatrix}
\tilde u(t) \\
\tilde v(t)
\end{pmatrix}   =  C_1 \phi_1 e^{\lambda_1 t} +  C_2 \phi_2 e^{\lambda_2 t}  ,
\]</span> where <span class="math inline">\(C_1\)</span>, <span class="math inline">\(C_2\)</span> are arbitrary constants, <span class="math inline">\(\lambda_1, \lambda_2\)</span> are the eigenvalues of <span class="math inline">\(\gamma J\)</span>, i.e. solutions of characteristic equation <span class="math display">\[
\det (\gamma J - \lambda I) = 0,
\]</span> and <span class="math inline">\(\phi_1\)</span>, <span class="math inline">\(\phi_2\)</span> are corresponding eigenvectors. It is easily seen that</p>
<p><span class="math display">\[
\lambda_{1,2} = \frac \gamma 2 \left( \text{tr} (J) \pm \sqrt{ \text{tr}(J)^2 - 4 \det(J)} \right),
\]</span></p>
<p>and thus a spatially homogeneous steady state <span class="math inline">\((u_0, v_0)\)</span> is <strong>stable</strong> to spatially homogeneous perturbations if <span class="math display">\[
{\mathrm Re}( \lambda_{1,2}) &lt;0,
\]</span> i.e. if</p>
<p><span id="eq-stable_hom"><span class="math display">\[
\begin{aligned}
\text{tr}(J) &amp; = f_u + g_v &lt; 0, \\
\det(J) &amp; = f_u g_v - f_v g_u &gt; 0.
\end{aligned}
\tag{6.6}\]</span></span></p>
<p>We shall be interested only in such parameter values for which conditions <a href="#eq-stable_hom">Equation <span class="quarto-unresolved-ref">eq-stable_hom</span></a> are satisfied (i.e. the spatially homogeneous steady state is linearly stable in the absence of diffusion).</p>
</section>
<section id="stability-of-spatially-homogeneous-steady-states-to-spatially-heterogeneous-spatially-dependent-perturbations" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2"><span class="header-section-number">6.5.2</span> Stability of spatially homogeneous steady states to spatially heterogeneous: spatially dependent, perturbations</h3>
<p>We now consider perturbations about the spatially homogeneous steady state that are spatially dependent i.e.  <span class="math display">\[
u(x,t) = u_0 + \tilde u(x,t), \quad  v(x,t) = v_0 + \tilde v(x,t), \qquad \|\tilde u(x,t) \| \ll 1, \quad  \|\tilde v(x,t) \| \ll 1 .
\]</span></p>
<p>Upon substitution in <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a> and apply a Taylor expansion about <span class="math inline">\((u_0, v_0)\)</span> to <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> to obtain the linearised problem</p>
<p><span id="eq-pp_3"><span class="math display">\[
\begin{aligned}
\frac{\partial \tilde u(x,t)}{\partial t} = \gamma\, \left(f_u \tilde u(x,t) + f_v \tilde v(x,t)\right) + \nabla^2 \tilde u(x,t)  , \quad x\in \Omega, \;  t &gt;0, \\
\frac{\partial \tilde v(x,t)}{\partial   t} = \gamma\,  \left(g_u  \tilde u(x,t) + g_v \tilde v(x,t)\right) +d \nabla^2 \tilde v(x,t)  ,  \quad x\in \Omega, \;  t &gt;0,  \\
\end{aligned}
\tag{6.7}\]</span></span> with boundary conditions <span id="eq-pp_3bc"><span class="math display">\[
\begin{aligned}
{\mathbf{n}} \cdot \nabla \tilde u (x,t) = 0, \qquad {\mathbf{n}} \cdot \nabla \tilde v (x,t)  = 0, \qquad   x\in   \partial \Omega, \; t &gt;0.
\end{aligned}
\tag{6.8}\]</span></span></p>
<p>Defining <span class="math display">\[
V(x,t) = \begin{pmatrix}
\tilde u(x,t) \\
\tilde v(x,t)
\end{pmatrix}
\]</span> we rewrite <a href="#eq-pp_3">Equation <span class="quarto-unresolved-ref">eq-pp_3</span></a> as <span class="math display">\[
\frac{\partial}{\partial t}  V(x,t) = \gamma J  V(x,t) + D \nabla^2   V(x,t),
\]</span></p>
<p>where</p>
<p><span class="math display">\[
D =  \begin{pmatrix}
1 &amp; 0 \\
0 &amp; d
\end{pmatrix}\;.
\]</span></p>
<p>We shall consider a separation of variables approach, i.e. <span class="math display">\[
V(x,t) =\begin{pmatrix}  
\bar u(t)  \varphi_1(x)
\\
\bar v(t)  \varphi_2(x)
\end{pmatrix}\;
\]</span> and obtain <span id="eq-pp_4"><span class="math display">\[
\begin{aligned}
\frac{d \bar u(t)}{d t}\varphi_1(x) = \gamma\, \left(f_u \bar u(t) \varphi_1(x) + f_v \bar v(t) \varphi_2(x)\right) +\bar u(t)  \nabla^2 \varphi_1(x)  , \quad x\in \Omega, \;  t &gt;0, \\
\frac{d \bar v(t)}{d t}\varphi_2(x) = \gamma\,  \left(g_u  \bar u(t) \varphi_1(x) + g_v \bar v(t) \varphi_2(x)\right) +  d \bar v(t) \nabla^2  \varphi_2(x)  ,  \quad x\in \Omega, \;  t &gt;0,  \\
\end{aligned}
\tag{6.9}\]</span></span></p>
<p>with boundary conditions <span id="eq-pp_4bc"><span class="math display">\[
\begin{aligned}
{\mathbf{n}} \cdot \nabla \varphi_1(x) = 0, \qquad {\mathbf{n}} \cdot \nabla\varphi_2 (x) = 0, \qquad   x\in   \partial \Omega, \; t &gt;0.
\end{aligned}
\tag{6.10}\]</span></span></p>
<p>It is assumed that <span class="math display">\[
\bar u(t)\, / \hspace{-0.35 cm}\equiv 0 \quad \textrm{and} \quad  \bar v(t)\, / \hspace{-0.35 cm}\equiv 0
\]</span> for <span class="math inline">\(t&gt;0\)</span>.</p>
<div id="lem-laplacianeiegenvalues" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 6.1 </strong></span>Consider the spatial eigenvalue problem for the Laplacian <span class="math inline">\(\nabla^2\)</span> with zero-Neumann boundary conditions i.e.</p>
<p><span id="eq-ev"><span class="math display">\[
\begin{aligned}
\nabla^2 \psi(x) = -k^2 \psi(x) , \qquad x \in \Omega ,  \\
{\mathbf{n}} \cdot \nabla \psi(x) = 0 , \qquad x\in \partial \Omega \; .
\end{aligned}
\tag{6.11}\]</span></span></p>
<p>For a bounded domain <span class="math inline">\(\Omega\)</span> there exists a discrete set of eigenvalues <span class="math display">\[
0 \leq k^2_1&lt; k_2^2\leq k_3^2\leq \ldots \leq k_j^2\leq \ldots,
\]</span> with <span class="math display">\[
j \in \mathbb N, \quad  \textrm{and} \quad k_j^2 \to \infty \quad \textrm{as}  \quad j \to \infty.
\]</span></p>
<p>Moreover, the eigenfunctions <span class="math inline">\(\{\psi_k(x) \}\)</span> form an <strong>orthogonal set</strong> of basis functions of the corresponding functional space (i.e. <span class="math inline">\(L^2(\Omega)\)</span>, <span class="math inline">\(H^1(\Omega)\)</span>).</p>
</div>
<p>Thus we can look for the spatial component of the solution of <a href="#eq-pp_4">Equation <span class="quarto-unresolved-ref">eq-pp_4</span></a> as follows: <span class="math display">\[
\varphi(x) = \begin{pmatrix}  
\varphi_1(x) \\
\varphi_2(x)
\end{pmatrix} = \sum_k C_k \psi_k(x), \qquad C_k =  \begin{pmatrix}  C_k^1 \\ C_k^2 \end{pmatrix} \in \mathbb R^2 \;
\]</span> and <span id="eq-vxt"><span class="math display">\[
\begin{aligned}
V(x,t) =\sum_k \hat V_k(t) \psi_k(x), \qquad \textrm{ where}
\quad \hat V_k(t)=
\begin{pmatrix}  
C_k^1 \; \bar u(t)
\\
C_k^2 \; \bar v(t)
\end{pmatrix}.
\end{aligned}
\tag{6.12}\]</span></span></p>
<p>SEince <span class="math inline">\(\nabla^2 \psi_k(x) = - k^2 \psi_k(x)\)</span> we obtain</p>
<p><span class="math display">\[
D \nabla^2  V(x,t) = D \nabla^2 \left[ \sum_k \hat V_k(t) \psi_k(x) \right]   = \sum_k D \hat V_k(t) \nabla^2 \psi_k(x)=
- \sum_k k^2 D \hat V_k(t)  \psi_k(x).
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
\sum_k \frac{d}{d t}  \hat V_k(t) \psi_k(x)  =
  \sum_k \gamma J \hat V_k(t) \psi_k(x) -  \sum_k k^2  D \hat V_k(t) \psi_k(x).
\]</span></p>
<p>Since <span class="math inline">\(\{\psi_k(x) \}\)</span> is a orthogonal basis we obtain that</p>
<p><span class="math display">\[
\frac{d}{d t}  \hat V_k(t) \psi_k(x)  =
   \gamma J  \hat V_k(t) \psi_k(x) -  k^2  D \hat V_k(t) \psi_k(x),
\]</span> for each <span class="math inline">\(k\)</span>. Finally, since <span class="math display">\[
\psi_k(x)\;  /\hspace{-0.35 cm }\equiv 0
\]</span> in <span class="math inline">\(\Omega\)</span> this implies for each <span class="math inline">\(k\)</span> a system of ODEs:</p>
<p><span id="eq-stab_pp_ode"><span class="math display">\[
\begin{aligned}
\frac{d}{d t}  \hat V_k(t)   &amp;=   \left(\gamma J  -  k^2  D\right) \hat V_k(t) &amp;= \tilde J\hat V_k(t) ,
\end{aligned}
\tag{6.13}\]</span></span></p>
<p>where <span class="math inline">\(\tilde J\)</span> is a “modified” Jacobian:</p>
<p><span class="math display">\[
\tilde{J} =  \begin{pmatrix}
\gamma f_u - k^2 &amp; \gamma f_v \\
\gamma g_u &amp; \gamma g_v - d k^2
\end{pmatrix}\;.
\]</span></p>
<p>Now solutions of <a href="#eq-stab_pp_ode">Equation <span class="quarto-unresolved-ref">eq-stab_pp_ode</span></a> are of the form <span class="math display">\[
\hat V_k(t) = e^{\lambda t} P_k
\]</span> with <span class="math inline">\(P_k \in \mathbb R^2\)</span>, where, since <span class="math inline">\(P_k\neq 0\)</span> (looking for nontrivial solutions), we find that <span class="math inline">\(\lambda\)</span> are the eigenvalues of <span class="math inline">\(\tilde J\)</span> , i.e. </p>
<p>solutions of the characteristic equation <span id="eq-charact_pp_1"><span class="math display">\[
\det(\tilde J - \lambda I) = \det ( \gamma J - k^2 D - \lambda I) =0.
\tag{6.14}\]</span></span></p>
<p>Evaluating the above determinant, we arrive at the equation: <span id="eq-spatial_eigenvalues"><span class="math display">\[
\lambda^2 + [ k^2 (1 + d) - \gamma (f_u + g_v) ] \lambda + h(k^2) = 0,
\tag{6.15}\]</span></span> where <span id="eq-hk2"><span class="math display">\[
h(k^2) = dk^4 - \gamma (df_u + g_v) k^2 + \gamma^2 | J | .
\tag{6.16}\]</span></span></p>
<div id="fig-dispersion" class="quarto-figure quarto-figure-center">
<figure>
<details>
<summary>Code</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># genera</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>k_sq<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">100</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>gamma<span class="op">=</span><span class="dv">10</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>d_1<span class="op">=</span><span class="fl">0.02</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>d_2<span class="op">=</span><span class="dv">3</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>d_3<span class="op">=</span><span class="dv">6</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>f_u<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>g_v<span class="op">=-</span><span class="fl">0.5</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>term1<span class="op">=</span>d<span class="op">*</span>f_u<span class="op">+</span>g_v</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>J<span class="op">=</span><span class="fl">1.0</span> <span class="co"># positive determinant</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Computeh(k_sq,d):</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  h<span class="op">=</span>d<span class="op">*</span>k_sq<span class="op">**</span><span class="dv">2</span><span class="op">-</span>gamma<span class="op">*</span>(term1)<span class="op">*</span>k_sq<span class="op">+</span> gamma<span class="op">**</span><span class="dv">2</span><span class="op">*</span>J</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> h</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> SolveReLambda(k_sq,d):</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>   <span class="co"># a lam^2 + b * lam +c</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    a<span class="op">=</span><span class="dv">1</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    b<span class="op">=</span> k_sq<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>d)<span class="op">-</span>gamma<span class="op">*</span>(f_u<span class="op">+</span>g_v)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span> Computeh(k_sq,d)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    lambda_m<span class="op">=</span> (<span class="op">-</span>b<span class="op">-</span>np.sqrt(b<span class="op">**</span><span class="dv">2</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>a<span class="op">*</span>c))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>a)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    lambda_p<span class="op">=</span> (<span class="op">-</span>b<span class="op">+</span>np.sqrt(b<span class="op">**</span><span class="dv">2</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>a<span class="op">*</span>c))<span class="op">//</span>(<span class="dv">2</span><span class="op">*</span>a)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lambda_m,lambda_p</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> TestDDIconditions(d):</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    cond_1<span class="op">=</span>f_u<span class="op">+</span>g_v</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    cond_2 <span class="op">=</span> J</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    cond_3 <span class="op">=</span> d<span class="op">*</span>f_u<span class="op">+</span>g_v</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    cond_4 <span class="op">=</span> (d<span class="op">*</span>f_u<span class="op">+</span>g_v)<span class="op">**</span><span class="dv">2</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span>d<span class="op">*</span>J</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    cond_true<span class="op">=</span>np.zeros((<span class="dv">4</span>,<span class="dv">1</span>),dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    cond_true[<span class="dv">0</span>]<span class="op">=</span>(cond_1<span class="op">&lt;</span><span class="dv">0</span>) </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    cond_true[<span class="dv">1</span>]<span class="op">=</span> (cond_2<span class="op">&gt;</span><span class="dv">0</span>) </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    cond_true[<span class="dv">2</span>]<span class="op">=</span> (cond_3<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    cond_true[<span class="dv">3</span>]<span class="op">=</span>(cond_4<span class="op">&lt;</span><span class="dv">0</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cond_true</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>h_1<span class="op">=</span>Computeh(k_sq,d_1)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>h_2<span class="op">=</span>Computeh(k_sq,d_2)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>h_3<span class="op">=</span>Computeh(k_sq,d_3)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>l_1_m, l_1_p <span class="op">=</span> SolveReLambda(k_sq,d_1)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>l_2_m, l_2_p <span class="op">=</span> SolveReLambda(k_sq,d_2)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>l_3_m, l_3_p <span class="op">=</span> SolveReLambda(k_sq,d_3)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>conditions_satisfied1<span class="op">=</span>TestDDIconditions(d_1)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>conditions_satisfied2<span class="op">=</span>TestDDIconditions(d_2)</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>conditions_satisfied3<span class="op">=</span>TestDDIconditions(d_3)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(conditions_satisfied1,conditions_satisfied2,conditions_satisfied3)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>fig, ax<span class="op">=</span>plt.subplots()</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>ax.plot(k_sq,h_1,<span class="st">&#39;r&#39;</span>,k_sq,h_2,<span class="st">&#39;k&#39;</span>,k_sq,h_3,<span class="st">&#39;m&#39;</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;$k^2$&#39;</span>)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;$h$&#39;</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_1),<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_2),<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_3)])</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>fig, ax<span class="op">=</span>plt.subplots()</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>ax.plot(k_sq,np.real(l_1_m),<span class="st">&#39;r&#39;</span>,k_sq,np.real(l_2_m),<span class="st">&#39;k&#39;</span>,k_sq,np.real(l_3_m),<span class="st">&#39;m&#39;</span>)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>ax.plot(k_sq,np.real(l_1_p),<span class="st">&#39;r--&#39;</span>,k_sq,np.real(l_2_p),<span class="st">&#39;k--&#39;</span>,k_sq,np.real(l_3_p),<span class="st">&#39;m--&#39;</span>)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;$k^2$&#39;</span>)</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;$\Re{\lambda}$&#39;</span>)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="dv">20</span>,<span class="dv">5</span>])</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_1),<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_2),<span class="st">&#39;d=&#39;</span><span class="op">+</span><span class="bu">str</span>(d_3)])</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ True]
 [ True]
 [False]
 [False]] [[ True]
 [ True]
 [ True]
 [ True]] [[ True]
 [ True]
 [ True]
 [ True]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/m_/vc0kz_0x6ls5n4qnksq052jw0000gp/T/ipykernel_22006/2851046048.py:30: RuntimeWarning:

invalid value encountered in sqrt

/var/folders/m_/vc0kz_0x6ls5n4qnksq052jw0000gp/T/ipykernel_22006/2851046048.py:31: RuntimeWarning:

invalid value encountered in sqrt
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-dispersion-1" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="DiffusionDrivenInstability_files/figure-html/fig-dispersion-output-3.png" data-ref-parent="fig-dispersion" width="613" height="431" /></p>
<figcaption>(a) A plot of <span class="math inline">\(h(k^2)\)</span> against k^2.</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-dispersion-2" class="quarto-figure quarto-figure-center">
<figure>
<p><img src="DiffusionDrivenInstability_files/figure-html/fig-dispersion-output-4.png" data-ref-parent="fig-dispersion" width="596" height="436" /></p>
<figcaption>(b)</figcaption>
</figure>
</div>
</div>
<figcaption>Figure 6.3: <strong>?(caption)</strong></figcaption>
</figure>
</div>
<p><strong>NOTE</strong>: From <a href="#eq-charact_pp_1">Equation <span class="quarto-unresolved-ref">eq-charact_pp_1</span></a>, <a href="#eq-spatial_eigenvalues">Equation <span class="quarto-unresolved-ref">eq-spatial_eigenvalues</span></a> we can recover the characteristic equation for the spatially homogeneous perturbation when <span class="math inline">\(k=0\)</span>, i.e.  <span class="math display">\[
\tilde J \Big|_{k=0} = ( \gamma J - k^2 D )\Big|_{k=0} = \gamma J.
\]</span></p>
<p>Thus the steady state <span class="math inline">\((u_0, v_0)\)</span> is <strong>unstable</strong> to spatially heterogeneous perturbations iff <span class="math display">\[
{\mathrm Re}(\lambda_1) &gt; 0 \quad \text{and/or } \quad {\mathrm Re}(\lambda_2) &gt;0,
\]</span> where <span class="math inline">\(\lambda_{1,2}\)</span> are solutions of <a href="#eq-charact_pp_1">Equation <span class="quarto-unresolved-ref">eq-charact_pp_1</span></a>, <a href="#eq-spatial_eigenvalues">Equation <span class="quarto-unresolved-ref">eq-spatial_eigenvalues</span></a>.</p>
<p>Now for <span class="math display">\[
{\mathrm Re}(\lambda_1) &gt; 0 \quad \text{and/or } \quad {\mathrm Re}(\lambda_2) &gt;0
\]</span> to be satisfied we require <span class="math display">\[
\text{tr}(\tilde J) &gt; 0 \quad \text{ or } \quad \det(\tilde J) &lt;0 \; .
\]</span></p>
<p>Consider first <span class="math inline">\({\mathrm tr} (\tilde{J})\)</span>. We have <span class="math display">\[
\text{tr}(\tilde J) = \gamma ( f_u+ g_v) - k^2(1+d) &lt; 0, \hspace{4 cm}  
\]</span> since <span class="math inline">\(\gamma &gt; 0\)</span> and <span class="math display">\[
f_u+ g_v &lt; 0
\]</span> by the stability condition for the spatially homogeneous perturbation <a href="#eq-stable_hom">Equation <span class="quarto-unresolved-ref">eq-stable_hom</span></a>.</p>
<p>Thus instability to the spatially heterogeneous perturbation <strong>can only occur</strong> if <span class="math display">\[
\det(\tilde J) &lt; 0
\]</span> and so we require: <span class="math display">\[
\det(\tilde J) = h(k^2) = dk^4  - \gamma ( d\,  f_u + g_v) k^2 + \gamma^2 \det(J) &lt; 0.
\]</span> From the spatially homogeneous stability conditions <a href="#eq-stable_hom">Equation <span class="quarto-unresolved-ref">eq-stable_hom</span></a> we have <span class="math inline">\(\det(J) &gt;0\)</span>. Thus <span class="math inline">\(h(k^2)&lt;0\)</span> is possible only if <span id="eq-stabil_cond_nes"><span class="math display">\[
d f_u + g_v &gt;0.
\tag{6.17}\]</span></span> However, once again, due to <a href="#eq-stable_hom">Equation <span class="quarto-unresolved-ref">eq-stable_hom</span></a>, we have <span class="math inline">\(f_u+ g_v &lt;0\)</span>, and so we can conclude that <em><span class="math inline">\(d\neq 1\)</span> and <span class="math inline">\(f_u\)</span> and <span class="math inline">\(g_v\)</span> must have opposite signs</em>.</p>
<p>Condition <a href="#eq-stabil_cond_nes">Equation <span class="quarto-unresolved-ref">eq-stabil_cond_nes</span></a> is <strong>necessary but not sufficient</strong> to ensure <span class="math inline">\(h(k^2) &lt;0\)</span>. In order to guarantee that <span class="math inline">\(h(k^2) &lt; 0\)</span>, the minimum value <span class="math inline">\(h_{{\mathrm min}}\)</span> must be negative. Differentiating <a href="#eq-hk2">Equation <span class="quarto-unresolved-ref">eq-hk2</span></a> w.r.t. <span class="math inline">\(k^2\)</span>, we find that:</p>
<p><span id="eq-hmin"><span class="math display">\[
k^2_{m} = \gamma \frac{d f_u + g_v}{2d} \;\; \Rightarrow \;\; h_{{\mathrm min}} = \gamma^2 \left[ | J | - \frac{(df_u + g_v)^2}{4d} \right].
\tag{6.18}\]</span></span></p>
<p>Thus the condition that <span class="math inline">\(h(k^2) &lt; 0\)</span> for some <span class="math inline">\(k^2\)</span> is:</p>
<p><span class="math display">\[
\frac{(df_u + g_v)^2}{4d} &gt; |J|.
\]</span></p>
<p>The transition from stability to instability i.e. <strong>bifurcation</strong>, occurs when <span class="math inline">\(h_{{\mathrm min}} = 0\)</span>. From <a href="#eq-hmin">Equation <span class="quarto-unresolved-ref">eq-hmin</span></a>, this means at bifurcation we have <span id="eq-bif"><span class="math display">\[
|J| = \frac{(df_u + g_v)^2}{4d}.
\tag{6.19}\]</span></span></p>
<p>For a fixed set of kinetics parameters, this means that we have a <strong>critical diffusion coefficient</strong> <span class="math inline">\(d_c \;(&gt;1)\)</span>, which, after re-arranging <a href="#eq-bif">Equation <span class="quarto-unresolved-ref">eq-bif</span></a>, is the appropriate root of</p>
<p><span id="eq-dcrit"><span class="math display">\[
q(d_c) = d^2_c f_u^2 + 2( 2 f_v g_u - f_u g_v) d_c + g_v^2 =0.
\tag{6.20}\]</span></span></p>
<p>Finally, we note that using <a href="#eq-hmin">Equation <span class="quarto-unresolved-ref">eq-hmin</span></a>, <a href="#eq-bif">Equation <span class="quarto-unresolved-ref">eq-bif</span></a>, the <strong>critical wave number</strong> can be written: <span id="eq-kcrit"><span class="math display">\[
k_c^2 =\gamma  \frac{( d_c f_u + g_v)} { 2 d_c} = \gamma \left[ \frac {|J|}{d_c} \right]^{1/2} = \gamma \left[ \frac{f_u g_v - f_v g_u}{d_c} \right]^{1/2}.
\tag{6.21}\]</span></span></p>
<p><a href="#fig-dispersion">Figure <span class="quarto-unresolved-ref">fig-dispersion</span></a> (a) shows a schematic diagram of the (quadratic) function <span class="math inline">\(h(k^2)\)</span> for three different values of the diffusion coefficient <span class="math inline">\(d\)</span>:</p>
<ul>
<li><span class="math inline">\(d &lt; d_c, \; h(k^2) &gt; 0\)</span>, and there is no pattern;</li>
<li><span class="math inline">\(d = d_c, \; h_{{\mathrm{min}}} = 0\)</span>, critical case;</li>
<li><span class="math inline">\(d &gt; d_c, \; h(k^2) &lt; 0\)</span>, and there is pattern.</li>
</ul>
<p>Hence we can see from <a href="#eq-spatial_eigenvalues">Equation <span class="quarto-unresolved-ref">eq-spatial_eigenvalues</span></a> that whenever <span class="math inline">\(h(k^2) &lt; 0\)</span> the curve <span class="math inline">\(\lambda(k^2)\)</span> is positive for the same range of wavenumbers that make <span class="math inline">\(h(k^2)\)</span> negative. The range of unstable wavenumbers <span class="math display">\[
k^2_1 &lt; k^2 &lt; k^2_2
\]</span> can be found from the roots of <a href="#eq-hk2">Equation <span class="quarto-unresolved-ref">eq-hk2</span></a>, <span class="math inline">\(h(k^2) = 0\)</span>:</p>
<p><span id="eq-k2range"><span class="math display">\[
\begin{aligned}
k^2_1 &amp;= \gamma \frac{(df_u + g_v) - \left\{ (df_u + g_v)^2 -4d |J| \right\}^{1/2} }{2d} &lt; k^2  \\
&amp;&lt; \gamma \frac{(df_u + g_v) +  \left\{ (df_u + g_v)^2 -4d |J| \right\}^{1/2}}{2d} = k^2_2
\end{aligned}
\tag{6.22}\]</span></span></p>
<p><a href="#fig-dispersion">Figure <span class="quarto-unresolved-ref">fig-dispersion</span></a> (b) shows a schematic diagram of <span class="math inline">\({\mathrm Re}\lambda (k^2)\)</span> for three different values of the diffusion coefficient <span class="math inline">\(d\)</span>: * $d &lt; d_c, ; <span class="math inline">\({\mathrm Re}\lambda (k^2)\)</span> &lt; 0, k^2 $, and there is no pattern; * <span class="math inline">\(d = d_c, \; k^2_c = 0\)</span>, critical case;</p>
<p>The expression <span class="math inline">\(\lambda = \lambda (k^2)\)</span> is known as the <strong>dispersion relation</strong> and the plot of <span class="math inline">\({\mathrm Re} \lambda\)</span> against <span class="math inline">\(k^2\)</span> is known as the <strong>dispersion curve</strong>.</p>
<p>From the previous analysis, within the unstable range of wavenumbers <span class="math inline">\((k^2_1 , k^2_2)\)</span>, <span class="math inline">\({\mathrm Re}\lambda (k^2) &gt; 0\)</span> has a <strong>maximum value</strong> at wavenumber <span class="math inline">\(k^2_m\)</span> given by <a href="#eq-hmin">Equation <span class="quarto-unresolved-ref">eq-hmin</span></a> when <span class="math inline">\(d &gt; d_c\)</span>. This implies that there is a <strong>fastest growing mode</strong> in the solution <a href="#eq-vxt">Equation <span class="quarto-unresolved-ref">eq-vxt</span></a> of our linearised system <a href="#eq-pp_4">Equation <span class="quarto-unresolved-ref">eq-pp_4</span></a>.</p>
<p>Recalling <a href="#eq-vxt">Equation <span class="quarto-unresolved-ref">eq-vxt</span></a>,<br />
<span class="math display">\[
V(x,t) = \sum_k C_k e^{\lambda(k^2) t} \, \psi_k(x),
\]</span> and noting the above analysis, this implies that as <span class="math inline">\(t\to \infty\)</span> the dominant contributions in the above sum are those for which <span class="math inline">\({\mathrm Re} \lambda(k^2) &gt; 0\)</span>, since all other modes will tend to zero exponentially fast as <span class="math inline">\(t\to \infty\)</span>. Thus, for large <span class="math inline">\(t\)</span>, the solution is effectively given by: <span class="math display">\[
V(x,t) \approx \sum_{k_{1}}^{k_2} C_k e^{\lambda(k^2) t} \, \psi_k(x) \; .
\]</span></p>
<p>%The critical value of <span class="math inline">\(d=d_c\)</span> at which the bifurcation to instability occurs is defined by <span class="math inline">\(h_{\textrm{min}} =0\)</span>, i.e. such value of <span class="math inline">\(d\)</span> at which <span class="math inline">\(h(k^2)=0\)</span> has a double root.</p>
<p>** include figure dispersion **</p>

<!--
%\textbf{ Dispersion relation}  \; When the diffusion coefficient $d$  increases beyond the critical value $d_c$, $h(k^2)$ becomes negative over a finite interval $(k_-^2, k_+^2)$, where $k^2_\pm$ are zeros of the quadratic equation $h(k^2) =0$. Thus   $(k_-^2, k_+^2)$ is the range of the unstable wave numbers. 
%
%We have also that eigenvalues $\lambda= \lambda(k)$ depend on  wave numbers $k$. This dependence  $\lambda= \lambda(k)$ is called a dispersion relation. 
%
%Thus for $d> d_c$ there exists a range of values of $k^2$ for which $Re(\lambda(k)) >0$. Note that $Re(\lambda(k))$ has a maximum for some $k^2_\text{max}(d)$ in this range. 
%
%The diversion relation is important as it says which eigenfunctions, i.e. which spatial patterns,  are linearly unstable and grow exponentially with time. 
%
%In unbounded domain, where  all wave numbers are possible, $k_{\text{max}}$ represent the wave number of the most fast growing mode ( corresponding eigenvalue with the greatest real part). 
%In a bounded domain wave numbers are discrete and so only certain $k$ in the range  
%$(k_-^2, k_+^2)$ are relevant for the formation of spatial patterns.  In this case $k_{\text{max}}$ is not necessary a wave number and the most fast growing mode is the closest to $k_{\text{max}}$ wave number.  In fact it is possible that for bounded domains the region $(k_-^2, k_+^2)$ does not contain any wave numbers and no unstable mode for such values of $d$ would exist. It means that a narrow diskersion relation results into a situation that we miss all wave numbers and none of eigenvalues with 
%$Re(\lambda(k)) >0$ can be found, i.e. all modes will decay exponentially to zero. 
-->
<p><strong>NOTE</strong></p>
<p>All the previous calculations concern a <strong>linear stability analysis</strong> carried out about a spatially homogeneous steady state of the system <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a>. This linear theory indicates that for <span class="math inline">\(d &gt; d_c\)</span> there exists a finite number of <strong>linearly unstable</strong> spatial eigenfunctions which grow exponentially as <span class="math inline">\(t \to \infty\)</span>. However, this linear theory holds only when we are close to the steady state i.e. it only holds for small perturbations. In the full <strong>nonlinear system</strong> the exponentially growing (unbounded) modes will eventually be bounded by the nonlinear terms and so bounded, stable spatial patterns characterised by the corresponding wavenumbers will be formed.</p>
<p><strong>Summary</strong></p>
<p>We have obtained conditions for the generation of spatial patterns via systems of reaction-diffusion equations of the general form <a href="#eq-pp">Equation <span class="quarto-unresolved-ref">eq-pp</span></a>. Such systems involve <strong>two chemicals or morphogens</strong> reacting and diffusing together to generate a chemical pre-pattern that underlies a subsequent cellular pattern. The four conditions are as follows:</p>
<p><span id="eq-pattern_conditions"><span class="math display">\[
\begin{aligned}
f_u + g_v &amp;&lt; 0, \\
f_u g_v - f_v g_u &amp;&gt; 0, \\
d f_u + g_v &amp;&gt; 0, \\
(d f_u + g_v)^2 - 4d (f_u g_v - f_v g_u)^2 &amp;&lt; 0 , \nonumber
\end{aligned}
\tag{6.23}\]</span></span> with all partial derivatives being evaluated at the spatially homogeneous steady state <span class="math inline">\((u_0 , v_0)\)</span>.</p>
<p>From the first and third conditions, <span class="math inline">\(d \neq 1\)</span> and <span class="math inline">\(f_u\)</span> and <span class="math inline">\(g_v\)</span> must be of different signs. For each of the reaction kinetics mentioned here (Schnakenberg, Gierer-Meinhardt, Thomas), we have that <span class="math inline">\(f_u &gt; 0, g_v &lt; 0\)</span> and so this implies that <span class="math inline">\(d &gt; 1\)</span>.</p>
<p>If the conditions <a href="#eq-pattern_conditions">Equation <span class="quarto-unresolved-ref">eq-pattern_conditions</span></a> are satisfied, then there is a range of unstable wavenumbers given by <a href="#eq-k2range">Equation <span class="quarto-unresolved-ref">eq-k2range</span></a> which give rise to a spatial pattern. The spatial patterns which initially grow are those spatial eigenfunctions <span class="math inline">\(\psi_k(x)\)</span> whose wavenumbers <span class="math inline">\(k\)</span> are such that <span class="math inline">\(k_1 &lt; k &lt; k_2\)</span>.</p>
<p>In most biological systems, the kinetic parameters and diffusion coefficients are fixed. This means that the only variable parameter in the system is <span class="math inline">\(\gamma\)</span> which as we have seen is related to the size of the domain under consideration. This has implications when considering patterns on finite domains, as will be seen in the next section.</p>
</section>
</section>
<section id="exercises" class="level2" data-number="6.6">
<h2 data-number="6.6"><span class="header-section-number">6.6</span> Exercises</h2>
<p>Demonstrate that the derived results are consistent with numerical solutions. Some predictions to test:</p>
<ul>
<li>No patterning when diffusion coefficients are equal</li>
<li>How does spatial pattern formation change as you try values of parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>?</li>
<li>Can you correlate the observation of pattern to the conditions for DDI being satisfied?</li>
<li>what about different kinetics (e.g. Gierer-Meinhardt, Thomas models)?</li>
</ul>
</section>
<section id="references" class="level2" data-number="6.7">
<h2 data-number="6.7"><span class="header-section-number">6.7</span> References</h2>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">MA42002</span> <span class="hidden" data-render-id="quarto-int-navbar-title">MA42002</span> <span class="hidden" data-render-id="quarto-int-next"><span class="chapter-number">7</span>  <span class="chapter-title">Mathematical modelling of infectious disease</span></span> <span class="hidden" data-render-id="quarto-int-prev"><span class="chapter-number">5</span>  <span class="chapter-title">Aggregation via Chemotaxis</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/index.html">Introduction</span> <span class="hidden" data-render-id="quarto-int-sidebar:/conservationequations.html"><span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-1">Single species</span> <span class="hidden" data-render-id="quarto-int-sidebar:/linearreactiondiffusion.html"><span class="chapter-number">2</span>  <span class="chapter-title">Linear reaction diffusion equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/nonlinearreactiondiffusion.html"><span class="chapter-number">3</span>  <span class="chapter-title">Non linear reaction diffusion equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-2">Multi species</span> <span class="hidden" data-render-id="quarto-int-sidebar:/LotkaVolteraPDE.html"><span class="chapter-number">4</span>  <span class="chapter-title">Lotka Voltera model</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/BacterialChemotaxis.html"><span class="chapter-number">5</span>  <span class="chapter-title">Aggregation via Chemotaxis</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/DiffusionDrivenInstability.html"><span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/SIR_PDE.html"><span class="chapter-number">7</span>  <span class="chapter-title">Mathematical modelling of infectious disease</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-3">Appendices</span> <span class="hidden" data-render-id="quarto-int-sidebar:/NumericalMethods.html"><span class="chapter-number">8</span>  <span class="chapter-title">Numerical methods in Python</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/linearstablityanalysis.html"><span class="chapter-number">9</span>  <span class="chapter-title">Linear stability analysis of a system of nonlinear ODES</span></span> <span class="hidden" data-render-id="quarto-breadcrumbs-bf472332329900ef1166b7063dd4c280">Multi species</span> <span class="hidden" data-render-id="quarto-breadcrumbs-baf9e3c3633910b2662d6e32a3812e1c"><span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">MA42002 - <span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span> <span class="hidden" data-render-id="quarto-twittercardtitle">MA42002 - <span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span> <span class="hidden" data-render-id="quarto-ogcardtitle">MA42002 - <span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span> <span class="hidden" data-render-id="quarto-metasitename">MA42002</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-gierer1972theory" class="csl-entry" role="listitem">
<span>“A Theory of Biological Pattern Formation.”</span> 1972. <em>Kybernetik</em> 12: 30–39.
</div>
<div id="ref-murray1984generation" class="csl-entry" role="listitem">
Murray, James D, and George F Oster. 1984. <span>“Generation of Biological Pattern and Form.”</span> <em>Mathematical Medicine and Biology: A Journal of the IMA</em> 1 (1): 51–75.
</div>
<div id="ref-murray1981pre" class="csl-entry" role="listitem">
Murray, JD610574. 1981. <span>“A Pre-Pattern Formation Mechanism for Animal Coat Markings.”</span> <em>Journal of Theoretical Biology</em> 88 (1): 161–99.
</div>
<div id="ref-turing1990chemical" class="csl-entry" role="listitem">
Turing, Alan Mathison. 1990. <span>“The Chemical Basis of Morphogenesis.”</span> <em>Bulletin of Mathematical Biology</em> 52: 153–97.
</div>
</div>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/BacterialChemotaxis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>Aggregation via Chemotaxis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/SIR_PDE.html" class="pagination-link">
        <span class="nav-page-text"><span class='chapter-number'>7</span>  <span class='chapter-title'>Mathematical modelling of infectious disease</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->

</body>

</html>