[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MA42002",
    "section": "",
    "text": "Preface\nThis is a Quarto book.\nTo learn more about Quarto books visit https://quarto.org/docs/books."
  },
  {
    "objectID": "DiffusionDrivenInstability.html#reaction-diffusion-turing-pre-pattern-mechanisms",
    "href": "DiffusionDrivenInstability.html#reaction-diffusion-turing-pre-pattern-mechanisms",
    "title": "6  Diffusion driven instability",
    "section": "6.1 Reaction-diffusion (Turing) Pre-pattern Mechanisms",
    "text": "6.1 Reaction-diffusion (Turing) Pre-pattern Mechanisms\nWe now consider our general (dimensional) reaction-diffusion model for two chemicals or morphogens with concentrations \\(A({\\bf x}, t)\\) and \\(B({\\bf x}, t)\\) which react together and diffuse in some spatial domain:\n\\[\\begin{eqnarray*}\n\\frac{\\partial A}{\\partial  t} & = & F(A,B)  + D_A \\nabla^2 A, \\\\\n\\frac{\\partial B}{\\partial  t} & = & G(A,B)  + D_B \\nabla^2 B,\n\\end{eqnarray*}\\]\nwhere \\(F(A,B)\\) and \\(G(A,B)\\) describe the reaction kinetics between the two morphogens and \\(D_A, D_B &gt; 0\\) are the diffusion coefficients. Turing’s theory (Turing, 1952) The chemical basis of morphogenesis proposed that it was the diffusion of the substances \\(A, B\\) which led to the evolution of a spatially heterogeneous solution to arise i.e. a spatial pattern. This has given rise to the phrase diffusion-driven instability. This was a rather revolutionary and counter-intuitive proposal, since, as we have seen, diffusion normally has the opposite tendency i.e. to smooth or average out spatial heterogeneities, and to give rise to spatially homogeneous solutions.\nVarious forms can be considered for the kinetic functions \\(F\\) and \\(G\\). However, we will focus mainly on three specific classes as follows:\n\n6.1.1 Schnackenberg Kinetics\n\\[\nF(A,B) = k_1 - k_2 A + k_3 A^2 B, \\;\\;\\;\\; G(A,B) = k_4 - k_3 A^2 B\n\\]\n\\(k_1, k_2, k_3, k_4 &gt;0\\). The term \\(k_3 A^2 B\\) is autocatalytic, since the species \\(A\\) is involved in its own production. \n\n\n6.1.2 Activator-inhibitor kinetics cf. Gierer-Meinhardt system; Gierer & Meinhardt, 1972\n\\[\nF(A,B) = k_1 - k_2 A + \\frac{k_3 A^2}{B}, \\;\\;\\;\\; G(A,B) = k_4 A^2 - k_5 B\n\\]\n\\(k_1, k_2, k_3, k_4 , k_5 &gt; 0\\). Again, the term \\(k_3 A^2 / B\\) is autocatalytic.\n\n\n6.1.3 Substrate-inhibition system (Thomas, 1975)\n\\[F(A,B) = k_1 - k_2 A - H(A,B), \\;\\;\\;\\; G(A,B) = k_4 A^2 - k_4 B -H(A,B), \\]\n\\[H(A,B) = \\frac{k_5 AB}{k_6 + k_7 + k_8 A^2}\\;,\\]\n\\(k_i &gt; 0\\). In the original paper of Thomas (1975), \\(A\\) represents the concentration of oxygen (substrate) and \\(B\\) the concentration of uricase (enzyme). Substrate inhibition is evident in the term \\(k_8 A^2\\)."
  },
  {
    "objectID": "DiffusionDrivenInstability.html#non-dimensionalization",
    "href": "DiffusionDrivenInstability.html#non-dimensionalization",
    "title": "6  Diffusion driven instability",
    "section": "6.2 Non-dimensionalization",
    "text": "6.2 Non-dimensionalization\nBefore proceeding with our analysis, it is prudent to non-dimensionalize each of the above systems. We illustrate this process for the Schnakenberg kinetics. Using the scaling,\n\\[u = A \\left( \\frac{k_3}{k_2} \\right)^{1/2}, \\;\\;\\;\\; v = B \\left( \\frac{k_3}{k_2} \\right)^{1/2}, \\;\\;\\;\\; t^* = \\frac{D_A t}{L^2}, \\;\\;\\;\\; x^* = \\frac{x}{L},\\]\nwhere \\(L\\) is a typical length scale, the dimensionless reaction-diffusion system with Schnakenberg kinetics becomes (upon dropping the \\(*\\)):\n\\[\n\\begin{eqnarray*}\n\\frac{\\partial u}{\\partial  t} & = &\\gamma ( a - u + u^2 v ) + \\nabla^2 u = \\gamma f(u,v)  + \\nabla^2 u, \\\\\n\\frac{\\partial v}{\\partial  t} & = &\\gamma ( b - u^2 v ) + d \\nabla^2 v = \\gamma g(u,w)  + d \\nabla^2 v,\n\\end{eqnarray*}\n\\tag{6.1}\\] where \\[\nd = \\frac{D_B}{D_A}, \\;\\;\\; a = \\frac{k_1}{k_2} \\left( \\frac{k_3}{k_2} \\right)^{1/2}, \\;\\;\\; b = \\frac{k_4}{k_2} \\left( \\frac{k_3}{k_2} \\right)^{1/2}, \\;\\;\\; \\gamma = \\frac{L^2 k_2}{D_A}.\n\\]\nThe Gierer-Meinhardt and Thomas kinetics can be non-dimensionalized as follows:\n\\[\\begin{eqnarray*}\nf(u, v) & = & a - b u + \\frac{u^2}{v}, \\;\\;\\; g(u,v) = u^2 - v, \\\\\n& & \\\\\nf(u,v) & = & a - u - h(u,v), \\;\\;\\; g(u,v) = \\alpha (b - v) - h(u,v), \\\\\nh(u,v) & = & \\frac{\\rho u v}{1 + u + K u^2},\n\\end{eqnarray*}\\]\nwhere \\(a , b, \\alpha, \\rho , K\\) are positive parameters (Exercise/Tutorial). \\\nAny reaction-diffusion system can be non-dimensionalized and scaled following the above procedure to take the following general form:\n\\[\\begin{eqnarray*}\n\\frac{\\partial u}{\\partial  t} & = &  \\gamma f(u,v)  + \\nabla^2 u, \\\\\n\\frac{\\partial v}{\\partial  t} & = & \\gamma g(u,w)  + d \\nabla^2 v,\n\\end{eqnarray*}\\]\nwhere the parameter \\(d\\) is the ratio of the diffusion coefficients from the dimensional system and the parameter \\(\\gamma\\) can be interpreted in any one of the following ways:\n\n\\(\\gamma^{1/2}\\) is proportional to the {} of the spatial domain in one-dimension. In two-dimensions, \\(\\gamma\\) is proportional to the area.\n\\(\\gamma\\) represents the relative strength of the reaction terms – an increase in \\(\\gamma\\) may represent an increase in the activity of some rate-limiting step in the reaction sequence.\nAn increase in \\(\\gamma\\) is equivalent to a decrease in the diffusion coefficient \\(d\\).\n\nNote that in the case where the parameter \\(d &gt; 1\\), this means that the original diffusion coefficients are not equal. Specifically, in the case of the Gierer-Meinhardt activator-inhibitor system, \\(d &gt;1\\) implies that the inhibitor diffuses more quickly than the activator [\\(d &gt; 1 \\Rightarrow D_B &gt; D_A\\) ]. The spatial implications of this are shown in figure \\(\\ref{AI}\\) – the inhibitor diffuses a greater distance than the activator, giving rise to what is known as local activation, long-range inhibition."
  },
  {
    "objectID": "DiffusionDrivenInstability.html#numerical-solution",
    "href": "DiffusionDrivenInstability.html#numerical-solution",
    "title": "6  Diffusion driven instability",
    "section": "6.3 Numerical solution",
    "text": "6.3 Numerical solution\nIn Figure Figure 6.1 we plot numerical solutions of Equation 6.1 with no flux boundary conditions.\nIn this numerical solution the initial condition are the spatially homogeneous steady state perturbed by uniformly sampled noise. As time evolves a spatial pattern emerges. The main idea from a biological perspeftive is that an unpatterned region of an embryo could undergo chemical reactions, with the result being a patterned chemcial field.\nSOme question that might arise:\n\nHow does pattern formation depend on model parameters?\nHow does pattern formation depend on domain size?\nHow does the pattern wavelength depend on model parameters?\nHow does the pattern depend on the initial conditions?\nHow can we numerically solve the reaction diffusion PDEs?\n\n\n\nCode\nimport numpy as np\nfrom scipy.integrate import odeint\nfrom scipy.integrate import solve_ivp\n\nimport matplotlib.pyplot as plt\nimport random\n\nT=3\nL=1\n\ngamma=650.0\na=0.2\nb=1.3\nd=30.0\n\nN_x=80\nN_t=50\n\nt=np.linspace(1,T,N_t)\nx=np.linspace(0,L,N_x)\n\nu_0=(a+b)*np.ones_like(x)+0.01*np.random.uniform(low=-1.0, high=1.0, size=(N_x,))\nv_0=b*(1/(a+b)**2)*np.ones_like(x)+0.01*np.random.uniform(low=-1.0, high=1.0, size=(N_x,))\n\nu_0=np.concatenate((u_0,v_0))\n\ndx=L/(N_x-1)\ndt=T/(N_t-1)\n\ndef ShcnackPDErhs(sol,t):\n\n    N_x=int(np.ceil(len(sol)/2))\n\n    u=sol[0:N_x]\n    v=sol[N_x:]\n\n    f_u=np.zeros_like(u)\n    f_v=np.zeros_like(u)\n\n    for i in range(1,N_x-2):\n      f_u[i]=1/dx**2*(u[i-1]-2*u[i]+u[i+1]) \n\n    i=0\n    f_u[i]=1/dx**2*(-u[i]+u[i+1])\n\n    i=N_x-1\n    f_u[i]=1/dx**2*(u[i-1]-u[i])\n\n\n    for i in range(1,N_x-2):\n      f_v[i]=d/dx**2*(v[i-1]-2*v[i]+v[i+1]) \n    i=0\n    f_v[i]=d/dx**2*(-v[i]+v[i+1]) \n    i=N_x-1\n    f_v[i]=d/dx**2*(v[i-1]-v[i])\n\n    reaction_u=gamma*(a-u+(u**2)*v)\n    reaction_v=gamma*(b-(u**2)*v)\n\n    f_u=f_u+reaction_u\n    f_v=f_v+reaction_v\n\n    f= np.concatenate((f_u,f_v)) \n    return f  \n\nsol=odeint(ShcnackPDErhs,u_0,t)\n#soln = solve_ivp(ShcnackPDErhs,(0, T), u_0, method='Radau')\n\nu=sol[:,0:N_x]\nv=sol[:,N_x:]\n\nfig, ax = plt.subplots(2,1)\n\nax[0].plot(x,u[0,:],'r')\nax[0].plot(x,u[16,:],'b')\nax[0].plot(x,u[32,:],'m')\nax[0].plot(x,u[48,:],'k')\nax[0].set_xlabel('$x$')\nax[0].set_ylabel('$u$')\n\nax[1].plot(x, v[0,:],'r--')\nax[1].plot(x, v[16,:],'b--')\nax[1].plot(x, v[32,:],'m--')\nax[1].plot(x, v[48,:],'k--')\nax[1].set_xlabel('$x$')\nax[1].set_ylabel('$v$')\n\nplt.legend(['t'+ str(t[0]),'t='+ str(t[4]),'t='+ str(t[8]),'t='+ str(t[12])])\nplt.xlabel('$x$')\nplt.grid()\nplt.show()\n\n\n\n\n\nFigure 6.1: DDI with Schnackenberg kinetics\n\n\n\n\nIn Figure Figure 6.2 we consider a numerical solution of the Schnackenberg model on a 2D square domain with no-flux boundary conditions. Note\n\n\nCode\nimport numpy as np\nfrom scipy.integrate import odeint\nfrom scipy.integrate import solve_ivp\n\nimport matplotlib.pyplot as plt\nimport random\n\nT=5\nL=1\n\ngamma=650.0\na=0.2\nb=1.3\nd=25.0\n\nN_x=20\nN_t=30\n\nt=np.linspace(1,T,N_t)\nx=np.linspace(0,L,N_x)\ny=np.linspace(0,L,N_x)\n\n[x,y]=np.meshgrid(x,y)\n\nu_0=(a+b)*np.ones_like(x)+0.01*np.random.uniform(low=-1.0, high=1.0, size=(N_x,N_x))\nv_0=b*(1/(a+b)**2)*np.ones_like(x)+0.01*np.random.uniform(low=-1.0, high=1.0, size=(N_x,N_x))\n\nu_0=np.concatenate((np.ravel(u_0),np.ravel(v_0)))\n\ndx=L/(N_x-1)\ndt=T/(N_t-1)\n\n\n\ndef ShcnackPDErhs2d(sol,t):\n\n    num_nodes=int(np.ceil(len(sol)/2))\n\n    u=sol[0:num_nodes]\n    v=sol[num_nodes:]\n\n\n    u=np.reshape(u,(N_x,N_x))\n    v=np.reshape(v,(N_x,N_x))\n\n    f_u=np.zeros_like(u)\n    f_v=np.zeros_like(u)\n\n \n\n    for i in range(1,N_x-2):\n      for j in range(1,N_x-2):\n        f_u[i,j]=1/dx**2*(u[i-1,j]-4*u[i,j]+u[i+1,j]+u[i,j+1]+u[i,j-1]) \n        f_v[i,j]=d/dx**2*(v[i-1,j]-4*v[i,j]+v[i+1,j]+v[i,j+1]+v[i,j-1]) \n\n    i=0 \n    for j in range(1,N_x-2):\n      f_u[i,j]=1/dx**2*(-3*u[i,j]+u[i+1,j]+u[i,j+1]+u[i,j-1]) \n      f_v[i,j]=d/dx**2*(-3*v[i,j]+v[i+1,j]+v[i,j+1]+v[i,j-1]) \n\n    i=N_x-1\n    for j in range(1,N_x-2):\n      f_u[i,j]=1/dx**2*(u[i-1,j]-3*u[i,j]+u[i,j+1]+u[i,j-1]) \n      f_v[i,j]=d/dx**2*(v[i-1,j]-3*v[i,j]+v[i,j+1]+v[i,j-1])   \n\n    j=0\n    for i in range(1,N_x-2):\n        f_u[i,j]=1/dx**2*(u[i-1,j]-3*u[i,j]+u[i+1,j]+u[i,j+1]) \n        f_v[i,j]=d/dx**2*(v[i-1,j]-3*v[i,j]+v[i+1,j]+v[i,j+1]) \n\n    j =N_x-1\n    for i in range(1,N_x-2):\n        f_u[i,j]=1/dx**2*(u[i-1,j]-3*u[i,j]+u[i+1,j]+u[i,j-1]) \n        f_v[i,j]=d/dx**2*(v[i-1,j]-3*v[i,j]+v[i+1,j]+v[i,j-1])  \n\n    i=0\n    j=0\n    f_u[i,j]=1/dx**2*(-2*u[i,j]+u[i+1,j]+u[i,j+1]) \n    f_v[i,j]=d/dx**2*(-2*v[i,j]+v[i+1,j]+v[i,j+1]) \n\n    i=0\n    j=N_x-1\n    f_u[i,j]=1/dx**2*(-2*u[i,j]+u[i+1,j]+u[i,j-1]) \n    f_v[i,j]=d/dx**2*(-2*v[i,j]+v[i+1,j]+v[i,j-1]) \n\n    i=N_x-1\n    j=0\n\n    f_u[i,j]=1/dx**2*(u[i-1,j]-2*u[i,j]+u[i,j+1]) \n    f_v[i,j]=d/dx**2*(v[i-1,j]-2*v[i,j]+v[i,j+1]) \n    \n    i=N_x-1\n    j=N_x-1\n\n\n    f_u[i,j]=1/dx**2*(-2*u[i,j]+u[i-1,j]+u[i,j-1]) \n    f_v[i,j]=d/dx**2*(-2*v[i,j]+v[i-1,j]+v[i,j-1]) \n\n\n    reaction_u=gamma*(a-u+(u**2)*v)\n    reaction_v=gamma*(b-(u**2)*v)\n\n    f_u=f_u+reaction_u\n    f_v=f_v+reaction_v\n\n\n\n    f= np.concatenate((np.ravel(f_u),np.ravel(f_v))) \n    return f  \n\nsol=odeint(ShcnackPDErhs2d,u_0,t)\n#soln = solve_ivp(ShcnackPDErhs,(0, T), u_0, method='Radau')\n\n\nu_0=sol[0,0:N_x**2]\nv_0=sol[0,N_x**2:]\nu_0=np.reshape(u_0,(N_x,N_x))\nv_0=np.reshape(v_0,(N_x,N_x))\n\nu_m=sol[20,0:N_x**2]\nv_m=sol[20,N_x**2:]\nu_m=np.reshape(u_m,(N_x,N_x))\nv_m=np.reshape(v_m,(N_x,N_x))\n\nu=sol[-1,0:N_x**2]\nv=sol[-1,N_x**2:]\nu=np.reshape(u,(N_x,N_x))\nv=np.reshape(v,(N_x,N_x))\n\nfig, ax = plt.subplots(2,3)\nax[0,0].imshow(u_0)\nax[1,0].imshow(v_0)\nax[0,1].imshow(u_m)\nax[1,1].imshow(v_m)\nax[0,2].imshow(u)\nax[1,2].imshow(v)\n\n'''\nax[0].plot(x,u[0,:],'r')\nax[0].plot(x,u[16,:],'b')\nax[0].plot(x,u[32,:],'m')\nax[0].plot(x,u[48,:],'k')\nax[0].set_xlabel('$x$')\nax[0].set_ylabel('$u$')\n\nax[1].plot(x, v[0,:],'r--')\nax[1].plot(x, v[16,:],'b--')\nax[1].plot(x, v[32,:],'m--')\nax[1].plot(x, v[48,:],'k--')\nax[1].set_xlabel('$x$')\nax[1].set_ylabel('$v$')\n'''\n\nplt.xlabel('$x$')\nplt.show()\n\n\n\n\n\nFigure 6.2: DDI with Schnackenberg kinetics in 2D"
  },
  {
    "objectID": "DiffusionDrivenInstability.html#linear-stability-analysis-and-evolution-of-spatial-pattern-general-conditions-for-diffusion-driven-instability",
    "href": "DiffusionDrivenInstability.html#linear-stability-analysis-and-evolution-of-spatial-pattern-general-conditions-for-diffusion-driven-instability",
    "title": "6  Diffusion driven instability",
    "section": "6.4 Linear Stability Analysis and Evolution of Spatial Pattern: General Conditions for Diffusion-driven Instability",
    "text": "6.4 Linear Stability Analysis and Evolution of Spatial Pattern: General Conditions for Diffusion-driven Instability\nLet \\(\\Omega\\subset \\mathbb R^n\\) be a domain with smooth (sufficiently regular) boundary \\(\\partial \\Omega\\), with outward unit normal \\({\\bf n}\\). Our general, non-dimensional reaction-diffusion system is then:\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t} = \\gamma\\, f(u,v)  +  \\nabla^2 u, \\qquad x\\in \\Omega, \\quad t&gt;0, \\\\\n&\\frac{\\partial v}{\\partial  t} = \\gamma\\, g(u,v)  + d \\nabla^2 v, \\qquad x\\in \\Omega, \\quad t&gt;0, \\\\\n&\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.2}\\] \\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\nabla u \\cdot {\\bf n } = 0, \\qquad \\nabla v \\cdot {\\bf n } = 0, \\qquad x\\in \\partial \\Omega, \\quad t&gt;0, \\\\\nu(x,0)  = u_0(x), \\qquad  v(x,0)  = v_0(x), \\qquad x\\in \\Omega\\; .\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.3}\\]\nA spatially homogeneous steady-state of the system Equation 6.2 satisfies \\[\nf(u,v) = 0 , \\qquad g(u,v) =0\n\\] and we denote it by \\((u_0, v_0)\\).\n\n6.4.1 Stability of spatially homogeneous steady states to spatially homogeneous perturbations\nBefore we consider the effect of the spatial terms in the system (i.e. diffusion), we first of all explore the stability of the underlying spatially homogeneous steady state, defined previously.\nConsider the following perturbations to the steady state \\((u_0 , v_0)\\): \\[\nu(x,t) = u_0 + \\tilde u(t), \\quad  v(x,t) = v_0 + \\tilde v(t), \\qquad \\|\\tilde u(t) \\| \\ll 1, \\quad  \\|\\tilde v(t) \\| \\ll 1.\n\\]\nSubstitute these into Equation 6.2 \\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\frac{d\\tilde u}{d t} = \\gamma\\, f(u_0 + \\tilde u,v_0 + \\tilde v) ,  \\\\\n\\frac{d \\tilde v}{d  t} = \\gamma\\, g(u_0 + \\tilde u,v_0 + \\tilde v) ,\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.4}\\]\nand using a Taylor expansion of \\(f\\) and \\(g\\) about \\((u_0, v_0)\\) we obtain the linearised system \\[\n\\begin{equation}\n\\begin{pmatrix}\n\\tilde u_t \\\\\n\\tilde v_t\n\\end{pmatrix}  = \\gamma J  \\begin{pmatrix}\n\\tilde u \\\\\n\\tilde v\n\\end{pmatrix}  ,\n\\end{equation}\n\\tag{6.5}\\] where \\[\nJ =J(u_0, v_0) =  \\begin{pmatrix}\nf_u & f_v  \\\\\ng_u & g_v\n\\end{pmatrix}_{(u_0 , v_0)} \\; .  \n\\]\nThe general solution of the above system of linear ODEs Equation 6.5 is\n\\[\n\\begin{pmatrix}\n\\tilde u(t) \\\\\n\\tilde v(t)\n\\end{pmatrix}   =  C_1 \\phi_1 e^{\\lambda_1 t} +  C_2 \\phi_2 e^{\\lambda_2 t}  ,\n\\] where \\(C_1\\), \\(C_2\\) are arbitrary constants, \\(\\lambda_1, \\lambda_2\\) are the eigenvalues of \\(\\gamma J\\), i.e. solutions of characteristic equation \\[\n\\det (\\gamma J - \\lambda I) = 0,\n\\] and \\(\\phi_1\\), \\(\\phi_2\\) are corresponding eigenvectors. It is easily seen that\n\\[\n\\lambda_{1,2} = \\frac \\gamma 2 \\left( \\text{tr} (J) \\pm \\sqrt{ \\text{tr}(J)^2 - 4 \\det(J)} \\right),\n\\]\nand thus a spatially homogeneous steady state \\((u_0, v_0)\\) is stable to spatially homogeneous perturbations if \\[\n{\\rm Re}( \\lambda_{1,2}) &lt;0,\n\\] i.e. if\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\text{tr}(J) & = f_u + g_v &lt; 0, \\\\\n\\det(J) & = f_u g_v - f_v g_u &gt; 0.\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.6}\\]\nConditions Equation 6.6 provide restrictions on the parameters in the model equations Equation 6.2. We shall be interested only in such parameter values for which conditions Equation 6.6 are satisfied.\n\n\n6.4.2 Stability of spatially homogeneous steady states to spatially heterogeneous: spatially dependent, perturbations\nWe now consider perturbations about the spatially homogeneous steady state that are spatially dependent i.e.  \\[\nu(x,t) = u_0 + \\tilde u(x,t), \\quad  v(x,t) = v_0 + \\tilde v(x,t), \\qquad \\|\\tilde u(x,t) \\| \\ll 1, \\quad  \\|\\tilde v(x,t) \\| \\ll 1 .\n\\]\nOnce again substitute into Equation 6.2 and apply a Taylor expansion about \\((u_0, v_0)\\) to \\(f\\) and \\(g\\) to obtain the linearised problem\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\frac{\\partial \\tilde u(x,t)}{\\partial t} = \\gamma\\, \\left(f_u \\tilde u(x,t) + f_v \\tilde v(x,t)\\right) + \\nabla^2 \\tilde u(x,t)  , \\quad x\\in \\Omega, \\;  t &gt;0, \\\\\n\\frac{\\partial \\tilde v(x,t)}{\\partial   t} = \\gamma\\,  \\left(g_u  \\tilde u(x,t) + g_v \\tilde v(x,t)\\right) +d \\nabla^2 \\tilde v(x,t)  ,  \\quad x\\in \\Omega, \\;  t &gt;0,  \\\\\n{\\bf n} \\cdot \\nabla \\tilde u (x,t) = 0, \\qquad {\\bf n} \\cdot \\nabla \\tilde v (x,t)  = 0, \\qquad   x\\in   \\partial \\Omega, \\; t &gt;0\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.7}\\]\nDefining \\[\nV(x,t) = \\begin{pmatrix}\n\\tilde u(x,t) \\\\\n\\tilde v(x,t)\n\\end{pmatrix}\n\\] we can rewrite Equation 6.7 as \\[\n\\frac{\\partial}{\\partial t}  V(x,t) = \\gamma J  V(x,t) + D \\nabla^2   V(x,t),\n\\]\nwhere\n\\[\nD =  \\begin{pmatrix}\n1 & 0 \\\\\n0 & d\n\\end{pmatrix}\\;.\n\\]\nWe shall consider a separation of variables approach i.e. \\[\nV(x,t) =\\begin{pmatrix}  \n\\bar u(t)  \\varphi_1(x)\n\\\\\n\\bar v(t)  \\varphi_2(x)\n\\end{pmatrix}\\;\n\\] and obtain \\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\frac{d \\bar u(t)}{d t}\\varphi_1(x) = \\gamma\\, \\left(f_u \\bar u(t) \\varphi_1(x) + f_v \\bar v(t) \\varphi_2(x)\\right) +\\bar u(t)  \\nabla^2 \\varphi_1(x)  , \\quad x\\in \\Omega, \\;  t &gt;0, \\\\\n\\frac{d \\bar v(t)}{d t}\\varphi_2(x) = \\gamma\\,  \\left(g_u  \\bar u(t) \\varphi_1(x) + g_v \\bar v(t) \\varphi_2(x)\\right) +  d \\bar v(t) \\nabla^2  \\varphi_2(x)  ,  \\quad x\\in \\Omega, \\;  t &gt;0,  \\\\\n{\\bf n} \\cdot \\nabla \\varphi_1(x) = 0, \\qquad {\\bf n} \\cdot \\nabla\\varphi_2 (x) = 0, \\qquad   x\\in   \\partial \\Omega, \\; t &gt;0\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.8}\\] with \\[\n\\bar u(t)\\, / \\hspace{-0.35 cm}\\equiv 0 \\quad \\textrm{and} \\quad  \\bar v(t)\\, / \\hspace{-0.35 cm}\\equiv 0\n\\] for \\(t&gt;0\\).\nConsider the spatial eigenvalue problem for the Laplacian \\(\\nabla^2\\) with zero-Neumann boundary conditions i.e.\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\nabla^2 \\psi(x) = -k^2 \\psi(x) , \\qquad x \\in \\Omega ,  \\\\\n{\\bf n} \\cdot \\nabla \\psi(x) = 0 , \\qquad x\\in \\partial \\Omega \\; .\n\\end{aligned}\n\\end{eqnarray}\n\\tag{6.9}\\]\nFor a bounded domain \\(\\Omega\\) there exists a discrete set of eigenvalues \\[\n0 \\leq k^2_1&lt; k_2^2\\leq k_3^2\\leq \\ldots \\leq k_j^2\\leq \\ldots,\n\\] with \\[\nj \\in \\mathbb N, \\quad  \\textrm{and} \\quad k_j^2 \\to \\infty \\quad \\textrm{as}  \\quad j \\to \\infty.\n\\]\nMoreover, the eigenfunctions ${ _k } $ form an orthogonal set of basis functions of the corresponding functional space (i.e. \\(L^2(\\Omega)\\), \\(H^1(\\Omega)\\)).\nThus we can look for the spatial component of the solution as follows: \\[\n\\varphi(x) = \\begin{pmatrix}  \n\\varphi_1(x) \\\\\n\\varphi_2(x)\n\\end{pmatrix} = \\sum_k C_k \\psi_k(x), \\qquad C_k =  \\begin{pmatrix}  C_k^1 \\\\ C_k^2 \\end{pmatrix} \\in \\mathbb R^2 \\;\n\\] and \\[\n\\begin{equation}\nV(x,t) =\\sum_k \\hat V_k(t) \\psi_k(x), \\qquad \\text{ where}\n\\quad \\hat V_k(t)=\n\\begin{pmatrix}  \nC_k^1 \\; \\bar u(t)\n\\\\\nC_k^2 \\; \\bar v(t)\n\\end{pmatrix}\\; .\n\\end{equation}\n\\tag{6.10}\\]\nThen since \\(\\nabla^2 \\psi_k(x) = - k^2 \\psi_k(x)\\) we obtain\n\\[\nD \\nabla^2  V(x,t) = D \\nabla^2 \\left[ \\sum_k \\hat V_k(t) \\psi_k(x) \\right]   = \\sum_k D \\hat V_k(t) \\nabla^2 \\psi_k(x)=\n- \\sum_k k^2 D \\hat V_k(t)  \\psi_k(x)\n\\]\nand hence\n\\[\n\\sum_k \\frac{d}{d t}  \\hat V_k(t) \\psi_k(x)  =\n  \\sum_k \\gamma J \\hat V_k(t) \\psi_k(x) -  \\sum_k k^2  D \\hat V_k(t) \\psi_k(x).\n\\]\nSince \\(\\{\\psi_k(x) \\}\\) is a orthogonal basis we obtain that\n\\[\n\\frac{d}{d t}  \\hat V_k(t) \\psi_k(x)  =\n   \\gamma J  \\hat V_k(t) \\psi_k(x) -  k^2  D \\hat V_k(t) \\psi_k(x),\n\\] for each \\(k\\). Finally, since \\[\n\\psi_k(x)\\;  /\\hspace{-0.35 cm }\\equiv 0\n\\] in \\(\\Omega\\) this implies for each \\(k\\) a system of ODEs:\n\\[\n\\begin{equation}\n\\frac{d}{d t}  \\hat V_k(t)   =   \\left(\\gamma J  -  k^2  D\\right) \\hat V_k(t) = \\tilde J\\hat V_k(t) ,\n\\end{equation}\n\\tag{6.11}\\]\nwhere \\(\\tilde J\\) is a ``modified’’ Jacobian:\n\\[\n\\tilde{J} =  \\begin{pmatrix}\n\\gamma f_u - k^2 & \\gamma f_v \\\\\n\\gamma g_u & \\gamma g_v - d k^2\n\\end{pmatrix}\\;.\n\\]\nNow solutions of Equation 6.11 are of the form \\[\n\\hat V_k(t) = e^{\\lambda t} P_k\n\\] with \\(P_k \\in \\mathbb R^2\\), where, since \\(P_k\\neq 0\\) (looking for nontrivial solutions), we find that \\(\\lambda\\) are the eigenvalues of \\(\\tilde J\\) , i.e. \nsolutions of the characteristic equation \\[\n\\begin{equation}\n\\det(\\tilde J - \\lambda I) = \\det ( \\gamma J - k^2 D - \\lambda I) =0 \\; .\n\\end{equation}\n\\tag{6.12}\\]\nEvaluating the above determinant, we arrive at the equation: \\[\n\\begin{equation}\n\\lambda^2 + [ k^2 (1 + d) - \\gamma (f_u + g_v) ] \\lambda + h(k^2) = 0,\n\\end{equation}\n\\tag{6.13}\\] where \\[\n\\begin{equation}\nh(k^2) = dk^4 - \\gamma (df_u + g_v) k^2 + \\gamma^2 | J | .\n\\end{equation}\n\\tag{6.14}\\]\n\n\n\nCode\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# genera\nk_sq=np.linspace(0,25,100)\n\n\ngamma=10\nd_1=0.02\nd_2=3\nd_3=6\n\n\nf_u=0.2\ng_v=-0.5\nterm1=d*f_u+g_v\nJ=1.0 # positive determinant\n\n\n\ndef Computeh(k_sq,d):\n  h=d*k_sq**2-gamma*(term1)*k_sq+ gamma**2*J\n  return h\n\ndef SolveReLambda(k_sq,d):\n   # a lam^2 + b * lam +c\n    a=1\n    b= k_sq*(1+d)-gamma*(f_u+g_v)\n    c= Computeh(k_sq,d)\n    lambda_m= (-b-np.sqrt(b**2-4*a*c))/(2*a)\n    lambda_p= (-b+np.sqrt(b**2-4*a*c))//(2*a)\n    return lambda_m,lambda_p\n\ndef TestDDIconditions(d):\n\n    cond_1=f_u+g_v\n    cond_2 = J\n    cond_3 = d*f_u+g_v\n    cond_4 = (d*f_u+g_v)**2-4*d*J\n\n    cond_true=np.zeros((4,1),dtype=bool)\n    cond_true[0]=(cond_1&lt;0) \n    cond_true[1]= (cond_2&gt;0) \n    cond_true[2]= (cond_3&gt;0)\n    cond_true[3]=(cond_4&lt;0)\n\n\n    return cond_true\n\nh_1=Computeh(k_sq,d_1)\nh_2=Computeh(k_sq,d_2)\nh_3=Computeh(k_sq,d_3)\n\nl_1_m, l_1_p = SolveReLambda(k_sq,d_1)\nl_2_m, l_2_p = SolveReLambda(k_sq,d_2)\nl_3_m, l_3_p = SolveReLambda(k_sq,d_3)\n\nconditions_satisfied1=TestDDIconditions(d_1)\nconditions_satisfied2=TestDDIconditions(d_2)\nconditions_satisfied3=TestDDIconditions(d_3)\n\nprint(conditions_satisfied1,conditions_satisfied2,conditions_satisfied3)\n\nfig, ax=plt.subplots()\nax.plot(k_sq,h_1,'r',k_sq,h_2,'k',k_sq,h_3,'m')\nplt.grid()\nax.set_xlabel('$k^2$')\nax.set_ylabel('$h$')\nax.legend(['d='+str(d_1),'d='+str(d_2),'d='+str(d_3)])\nplt.show()\n\nfig, ax=plt.subplots()\nax.plot(k_sq,np.real(l_1_m),'r',k_sq,np.real(l_2_m),'k',k_sq,np.real(l_3_m),'m')\nax.plot(k_sq,np.real(l_1_p),'r--',k_sq,np.real(l_2_p),'k--',k_sq,np.real(l_3_p),'m--')\n\nplt.grid()\nax.set_xlabel('$k^2$')\nax.set_ylabel('$\\Re{\\lambda}$')\nax.set_ylim([-20,5])\n\nax.legend(['d='+str(d_1),'d='+str(d_2),'d='+str(d_3)])\nplt.show()\n\n\n[[ True]\n [ True]\n [False]\n [False]] [[ True]\n [ True]\n [ True]\n [ True]] [[ True]\n [ True]\n [ True]\n [ True]]\n\n\n/var/folders/m_/vc0kz_0x6ls5n4qnksq052jw0000gp/T/ipykernel_29320/2851046048.py:30: RuntimeWarning: invalid value encountered in sqrt\n  lambda_m= (-b-np.sqrt(b**2-4*a*c))/(2*a)\n/var/folders/m_/vc0kz_0x6ls5n4qnksq052jw0000gp/T/ipykernel_29320/2851046048.py:31: RuntimeWarning: invalid value encountered in sqrt\n  lambda_p= (-b+np.sqrt(b**2-4*a*c))//(2*a)\n\n\n\n\n\n(a) A plot of \\(h(k^2)\\) against k^2.\n\n\n\n\n\n\n\n(b)\n\n\n\nFigure 6.3: ?(caption)\n\n\nNOTE: From Equation 6.12, Equation 6.13 we can recover the characteristic equation for the spatially homogeneous perturbation when \\(k=0\\), i.e.  \\[\n\\tilde J \\Big|_{k=0} = ( \\gamma J - k^2 D )\\Big|_{k=0} = \\gamma J.\n\\]\nThus the steady state \\((u_0, v_0)\\) is unstable to spatially heterogeneous perturbations iff \\[\n{\\rm Re}(\\lambda_1) &gt; 0 \\quad \\text{and/or } \\quad {\\rm Re}(\\lambda_2) &gt;0,\n\\] where \\(\\lambda_{1,2}\\) are solutions of Equation 6.12, Equation 6.13.\nNow for \\[\n{\\rm Re}(\\lambda_1) &gt; 0 \\quad \\text{and/or } \\quad {\\rm Re}(\\lambda_2) &gt;0\n\\] to be satisfied we require \\[\n\\text{tr}(\\tilde J) &gt; 0 \\quad \\text{ or } \\quad \\det(\\tilde J) &lt;0 \\; .\n\\]\nConsider first \\({\\rm tr} (\\tilde{J})\\). We have \\[\n\\begin{equation*}\n\\text{tr}(\\tilde J) = \\gamma ( f_u+ g_v) - k^2(1+d) &lt; 0, \\hspace{4 cm}  \n\\end{equation*}\n\\] since \\(\\gamma &gt; 0\\) and \\[\nf_u+ g_v &lt; 0\n\\] by the stability condition for the spatially homogeneous perturbation Equation 6.6.\nThus instability to the spatially heterogeneous perturbation can only occur if \\[\n\\det(\\tilde J) &lt; 0\n\\] and so we require: \\[\\begin{eqnarray*}\n\\det(\\tilde J) = h(k^2) = dk^4  - \\gamma ( d\\,  f_u + g_v) k^2 + \\gamma^2 \\det(J) &lt; 0.\n\\end{eqnarray*}\\]\nFrom the spatially homogeneous stability conditions Equation 6.6 we have \\(\\det(J) &gt;0\\). Thus \\(h(k^2)&lt;0\\) is possible only if \\[\n\\begin{equation}\nd f_u + g_v &gt;0.\n\\end{equation}\n\\tag{6.15}\\] However, once again, due to Equation 6.6, we have \\(f_u+ g_v &lt;0\\), and so we can conclude that \\(d\\neq 1\\) and \\(f_u\\) and \\(g_v\\) must have opposite signs.\nCondition Equation 6.15 is necessary but not sufficient to ensure \\(h(k^2) &lt;0\\). In order to guarantee that \\(h(k^2) &lt; 0\\), the minimum value \\(h_{{\\rm min}}\\) must be negative. Differentiating Equation 6.14 w.r.t. \\(k^2\\), we find that:\n\\[\n\\begin{equation}\nk^2_{m} = \\gamma \\frac{d f_u + g_v}{2d} \\;\\; \\Rightarrow \\;\\; h_{{\\rm min}} = \\gamma^2 \\left[ | J | - \\frac{(df_u + g_v)^2}{4d} \\right] .\n\\end{equation}\n\\tag{6.16}\\]\nThus the condition that \\(h(k^2) &lt; 0\\) for some \\(k^2\\) is:\n\\[\\begin{equation}\n\\frac{(df_u + g_v)^2}{4d} &gt; |J|.\n\\end{equation}\\]\nThe transition from stability to instability i.e. bifurcation, occurs when \\(h_{{\\rm min}} = 0\\). From Equation 6.16, this means at bifurcation we have \\[\n\\begin{equation}\n|J| = \\frac{(df_u + g_v)^2}{4d} .\n\\end{equation}\n\\tag{6.17}\\]\nFor a fixed set of kinetics parameters, this means that we have a critical diffusion coefficient \\(d_c \\;(&gt;1)\\), which, after re-arranging Equation 6.17, is the appropriate root of\n\\[\n\\begin{equation}\nq(d_c) = d^2_c f_u^2 + 2( 2 f_v g_u - f_u g_v) d_c + g_v^2 =0.\n\\end{equation}\n\\tag{6.18}\\]\n\nFinally, we note that using Equation 6.16, Equation 6.17, the critical wave number can be written: \\[\n\\begin{equation}\nk_c^2 =\\gamma  \\frac{( d_c f_u + g_v)} { 2 d_c} = \\gamma \\left[ \\frac {|J|}{d_c} \\right]^{1/2} = \\gamma \\left[ \\frac{f_u g_v - f_v g_u}{d_c} \\right]^{1/2}.\n\\end{equation}\n\\tag{6.19}\\]\nFigure 6.3 (a) shows a schematic diagram of the (quadratic) function \\(h(k^2)\\) for three different values of the diffusion coefficient \\(d\\):\n\n\\(d &lt; d_c, \\; h(k^2) &gt; 0\\), and there is no pattern;\n\\(d = d_c, \\; h_{{\\rm min}} = 0\\), critical case;\n\\(d &gt; d_c, \\; h(k^2) &lt; 0\\), and there is pattern.\n\nHence we can see from Equation 6.13 that whenever \\(h(k^2) &lt; 0\\) the curve \\(\\lambda(k^2)\\) is positive for the same range of wavenumbers that make \\(h(k^2)\\) negative. The range of unstable wavenumbers \\[\nk^2_1 &lt; k^2 &lt; k^2_2\n\\] can be found from the roots of Equation 6.14, \\(h(k^2) = 0\\):\n\\[\n\\begin{eqnarray}\nk^2_1 = \\gamma \\frac{(df_u + g_v) - \\left\\{ (df_u + g_v)^2 -4d |J| \\right\\}^{1/2} }{2d} &lt; k^2 \\nonumber \\\\\n&lt; \\gamma \\frac{(df_u + g_v) +  \\left\\{ (df_u + g_v)^2 -4d |J| \\right\\}^{1/2}}{2d} = k^2_2 \\nonumber\n\\end{eqnarray}\n\\tag{6.20}\\]\nFigure 6.3 (b) shows a schematic diagram of \\({\\rm Re}\\lambda (k^2)\\) for three different values of the diffusion coefficient \\(d\\): * $d &lt; d_c, ; {}(k^2) &lt; 0, k^2 $, and there is no pattern; * \\(d = d_c, \\; k^2_c = 0\\), critical case; * \\(d &gt; d_c, \\; {\\rm Re}\\lambda (k^2) &gt; 0, k^2_1 &lt; k^2 &lt; k^2_2\\), and there is pattern.\nThe expression \\(\\lambda = \\lambda (k^2)\\) is known as the dispersion relation and the plot of \\({\\rm Re} \\lambda\\) against \\(k^2\\) is known as the dispersion curve.\nFrom the previous analysis, within the unstable range of wavenumbers \\((k^2_1 , k^2_2)\\), \\({\\rm Re}\\lambda (k^2) &gt; 0\\) has a maximum value at wavenumber \\(k^2_m\\) given by Equation 6.16 when \\(d &gt; d_c\\). This implies that there is a fastest growing mode in the solution Equation 6.10 of our linearised system Equation 6.8.\n\n\nRecalling Equation 6.10,\n\\[\nV(x,t) = \\sum_k C_k e^{\\lambda(k^2) t} \\, \\psi_k(x),\n\\] and noting the above analysis, this implies that as \\(t\\to \\infty\\) the dominant contributions in the above sum are those for which \\({\\rm Re} \\lambda(k^2) &gt; 0\\), since all other modes will tend to zero exponentially fast as \\(t\\to \\infty\\). Thus, for large \\(t\\), the solution is effectively given by: \\[\nV(x,t) \\approx \\sum_{k_{1}}^{k_2} C_k e^{\\lambda(k^2) t} \\, \\psi_k(x) \\; .\n\\]\n%The critical value of \\(d=d_c\\) at which the bifurcation to instability occurs is defined by \\(h_{\\textrm{min}} =0\\), i.e. such value of \\(d\\) at which \\(h(k^2)=0\\) has a double root.\n\n\n\nNOTE\nAll the previous calculations concern a linear stability analysis carried out about a spatially homogeneous steady state of the system Equation 6.2. This linear theory indicates that for \\(d &gt; d_c\\) there exists a finite number of linearly unstable spatial eigenfunctions which grow exponentially as \\(t \\to \\infty\\). However, this linear theory holds only when we are close to the steady state i.e. it only holds for small perturbations. In the full nonlinear system the exponentially growing (unbounded) modes will eventually be bounded by the nonlinear terms and so bounded, stable spatial patterns characterised by the corresponding wavenumbers will be formed.\nSummary\nWe have obtained conditions for the generation of spatial patterns via systems of reaction-diffusion equations of the general form Equation 6.2. Such systems involve two chemicals or morphogens reacting and diffusing together to generate a chemical pre-pattern that underlies a subsequent cellular pattern. The four conditions are as follows:\n\\[\n\\begin{align}\nf_u + g_v &&lt; 0, \\\\\nf_u g_v - f_v g_u &&gt; 0, \\\\\nd f_u + g_v &&gt; 0, \\\\\n(d f_u + g_v )^2 - 4d (f_u g_v - f_v g_u)^2 &&lt; 0 , \\nonumber\n\\end{align}\n\\tag{6.21}\\] with all partial derivatives being evaluated at the spatially homogeneous steady state \\((u_0 , v_0)\\).\nFrom the first and third conditions, \\(d \\neq 1\\) and \\(f_u\\) and \\(g_v\\) must be of different signs. For each of the reaction kinetics mentioned here (Schnakenberg, Gierer-Meinhardt, Thomas), we have that \\(f_u &gt; 0, g_v &lt; 0\\) and so this implies that \\(d &gt; 1\\).\nIf the conditions Equation 6.21 are satisfied, then there is a range of unstable wavenumbers given by Equation 6.20 which give rise to a spatial pattern. The spatial patterns which initially grow are those spatial eigenfunctions \\(\\psi_k(x)\\) whose wavenumbers \\(k\\) are such that \\(k_1 &lt; k &lt; k_2\\).\nIn most biological systems, the kinetic parameters and diffusion coefficients are fixed. This means that the only variable parameter in the system is \\(\\gamma\\) which as we have seen is related to the size of the domain under consideration. This has implications when considering patterns on finite domains, as will be seen in the next section."
  },
  {
    "objectID": "DiffusionDrivenInstability.html#exercises",
    "href": "DiffusionDrivenInstability.html#exercises",
    "title": "6  Diffusion driven instability",
    "section": "6.5 Exercises",
    "text": "6.5 Exercises\nDemonstrate that the derived results are consistent with numerical solutions. Some predictions to test:\n\nNo patterning when diffusion coefficients are equal\nHow does spatial pattern formation change as you try values of parameters \\(a\\) and \\(b\\)?\nCan you correlate the observation of pattern to the conditions for DDI being satisfied?\nwhat about different kinetics (e.g. Gierer-Meinhardt, Thomas models)?"
  },
  {
    "objectID": "DiffusionDrivenInstability.html#references",
    "href": "DiffusionDrivenInstability.html#references",
    "title": "6  Diffusion driven instability",
    "section": "6.6 References",
    "text": "6.6 References\n\n\n\n\n“A Theory of Biological Pattern Formation.” 1972. Kybernetik 12: 30–39.\n\n\nMurray, James D, and George F Oster. 1984. “Generation of Biological Pattern and Form.” Mathematical Medicine and Biology: A Journal of the IMA 1 (1): 51–75.\n\n\nMurray, JD610574. 1981. “A Pre-Pattern Formation Mechanism for Animal Coat Markings.” Journal of Theoretical Biology 88 (1): 161–99.\n\n\nTuring, Alan Mathison. 1990. “The Chemical Basis of Morphogenesis.” Bulletin of Mathematical Biology 52: 153–97."
  },
  {
    "objectID": "SIR_PDE.html",
    "href": "SIR_PDE.html",
    "title": "7  SIR models",
    "section": "",
    "text": "{\\(\\phantom{aaaaa}\\)}\nMathematical modelling of infection diseases can help to understand complex (nonlinear) interactions, to design vaccination strategies, predict further outbreaks of diseases, how many individual will be affected.\nAssumptions\nConsider consider three classes of population density\nProgress through the disease \\[\nS \\longrightarrow I \\longrightarrow R \\]\nModel assumptions\nThen a simple SIR model reads ( in a long thin domain or in \\(3\\)-dim domain with solutions in a form of planar fronts) \\[\\begin{equation}\\label{SIR1}\n\\begin{aligned}\n&\\frac{\\partial S}{\\partial t} = - r SI + D_S \\frac{ \\partial^2 S}{\\partial x^2}\\; ,  &\\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n&\\frac{\\partial I}{\\partial t} = r SI - a I+ D_I \\frac{ \\partial^2 I}{\\partial x^2} \\; ,  &\\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n&\\frac{\\partial R}{\\partial t} = a I + D_R \\frac{ \\partial^2 R}{\\partial x^2} \\; , & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; \\\\\n&S(0,x) = S_0(x), \\qquad I(0,x) = I_0(x), \\quad R(0,x) = R_0(x),& \\qquad x \\in \\mathbb R \\; ,\n\\end{aligned}\n\\end{equation}\\] where\nWe assume that \\(S_0(x) \\geq 0\\), \\(I_0(x) \\geq 0\\), \\(R_0(x) \\geq 0\\) for \\(x \\in \\mathbb R\\) and obtain that solutions of \\(\\eqref{SIR1}\\) are nonnegative, i.e.  \\[\nS(t,x) \\geq 0, \\quad I(t,x) \\geq 0, \\quad R(t,x) \\geq 0, \\quad  x\\in \\mathbb R, \\quad t &gt;0 \\; .\n\\]\nTo analyse the model \\(\\eqref{SIR1}\\) it is sufficient to consider the first two equations, since \\(R\\) is completely determined by \\(I\\) and does not influence the dynamics of \\(S\\) and \\(I\\).\nConsidering the non-dimensionalisation \\[\nI^\\ast = \\frac I{\\bar S_0} , \\quad S^\\ast = \\frac S{\\bar S_0} ,  \\quad x^\\ast = \\left(\\frac{ r \\bar S_0}{D_I} \\right)^{1/2} x, \\quad t^\\ast = r \\bar S_0 t\n\\] we obtain ( after dropping \\(`\\ast'\\)) \\[\\begin{equation}\\label{SIR2}\n\\begin{aligned}\n& \\frac{\\partial S}{\\partial t} = -  SI + d \\frac{ \\partial^2 S}{\\partial x^2}\\; , & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& \\frac{\\partial I}{\\partial t} = SI - \\mu I+  \\frac{ \\partial^2 I}{\\partial x^2} \\; ,  & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& S(0,x) = \\frac{S_0(x)}{\\bar S_0}, \\qquad I(0,x) = \\frac{I_0(x)}{\\bar S_0},  & \\quad x \\in \\mathbb R \\; ,\n\\end{aligned}\n\\end{equation}\\] where \\(\\bar S_0\\) is a representative population density and \\(\\mu = \\dfrac a { r \\bar S_0}\\).\nWe would like to investigate the spatial spread of an epidemic wave of invectives into a uniform susceptibles population \\(S_0(x) =\\bar S_0\\). We would like to determine conditions for existence of an epidemic wave and propagation speed.\nWe shall assume first that \\(D_S= D_I\\), i.e. \\(d=1\\). Consider travelling wave solutions \\[\nS(t,x) = s(z), \\quad I(t,x) = i(z), \\quad z = x - v t, \\quad v &gt;0\n\\] and obtain following ODEs for \\(s\\) and \\(i\\) \\[\\begin{equation}\\label{SIR_TW}\n\\begin{aligned}\ns^{\\prime \\prime} + v s^\\prime - i s = 0 \\; , \\\\\ni^{\\prime \\prime} + v i^\\prime + i s - \\mu i= 0\\; .\n\\end{aligned}\n\\end{equation}\\] We would like to analyse the existence of a travelling wave from for \\(S\\) and travelling wave pulse for \\(I\\). We assume that the infection comes into susceptible population from the left.\nTherefore we consider the following boundary conditions for the travelling wave solutions \\[\\begin{equation}\\label{SIR_TW_BC}\n\\begin{aligned}\ns(z) \\to 1 \\qquad  z\\to + \\infty, \\quad \\qquad  i(z) \\to 0 \\qquad  z\\to + \\infty\\; ,\\\\\ns(z) \\to \\sigma \\qquad  z\\to - \\infty, \\quad \\qquad  i(z) \\to 0 \\qquad  z\\to - \\infty\\; ,\\\\\ns^\\prime(z) \\to 0\\qquad  z\\to \\pm \\infty, \\quad \\qquad i^\\prime(z) \\to 0 \\qquad z \\to \\pm \\infty \\; ,\n\\end{aligned}\n\\end{equation}\\] where \\(0 \\leq \\sigma &lt;1\\).\nThe steady states of \\(\\eqref{SIR_TW}\\) are given by \\[\nis =0 , \\quad i ( s- \\mu) = 0  \\quad \\Longrightarrow \\quad \\ i=0, \\quad s = \\text{const} \\; .\n\\] Considering boundary conditions \\(\\eqref{SIR_TW_BC}\\) we obtain two steady states \\[\n(s_0, i_0) = ( 1, 0), \\qquad (s_0, i_0) = (\\sigma, 0)\n\\] Hence we would like to have a heteroclinic connection between \\((\\sigma , 0)\\) and \\((1,0)\\).\nThe necessary condition for existence of travelling wave solutions satisfying \\(\\eqref{SIR_TW}\\) and \\(\\eqref{SIR_TW_BC}\\) is \\[\\begin{equation}\\label{cond_v_SIR}\nv \\geq 2 \\sqrt{ 1- \\mu} \\, \\quad \\text{ and } \\quad 0 \\leq \\mu &lt; 1\\; .  \n\\end{equation}\\] In terms of original parameters we have \\[\n\\mu = \\frac a { r S_0} &lt; 1.\n\\] This is the necessary threshold conditions for the propagation of an epidemic wave pulse. The condition \\(\\eqref{cond_v_SIR}\\) determine also the non-dimensionalised minimal wave speed \\[\nv^\\ast_{\\text{min}} = 2\\sqrt{ 1- \\mu}\n\\]\nIn dimensional terms we obtain \\[\nz^\\ast = x^\\ast - v^\\ast t^\\ast = \\left( \\frac { r S_0} {D_I} \\right)^{1/} x - v^\\ast r S_0 t  =\n\\left( \\frac { r S_0} {D_I} \\right)^{1/} ( x - v t) = \\left( \\frac { r S_0} {D_I} \\right)^{1/} z\n\\] and \\[\nv = \\sqrt{ r S_0 D_I} v^\\ast \\quad v_{\\text{min}} = 2  \\sqrt{ r S_0 D_I}\\sqrt{ 1- \\mu} =\n2  \\sqrt{ r S_0 D_I}\\sqrt{ 1- \\frac a{ r S_0} }\n\\]\nWe can analyse the behaviour of travelling wave solutions as \\(z \\to + \\infty\\).\nLinearised equation for the second equation in \\(\\eqref{SIR_TW}\\) near \\(s=1\\), \\(i=0\\), i.e. as \\(z \\to + \\infty\\) reads \\[\ni^{\\prime \\prime} + v i^\\prime + i  - \\mu i = 0\\; .\n\\] Thus \\[\\begin{equation}\\label{i_TW_infty}\ni(z) \\sim \\exp \\left(\\frac 1 2 \\left[ - v \\pm \\sqrt{ v^2 - 4(1-\\mu)} \\right] z \\right) \\quad \\text{ as } z \\to + \\infty \\; .\n\\end{equation}\\]\nWe can also show that the travelling wave solution \\(s(z)\\) can not have a local maximum, since for \\(s^\\prime(z) = 0\\) first equation in \\(\\eqref{SIR_TW}\\) implies \\[\ns^{\\prime \\prime}(z) = is &gt;0,\n\\] which implies a local minimum. So \\(s(z)\\) is monotone increasing.\nConsidering linearisation of the first equation in \\(\\eqref{SIR_TW}\\) near \\(s=1\\), \\(i=0\\), i.e. as \\(z \\to + \\infty\\), we obtain with \\(s(z) = 1 - \\tilde s(z)\\) \\[\n\\tilde s^{\\prime \\prime} + v \\tilde s^{\\prime} - i = 0 \\; .\n\\] The using \\(\\eqref{i_TW_infty}\\) we can conclude that \\[\\begin{equation*}\\label{tilde s_TW_infty}\n\\tilde s(z) \\sim \\exp \\left(\\frac 1 2 \\left[ - v \\pm \\sqrt{ v^2 - 4(1-\\mu)} \\right] z \\right) \\quad \\text{ as } z \\to + \\infty \\; .\n\\end{equation*}\\] and \\[\\begin{equation*}\\label{s_TW_infty}\ns(z) \\sim 1 - C \\exp \\left(\\frac 1 2 \\left[ - v \\pm \\sqrt{ v^2 - 4(1-\\mu)} \\right] z \\right) \\quad \\text{ as } z \\to + \\infty \\; .\n\\end{equation*}\\]\nSpread of rabies is due primary to the migration of infected foxes. We assume the heathy foxes are territorial and do not travel very far, whereas rabid foxes wander over large distances.\nThus we assume that \\(D_S \\ll D_I\\) and \\(d= \\dfrac{ D_S}{D_I} \\approx 0\\).\n\\[\\begin{equation}\\label{SIR3}\n\\begin{aligned}\n& \\frac{\\partial S}{\\partial t} = -  SI \\; , & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& \\frac{\\partial I}{\\partial t} = SI - \\mu I+  \\frac{ \\partial^2 I}{\\partial x^2} \\; ,  & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& S(0,x) = 1, \\qquad I(0,x) = \\frac{I_0}{\\bar S_0},  & \\quad x \\in \\mathbb R \\; ,\n\\end{aligned}\n\\end{equation}\\]\nWe shall look for travelling wave solutions of \\(\\eqref{SIR3}\\): travelling wave front for \\(S\\) and travelling wave pulse for \\(I\\). Considering \\[\nS(t,x) = s(z), \\quad I(t,x) = i(z), \\quad z = x - v t, \\quad v &gt;0\n\\] and obtain following ODEs for \\(s\\) and \\(i\\) \\[\\begin{equation}\\label{SIR_TW_2}\n\\begin{aligned}\n&  v s^\\prime = i s  \\; , \\\\\n& i^{\\prime \\prime} + v i^\\prime + i s - \\mu i= 0\\;\n\\end{aligned}\n\\end{equation}\\] and corresponding boundary conditions \\[\\begin{equation}\\label{SIR_TW_BC_2}\n\\begin{aligned}\ns(z) \\to 1 \\qquad  z\\to + \\infty, \\quad \\qquad  i(z) \\to 0 \\qquad  z\\to + \\infty\\; ,\\\\\ns(z) \\to \\sigma \\qquad  z\\to - \\infty, \\quad \\qquad  i(z) \\to 0 \\qquad  z\\to - \\infty\\; ,\\\\\ns^\\prime(z) \\to 0\\qquad  z\\to \\pm \\infty, \\quad \\qquad i^\\prime(z) \\to 0 \\qquad z \\to \\pm \\infty \\; ,\n\\end{aligned}\n\\end{equation}\\] where \\(0 \\leq \\sigma &lt;1\\).\nAs before, the steady states of \\(\\eqref{SIR_TW_2}\\) are given by \\[\nis =0 , \\quad i ( s- \\mu) = 0  \\quad \\Longrightarrow \\quad  i=0, \\quad s = \\text{const} \\; .\n\\] Considering boundary conditions \\(\\eqref{SIR_TW_BC_2}\\) we obtain two steady states \\[\n(s_0, i_0) = ( 1, 0), \\qquad (s_0, i_0) = (\\sigma, 0) \\; .\n\\]\nLinearising equations \\(\\eqref{SIR_TW_2}\\) about the steady state \\((1,0)\\) and requiring that \\(i\\) is nonnegative we obtain, as for \\(\\eqref{SIR_TW}\\), the necessary conditions for existence of travelling wave solutions satisfying \\(\\eqref{SIR_TW_2}\\) and \\(\\eqref{SIR_TW_BC_2}\\) : \\[\nv \\geq 2 \\sqrt{ 1- \\mu} \\, \\quad \\text{ and } \\quad 0 \\leq \\mu &lt; 1\\; .  \n\\]\nWe can determine the relation between density of susceptibles left behind the infection pulse and the model parameters.\nUsing first equation in \\(\\eqref{SIR_TW_2}\\) in the second implies \\[\\begin{equation}\\label{sigma_1}\ni^{\\prime \\prime} + v i^\\prime + v s^\\prime  - \\mu i= 0\\; .\n\\end{equation}\\] Integrating with respect to \\(z\\) yields \\[\\begin{equation}\\label{sigma_2}\ni^{\\prime } + v i + v s  - \\mu \\int i\\, dz = K= const\\; .\n\\end{equation}\\] Consider now ageing the first equation in \\(\\eqref{SIR_TW_2}\\) \\[\ni= v \\frac {s^\\prime} s, \\quad \\quad s \\neq 0 \\;\n\\] and obtain from \\(\\eqref{sigma_2}\\) \\[\\begin{equation*}\ni^{\\prime } + v i + v s  - v  \\mu \\int   \\frac {s^\\prime} s\\, dz = K= const\\; .\n\\end{equation*}\\] or \\[\\begin{equation}\\label{sigma_3}\ni^{\\prime } + v i + v s  - v  \\mu \\ln(s) = K\\; .\n\\end{equation}\\] Using now in \\(\\eqref{sigma_3}\\) boundary conditions as \\(z \\to + \\infty\\), from \\(\\eqref{SIR_TW_BC_2}\\), we can determine constant \\(K\\): \\[\\begin{equation*}\nv    = K\\; .\n\\end{equation*}\\] Thus we have \\[\\begin{equation}\\label{sigma_4}\ni^{\\prime } + v i + v( s  - \\mu \\ln(s) -1)= 0\\; .\n\\end{equation}\\] Using now in \\(\\eqref{sigma_4}\\) boundary conditions as \\(z \\to - \\infty\\), see \\(\\eqref{SIR_TW_BC_2}\\), gives \\[\\begin{equation*}\nv( \\sigma - \\mu \\ln(\\sigma) -1)= 0\\; .\n\\end{equation*}\\] and \\[\\begin{equation}\\label{sigma_5}\n\\frac{ \\sigma- 1}{\\ln(\\sigma)} = \\mu \\; .\n\\end{equation}\\] We obtain that the number of susceptibles is defined independently of the wave speed and the smaller \\(\\mu\\) corresponds to smaller \\(\\sigma\\) ( i.e. fever susceptibles survive infection wave). Thus \\(\\mu\\) measures how sever the epidemic is.\nConsidering the critical value for \\(\\mu =1\\), which in dimensional terms means \\[\n\\frac a { r S_0} = 1,\n\\] we can conclude that there exists no wave of infection\nWe developed a simple model for the passage of a wave of infection, however data of a spread of rabies in continental Europe looks quite different, i.e. comprises oscillations behind the wave front. It is likely that birth-death processes, not included in the simple model, impact dynamics of susceptibles and invectives.\nWe generalised the simple model by considering growth of susceptibles population in a logistic manner \\[\\begin{equation}\\label{SIR_growth}\n\\begin{aligned}\n& \\frac{\\partial S}{\\partial t} = -  rSI + B S\\left( 1 - \\frac S{S_0} \\right) \\; , & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& \\frac{\\partial I}{\\partial t} =  r SI - a I+  D_I \\frac{ \\partial^2 I}{\\partial x^2} \\; ,  & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& S(0,x) = S_0, \\qquad I(0,x) = I_0,  & \\quad x \\in \\mathbb R \\; ,\n\\end{aligned}\n\\end{equation}\\] where \\(B\\) is the intrinsic growth rate and \\(S_0\\) is the carrying capacity.\nWe can non-dimensionalize \\(\\eqref{SIR_growth}\\) as before and obtain \\[\\begin{equation}\\label{SIR_growth_nd}\n\\begin{aligned}\n& \\frac{\\partial S}{\\partial t} = -  SI + b S\\left( 1 -  S \\right) \\; , & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& \\frac{\\partial I}{\\partial t} =   SI - \\mu \\,  I+   \\frac{ \\partial^2 I}{\\partial x^2} \\; ,  & \\qquad x \\in \\mathbb R , \\; t&gt;0 \\; , \\\\\n& S(0,x) = 1, \\qquad I(0,x) = I_0/S_0,  & \\quad x \\in \\mathbb R \\; ,\n\\end{aligned}\n\\end{equation}\\] where \\(b= \\dfrac{B}{r S_0}\\).\nSpatially homogeneous steady states of \\(\\eqref{SIR_growth_nd}\\) are \\((S^\\ast_1, I^\\ast_1) = (1,0)\\) and \\((S^\\ast_1, I^\\ast_1) = (\\mu, b(1-\\mu))\\).\nTo analyse the existence of travelling wave solutions we write equations for \\(s(z)\\) and \\(i(z)\\), where \\(s(z)=S(t,x)\\), \\(i(z) = I(t,x)\\) with \\(z= x- vt\\) \\[\\begin{equation}\\label{SIR_TW_growth}\n\\begin{aligned}\n&  -v s^\\prime =- i s  + b s ( 1-s) \\; , \\\\\n& - v i^\\prime =  i s - \\mu i +  i^{\\prime \\prime}  \\;\n\\end{aligned}\n\\end{equation}\\] and by introducing new variable \\(w= i^\\prime\\) obtain \\[\\begin{equation}\\label{SIR_TW_growth_2}\n\\begin{aligned}\n&   s^\\prime = \\frac 1 v i\\,  s  - \\frac  b v \\,  s ( 1-s) \\; , \\\\\n& i^\\prime = w, \\\\\n& w^{\\prime}= -  v w - i (s - \\mu)\\; .\n\\end{aligned}\n\\end{equation}\\] The system \\(\\eqref{SIR_TW_growth_2}\\) has two stationary solutions \\((s^\\ast_1, i^\\ast_1, w^\\ast_1) = (1,0,0)\\) and \\((s^\\ast_2, i^\\ast_2, w^\\ast_2) = (\\mu, b(1-\\mu),0)\\). Considering linearisation of \\(\\eqref{SIR_TW_growth_2}\\) and computing eigenvalues of Jabocian matrix \\[\nJ(s,i,w)= \\begin{pmatrix}\n\\dfrac i v - \\dfrac b v + \\dfrac{ 2b s} v & \\dfrac sv & 0 \\\\\n0 & 0 & 1\\\\\n- i & \\mu - s & -v\n\\end{pmatrix}\n\\] evaluated at the steady states we obtain that \\((s^\\ast_1, i^\\ast_1, w^\\ast_1) = (1,0,0)\\) is a saddle point and \\((s^\\ast_2, i^\\ast_2, w^\\ast_2) = (\\mu, b(1-\\mu),0)\\) is a stable node for \\(\\mu &lt; \\mu^\\ast\\) and a stable spiral (focus) for \\(\\mu &gt;\\mu^\\ast\\), with some threshold value \\(\\mu^\\ast\\).\nThus we can show that a travelling wave solution exists which connects two steady states \\((1,0)\\) and \\((\\mu, b(1-\\mu))\\) and there exists a threshold \\(\\mu = \\mu^\\ast\\) such that for $1&gt;&gt; ^$ the approach to \\((\\mu, b(1-\\mu))\\) is oscillatory, whereas for \\(0&lt;\\mu &lt; \\mu^\\ast\\) it is monotonic. \\\n\\end{document}\nWe shall consider a minimal model for the aggregation phase.\nStarved slime hold amoebae sect a chemical cyclin AMP (cAMP) that attract other cells. Cells also secrete phosphodiesterase, an enzyme that degrades cAMP. \\\n\n\\[\\begin{equation}\n\\begin{aligned}\n& \\frac{\\partial a}{\\partial t} = - \\nabla \\cdot ( J_{\\text{diffusion}} + J_{\\text{chemotaxis}}) , \\\\\n& \\frac{\\partial a}{\\partial t} = - \\nabla \\cdot ( J_{\\text{diffusion}} ) + \\text{reaction (source, sink) term} \\; .\n\\end{aligned}\n\\end{equation}\\]\nThus we obtain chemotaxis system in a domain \\(\\Omega \\subset \\mathbb R^n\\) with sufficiently smooth boundary \\[\\begin{equation}\n\\begin{aligned}\n&\\frac{\\partial a}{\\partial t} = - \\nabla \\cdot ( -D_a \\nabla a +  \\chi \\, a \\, \\nabla c) \\qquad x \\in  \\Omega, \\; \\; t&gt;0\\;   , \\\\\n&\\frac{\\partial a}{\\partial t} = - \\nabla \\cdot ( - D_c \\nabla c ) +  \\beta \\, a - d\\,  c\\;  \\qquad x\\in  \\Omega , \\; \\; t &gt;0\\;, \\\\\n&a(0,x) = a_0(x), \\qquad c(0,x) =  c_0(x) \\qquad \\text{ in } \\Omega , \\\\\n& \\nabla a \\cdot \\textbf{n}  = 0 , \\quad  \\nabla c \\cdot \\textbf{n}  = 0 \\qquad x \\in \\partial \\Omega, \\; \\; t &gt;0,\n\\end{aligned}\n\\end{equation}\\] where \\(D_a&gt;0\\), \\(D_c&gt;0\\) diffusion coefficients, \\(\\beta&gt;0\\) - rate of cAMP secretion by cells per unit density, \\(d&gt;0\\) - rate of degradation of cAMP, \\(\\textbf{n}\\) - outer normal vector to \\(\\partial \\Omega\\). %\\frame{ %\n%{ } A closed subset \\(M\\subset \\mathbb R^n\\) is called a { positively invariant region} for solutions of (a system of ODE) %\\begin{align} %\\begin{aligned} % &= F(t,u(t)), uR^n, \\ %u(0)&= u_0 %\\end{aligned} %\\end{align} %if any solution \\(u(t)\\), having initial values \\(u_0\\) in \\(M\\), satisfies \\(u(t) \\in M\\) for all \\(t\\geq 0\\) . %%( if \\(u_0\\in M\\) implies that \\(u(t, u_0) \\in M\\) for all \\(t\\geq 0\\) ). % %{ } %Let \\(\\Phi \\in C^1(U, \\mathbb R)\\) such that \\(\\nabla \\Phi(u) \\neq 0\\) for all \\(u\\in \\Phi^{-1}(0)\\), that is assume that \\(0\\) is a regular value of \\(\\Phi\\). \\ %Then the region $M:={u U: (u) } $ is positively invariant for solutions of \\(\\eqref{ode_nonlin_2}\\) if and only if\n%\\[\n%(\\nabla \\Phi(u), F(u)) \\leq 0 \\quad \\quad \\forall u \\in \\partial M = \\Phi^{-1}(0).\n%\\] % %Let \\(\\Phi_i \\in C^1(U, \\mathbb R)\\) and \\(0\\) is a regular value of \\(\\Phi_i\\), with \\(i=1, \\dots k\\). Consider \\(M:=\\cap_{i=1}^k\\{u \\in U: \\Phi_i(u) \\leq 0 \\}\\). %If we have %\\[\n%(\\nabla \\Phi_i(u), F(u)) \\leq 0 \\qquad \\forall u \\in \\partial M = \\Phi_i^{-1}(0), \\quad i=1,\\ldots, k,\n%\\] %then \\(M\\) is positively invariant for solutions of \\(\\eqref{ode_nonlin_2}\\) with \\(u_0 \\in M\\). %}"
  },
  {
    "objectID": "NumericalMethods.html#python-libraries",
    "href": "NumericalMethods.html#python-libraries",
    "title": "8  Numerical methods in Python",
    "section": "8.1 Python libraries",
    "text": "8.1 Python libraries\n\nmatplotlib\nnumpp\nscipy"
  },
  {
    "objectID": "NumericalMethods.html#single-pdes",
    "href": "NumericalMethods.html#single-pdes",
    "title": "8  Numerical methods in Python",
    "section": "8.2 Single PDEs",
    "text": "8.2 Single PDEs\n\n8.2.1 MOL\n\n\n8.2.2 Spatial discretisation\n\n\n8.2.3 odeint\n\n\n8.2.4 implementing boundary conditions\n\n\n8.2.5 Identifying parameters"
  },
  {
    "objectID": "NumericalMethods.html#systems-of-pdes",
    "href": "NumericalMethods.html#systems-of-pdes",
    "title": "8  Numerical methods in Python",
    "section": "8.3 Systems of PDEs",
    "text": "8.3 Systems of PDEs"
  },
  {
    "objectID": "linearstablityanalysis.html",
    "href": "linearstablityanalysis.html",
    "title": "9  Linear stability analysis of a system of nonlinear ODES",
    "section": "",
    "text": "Consider a system of ODEs\n\\[\\begin{equation*}\n\\frac{du}{dt} = f(u) \\quad \\text{ with } \\quad u \\in \\mathbb R^m\\quad  \\text{ and }\\quad  t \\in \\mathbb R.\n\\end{equation*}\\]\nAs an example consider \\(m=2\\): \\[\n\\begin{eqnarray}\n\\begin{cases}\n\\dfrac{du_1}{dt} =F(u_1, u_2) ,\\\\\n\\dfrac{du_2}{dt} =G(u_1, u_2)\n\\end{cases}\n\\end{eqnarray}\n\\tag{9.1}\\]\n\\((u_1, u_2) = (u^\\ast_1, u^\\ast_2)\\) is the steady state of the system Equation 9.1, i.e. \\[\n\\dfrac{du_1}{dt} = 0\n\\] and \\[\n\\dfrac{du_2}{dt} = 0\n\\].\nTo determine the behaviour of the solution near a steady state we consider \\[\nu_1(t) = u^\\ast_1 + \\bar u_1(t), \\quad  u_2(t) = u^\\ast_2 + \\bar u_2(t)\n\\] \\[\n\\begin{eqnarray}\n\\begin{cases}\n\\dfrac{d(u^\\ast_1+ \\bar u_1)}{dt} =F(u^\\ast_1+ u_1, u^\\ast_2+ \\bar u_2) ,\\\\\n\\dfrac{d(u^\\ast_2+\\bar u_2)}{dt} =G(u^\\ast_1+u_1,u^\\ast_2+\\bar u_2)\n\\end{cases}\n\\end{eqnarray}\n\\tag{9.2}\\]\nThen using the fact that \\((u^\\ast_1, u^\\ast_2)\\) is a steady state and applying Taylor series expansion about \\(( u^\\ast_1, u^\\ast_2)\\) and assuming that\n\\[\n\\sup_{t}|\\bar u_1(t)| \\ll 1, \\sup_{t}|\\bar u_2(t)|\\ll 1\n\\] (small perturbations of the steady state) we have \\[\n\\begin{eqnarray}\n\\begin{cases}\n\\dfrac{d  \\bar u_1}{dt} =F(u^\\ast_1, u^\\ast_2) +\\dfrac{\\partial F}{\\partial u_1}(u^\\ast_1, u^\\ast_2) \\,   \\bar u_1\n+\\dfrac{\\partial F}{\\partial u_2}(u^\\ast_1, u^\\ast_2) \\, \\bar u_2 + O(|\\bar u_1|^2, |\\bar u_2|^2) ,\\\\\n\\dfrac{d \\bar u_2}{dt} =G(u^\\ast_1,u^\\ast_2)+ \\dfrac{\\partial G}{\\partial u_1}(u^\\ast_1, u^\\ast_2) \\,   \\bar u_1\n+\\dfrac{\\partial G}{\\partial u_2}(u^\\ast_1, u^\\ast_2) \\,\\bar u_2 + O(|\\bar u_1|^2, |\\bar u_2|^2)\n\\end{cases}\n\\end{eqnarray}\n\\tag{9.3}\\]\nThus since \\((u^\\ast_1, u^\\ast_2)\\) is a steady state, i.e. \\(F(u^\\ast_1, u^\\ast_2) =0\\) and \\(G(u^\\ast_1, u^\\ast_2) =0\\) (ignoring negligibly small higher order terms) we obtain system of linearised equations \\[\n\\begin{eqnarray}\n\\begin{pmatrix}\n\\dfrac{d  \\bar u_1}{dt} \\\\\n\\dfrac{d \\bar u_2}{dt}\n\\end{pmatrix} = J( u^\\ast_1, u^\\ast_2) \\begin{pmatrix} \\bar u_1 \\\\\n\\bar u_2\n\\end{pmatrix}\n\\end{eqnarray}\n\\tag{9.4}\\] where the Jacobian matrix \\(J(u^\\ast_1, u^\\ast_2)\\) is defined as \\[\nJ( u^\\ast_1, u^\\ast_2) = \\begin{pmatrix}\n\\dfrac{\\partial F(u^\\ast_1, u^\\ast_2) }{\\partial u_1}\\; \\; & \\dfrac{\\partial F(u^\\ast_1, u^\\ast_2)}{\\partial u_2}\\\\\n\\dfrac{\\partial G(u^\\ast_1, u^\\ast_2)}{\\partial u_1} & \\dfrac{\\partial G(u^\\ast_1, u^\\ast_2)}{\\partial u_2}\n\\end{pmatrix}\n\\] Therefore the behaviour of the nonlinear system Equation 9.1 near the steady state \\((u^\\ast_1, u^\\ast_2)\\) is determined by solutions of system of linear ODEs Equation 9.4.\nSince Equation 9.4 is linear we can write the general solution of (eqsystem_ode14?) \\[\\begin{equation}\n\\begin{pmatrix} \\bar u_1 \\\\\n\\bar u_2\n\\end{pmatrix} = e^{\\lambda_1 t} \\begin{pmatrix} \\phi_1 \\\\\n\\phi_2\n\\end{pmatrix}   +\ne^{\\lambda_2 t} \\begin{pmatrix} \\psi_1 \\\\\n\\psi_2\n\\end{pmatrix}\n\\end{equation}\\] where \\(\\lambda_1\\) and \\(\\lambda_2\\) are eigenvalues of Jacobian matrix \\(J( u^\\ast_1, u^\\ast_2)\\) and \\[\n\\phi=\\begin{pmatrix} \\phi_1 \\\\\n\\phi_2\n\\end{pmatrix} \\quad \\textrm{and} \\quad  \\psi= \\begin{pmatrix} \\psi_1 \\\\\n\\psi_2\n\\end{pmatrix}\n\\] are corresponding eigenvectors.\nDenote \\[\\bar u=\n\\begin{pmatrix} \\bar u_1 \\\\\n\\bar u_2\n\\end{pmatrix}\n\\].\nIf both \\(\\lambda_{1,2} \\neq 0\\) then the stability of the steady state \\((u^\\ast_1, u^\\ast_2)\\) is determined by the real part of the eigenvalues \\(\\lambda_{1,2}\\).\n\nIf either \\(\\mathcal Re (\\lambda_1)&gt;0\\) or \\(\\mathcal Re (\\lambda_2)&gt;0\\) then\n\\(|\\bar u(t)| \\to +\\infty\\) as \\(t \\to + \\infty\\) and \\((u^\\ast_1, u^\\ast_2)\\) is unstable.\nIf \\(\\mathcal Re (\\lambda_1)&lt;0\\) and \\(\\mathcal Re (\\lambda_2)&lt;0\\) then\n\\(|\\bar u(t)| \\to 0\\) as \\(t \\to + \\infty\\) and \\((u^\\ast_1, u^\\ast_2)\\) is stable.\nIf \\(\\lambda_1=0\\) or \\(\\lambda_2=0\\) we have to consider higher order terms.\n\nDenote \\(\\beta = \\textrm{tr} (J( u^\\ast_1, u^\\ast_2))\\) and \\(\\gamma= \\det(J( u^\\ast_1, u^\\ast_2))\\). Then the characteristic (eigenvalue) equation for \\(J( u^\\ast_1, u^\\ast_2)\\) is \\[\n\\lambda^2 - \\beta \\lambda + \\gamma = 0 \\; , \\quad  \\lambda_{1,2} = \\frac{ \\beta \\pm \\sqrt{ \\beta^2 - 4 \\gamma}} 2.\n\\] Then\n\nIf \\(\\gamma &lt;0\\) we have two real eigenvalues with different signs, i.e. \\(\\lambda_1 &lt; 0 &lt; \\lambda_2\\). Thus \\((u^\\ast_1, u^\\ast_2)\\) is a saddle.\nIf \\(\\gamma &gt;0\\) and \\(\\beta^2 \\geq 4\\gamma\\) we have two real eigenvalues with the same sign. Thus \\((u^\\ast_1, u^\\ast_2)\\) is a node.\n\nif \\(\\beta &gt;0\\) then \\(\\lambda_2 &gt; \\lambda_1 &gt;0\\) and \\((u^\\ast_1, u^\\ast_2)\\) is an unstable node.\nif \\(\\beta &lt;0\\) then \\(\\lambda_1 &lt; \\lambda_2 &lt; 0\\) and \\((u^\\ast_1, u^\\ast_2)\\) is a stable node.\n\nIf \\(\\gamma &gt;0\\) and \\(\\beta^2 &lt; 4\\gamma\\) we have two complex conjugate eigenvalues. Thus \\((u^\\ast_1, u^\\ast_2)\\) is a focus (spiral).\n\nif \\(\\beta &gt;0\\) then \\(\\mathcal Re(\\lambda_{1,2}) &gt; 0\\) and \\((u^\\ast_1, u^\\ast_2)\\) is an unstable focus\nif \\(\\beta &lt;0\\) then \\(\\mathcal Re(\\lambda_{1,2}) &lt; 0\\) and \\((u^\\ast_1, u^\\ast_2)\\) is a stable focus.\nIf \\(\\beta =0\\) then for linear system we have a centre, but in general we have no information on the behaviour of the nonlinear system near the steady state \\((u^\\ast_1, u^\\ast_2)\\)."
  },
  {
    "objectID": "BacterialChemotaxis.html#model-derivation",
    "href": "BacterialChemotaxis.html#model-derivation",
    "title": "5  Aggregation via Chemotaxis",
    "section": "5.1 Model derivation",
    "text": "5.1 Model derivation\nWe consider a model for the aggregation of Dictyostelium discoideum through the secretion of and chemotactic response to cAMP. We denote by \\(n({\\bf x}, t)\\) the density of amoebae and \\(a({\\bf x}, t)\\) the concentration of cAMP. The general conservation equation for the amoebae can be written:\n\\[\n\\frac{\\partial n}{\\partial  t} + \\nabla \\cdot {\\bf J} = f(n,a),\n\\]\nwhere \\(f(n,a)\\) models any reaction terms for the amoebae e.g. proliferation, and the flux is given by\n\\[\n{\\bf J} = {\\bf J}_{diffusion} + {\\bf J}_{chemotaxis}\n\\]\nAssuming Fickian diffusion and the general chemotactic flux stated earlier, the general * reaction-diffusion-chemotaxis*model for the amoebae responding to cAMP is given by:\n\\[\\begin{eqnarray*}\n\\frac{\\partial n}{\\partial  t} & = & \\underbrace{D_n \\nabla^2 n}_{diffusion} - \\underbrace{\\nabla \\cdot \\left( \\chi(a) n \\nabla a \\right)}_{chemotaxis} + f(n,a)   \\\\\n\\frac{\\partial a}{\\partial  t} & = &  D_a \\nabla^2 a + g(n,a),\n\\end{eqnarray*}\\]\nwhere we have assumed Fickian diffusion for the cAMP and \\(g(a,n)\\) represents the kinetics i.e. source/sink terms, of cAMP.\nOne simple model has the following assumptiond:\n\\[f(n,a) = 0, \\;\\;\\; g(n,a) = \\mu n - \\delta a, \\;\\;\\; \\chi (a) = \\chi_0\\]\ni.e. \n\nthere are no kinetics for the amoebae - they simply move randomly via diffusion and undergo chemotaxis in response to cAMP;\nproliferation is neglected; - this is a reasonable assumption given the timescales involved, since they amoebae move on a faster timescale than they proliferate;\nthe amoebae are assumed to produce cAMP in proportion to their density, which means the more amoebae there are, the more cAMP (a reasonable first approximation);\nthe chemotactic function is taken to be a constant, again a reasonable first approximation;\n\\(D_a &gt; D_n\\) since chemicals diffuse faster than cells move randomly.\n\nUnder such assumption we obtain the model equation\n\\[\\begin{eqnarray*}\n\\frac{\\partial n}{\\partial  t} & = & D_n \\nabla^2 n - \\chi_0 \\nabla \\cdot \\left( n \\nabla a \\right), \\\\\n\\frac{\\partial a}{\\partial  t} & = &  D_a \\nabla^2 a +  \\mu n - \\delta a,\n\\end{eqnarray*}\\]\nwhich becomes, when considering a 1-dimensional domain \\([0,L]\\):\n\\[\n\\begin{eqnarray*}\n\\frac{\\partial n}{\\partial  t} & = & D_n \\frac{\\partial ^2 n}{\\partial x^2} - \\chi_0 \\frac{\\partial}{\\partial x} \\left( n \\frac{\\partial a}{\\partial x} \\right), \\\\\n  & & \\hspace{4.5cm} ( \\dagger ) \\\\\n\\frac{\\partial a}{\\partial  t} & = &  D_a \\frac{\\partial ^2 a}{\\partial x^2}  +  \\mu n - \\delta a,\n\\end{eqnarray*}\n\\tag{5.1}\\]\nwith zero flux boundary conditions:\n\\[\\begin{eqnarray*}\nD_a \\frac{\\partial a}{\\partial  x} & = & 0, \\;\\;\\; x = 0,L, \\\\\nD_n \\frac{\\partial n}{\\partial  x} - \\chi_0 n \\frac{\\partial a}{\\partial  x} & = & 0, \\;\\;\\; x = 0,L,\n\\end{eqnarray*}\\]\nwhich in this case reduce to:\n\\[\n\\frac{\\partial a}{\\partial  x} = \\frac{\\partial n}{\\partial  x} = 0, \\;\\;\\; x = 0,L\n\\]"
  },
  {
    "objectID": "BacterialChemotaxis.html#numerical-solutions",
    "href": "BacterialChemotaxis.html#numerical-solutions",
    "title": "5  Aggregation via Chemotaxis",
    "section": "5.2 Numerical solutions",
    "text": "5.2 Numerical solutions\nIn Figure 5.1 we plot numerical solution of @#eq-chemotaxis1d together with no-flux boundary condition. The initial data are uniformly sampled. Note the emergence of periodic spatial structure in both variables. These correspond to peaks and troughs of cell density. The cells produce chemoattractant, \\(a\\), and the this induces a chemtactic flux up the gradient in \\(a\\). Hence more cells move towards regions where \\(a\\) is high, more chemoattractant is produced in this region etc.\n\nWhat is the long-time behaviour of these solutions\nFor which parameters do we expect to see pattern formation?\nHow does spatial pattern depend on the initial data?\n\n\nimport numpy as np\nfrom scipy.integrate import odeint\nimport matplotlib.pyplot as plt\nimport random\n\n\nT=80\nL=150\n\nmu=1.2\ndelta=0.1\nD_n=2.50\nD_a=2.5\nchi_0=1.4\n\nN_x=200\nN_t=100\n\nt=np.linspace(1,T,N_t)\nx=np.linspace(0,L,N_x)\n\nu_0=np.ones_like(x)+0.01*np.random.uniform(low=0.0, high=0.1, size=(N_x,))\nn_0=np.ones_like(x)\n\nu_0=np.concatenate((u_0,n_0))\n\ndx=L/(N_x-1)\ndt=T/(N_t-1)\n\ndef LVPDErhs(sol,t):\n\n    N_x=int(np.ceil(len(sol)/2))\n\n    n=sol[0:N_x]\n    a=sol[N_x:2*N_x]\n\n\n\n    f_n=np.zeros_like(n)\n    f_a=np.zeros_like(n)\n\n    for i in range(1,N_x-2):\n      f_n[i]=D_n/dx**2*(n[i-1]-2*n[i]+n[i+1]) - chi_0*n[i]*1/dx**2*(a[i-1]-2*a[i]+a[i+1])-chi_0/(2*dx)**2*(a[i+1]-a[i-1])*(n[i+1]-n[i-1])\n\n    i=0\n    f_n[i]=D_n/dx**2*(-n[i]+n[i+1]) - chi_0*n[i]*1/(2*dx)**2*(-a[i]+a[i+1])-chi_0/(2*dx)**2*(a[i+1]-a[i])*(n[i+1]-n[i])\n\n    i=N_x-1\n    f_n[i]=D_n/dx**2*(n[i-1]-n[i])- chi_0*n[i]*1/(2*dx)**2*(a[i-1]-a[i])-chi_0/(2*dx)**2*(a[i]-a[i-1])*(n[i]-n[i-1])\n\n\n    for i in range(1,N_x-2):\n      f_a[i]=D_a/dx**2*(a[i-1]-2*a[i]+a[i+1]) \n    i=0\n    f_a[i]=D_a/dx**2*(-a[i]+a[i+1]) \n    i=N_x-1\n    f_a[i]=D_a/dx**2*(a[i-1]-a[i])\n\n    reaction_n=0\n    reaction_a=mu*n-delta*a\n\n    f_n=f_n+reaction_n\n    f_a=f_a+reaction_a\n\n    f= np.concatenate((f_n, f_a)) \n    return f  \n\nsol=odeint(LVPDErhs,u_0,t)\n\nn=sol[:,0:N_x]\na=sol[:,0:N_x]\n\nfig, ax = plt.subplots(2,1)\n\nax[0].plot(x,n[0,:],'r')\nax[0].plot(x,n[16,:],'b')\nax[0].plot(x,n[32,:],'m')\nax[0].plot(x,n[48,:],'k')\nax[0].set_xlabel('$x$')\nax[0].set_ylabel('$n$')\n\nax[1].plot(x, a[0,:],'r--')\nax[1].plot(x, a[16,:],'b--')\nax[1].plot(x, a[32,:],'m--')\nax[1].plot(x, a[48,:],'k--')\nax[1].set_xlabel('$x$')\nax[1].set_ylabel('$a$')\n\nplt.legend(['t'+ str(t[0]),'t='+ str(t[4]),'t='+ str(t[8]),'t='+ str(t[12])])\nplt.xlabel('$x$')\nplt.grid()\nplt.show()\n\n\n\n\nFigure 5.1: Numerical solution of bacterial chemtaxis model"
  },
  {
    "objectID": "BacterialChemotaxis.html#spatially-homogeneous-steady-states",
    "href": "BacterialChemotaxis.html#spatially-homogeneous-steady-states",
    "title": "5  Aggregation via Chemotaxis",
    "section": "5.3 Spatially Homogeneous Steady States",
    "text": "5.3 Spatially Homogeneous Steady States\nThe spatially homogeneous steady state \\((n^* , a^* )\\) satisfies:\n\\[\\mu n^* = \\delta a^*\\]\nand we now undertake a linear stability analysis to determine whether this is stable or unstable. If the above spatially homogeneous steady state is unstable, this will indicate that aggregation patterns may arise in the system."
  },
  {
    "objectID": "BacterialChemotaxis.html#stability-analysis",
    "href": "BacterialChemotaxis.html#stability-analysis",
    "title": "5  Aggregation via Chemotaxis",
    "section": "5.4 Stability Analysis",
    "text": "5.4 Stability Analysis\nIn a similar manner to previous stability analyses, we consider small perturbations around the spatially homogeneous steady state \\((n^* , a^* )\\), i.e.\n\\[\nn(x,t) = n^* + \\tilde{n}(x,t), \\;\\;\\; a(x,t) = a^* + \\tilde{a}(x,t)\n\\]\nwhere \\(\\tilde{n}(x,t)\\) and \\(\\tilde{a}(x,t)\\) are ``small” so that higher order terms can be neglected.\nNOTE Unlike previous stability analysis, these perturbations are both time and space dependent.\nSubstituting the above perturbations into equations \\(( \\dagger )\\), we neglect higher order terms and retain only linear terms. This is largely straightforward, but we provide some detail for the linearization of the chemotactic term i.e. \n\\[\\frac{\\partial}{\\partial x} \\left[ ( n^* + \\tilde{n}) \\frac{\\partial}{\\partial x} \\left( a^* + \\tilde{a} \\right) \\right] = \\frac{\\partial}{\\partial x} \\left[ ( n^* + \\tilde{n}) \\frac{\\partial \\tilde{a}}{\\partial x}  \\right] \\approx n^* \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2}\\]\nThe fully linearized system is then given by:\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n\\frac{\\partial \\tilde{n}}{\\partial  t} & =  D_n \\frac{\\partial ^2 \\tilde{n}}{\\partial x^2} - \\chi_0 n^* \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2} \\\\\n\\frac{\\partial \\tilde{a}}{\\partial  t} & =   D_a \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2}  +  \\mu \\tilde{n} - \\delta \\tilde{a}.\n\\end{aligned}\n\\end{eqnarray}\n\\tag{5.2}\\]\nAlthough the above equations are linear, an explicit solution is non-trivial and we are required to make a further ansatz. We use the``separation of variables ” approach where \\[\n\\tilde{n}(t,x) = u(t) \\phi_1(x)\n\\] and \\[\n\\tilde a (t,x) = v(t) \\phi_2(x)\n\\]\n\\[\\begin{eqnarray*}\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}  \\phi_1  =   D_n  u\\frac{\\partial ^2 \\phi_1}{\\partial x^2} - \\chi_0 n^*  v\\frac{\\partial ^2 \\phi_1}{\\partial x^2} \\\\\n& \\frac{v}{\\partial  t}  \\phi_2=     D_a v \\frac{\\partial ^2  \\phi_2}{\\partial x^2}  +  \\mu u \\,  \\phi_1 - \\delta v\\,  \\phi_2, \\\\\n& u \\frac{\\partial \\phi_1}{\\partial x} = 0, \\quad   v \\frac{\\partial \\phi_2}{\\partial x} = 0 \\quad \\text{ for } \\; x = 0, \\; x=L.\n\\end{aligned}\n\\end{eqnarray*}\\]\nWe assume that\n\\[\n\\phi_1 = \\phi_2 = \\phi,\n\\] where \\(\\phi_1\\) is the solution of the elliptic problem \\[\n\\begin{aligned}\n\\frac{d^2 \\phi}{dx^2} &= - k^2 \\phi && \\text{ in } \\; (0,L), \\\\\n\\frac{d \\phi}{dx} &= 0  && \\text{ for } \\; x=0, \\; x=L.\n\\end{aligned}\n\\] We can compute that solution of the equation for \\(\\phi\\) are of the form \\[\n\\phi(x) = A \\cos(kx) + B\\sin(kx).\n\\] Since \\(\\phi\\) satisfied zero Neumann boundary conditions we have that \\(\\phi(x) = A \\cos(kx)\\), with an arbitrary const \\(A\\), and \\(k = \\dfrac {m \\pi} L\\), ; \\(m \\in \\mathbb N\\).\nThen we have \\[\n\\begin{eqnarray*}\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}  \\phi  =   - k^2 D_n  u \\phi +  \\chi_0 n^* k^2\\,  v \\, \\phi,  \\\\\n& \\frac{v}{\\partial  t} \\phi =   - k^2 D_a  \\, v \\phi  +  \\mu u \\,  \\phi - \\delta v\\,  \\phi,\n\\end{aligned}\n\\end{eqnarray*}\n\\] and since \\(\\phi\\) is not identically zero on \\((0,L)\\) we obtain a system of linear ODEs for \\((u(t),v(t))\\) \\[\n\\begin{eqnarray*}\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}    =   - k^2 D_n  u  +  \\chi_0 n^* k^2\\,  v,  \\\\\n& \\frac{v}{\\partial  t} =   - k^2 D_a  \\, v  +  \\mu u  - \\delta v.\n\\end{aligned}\n\\end{eqnarray*}\n\\]\nWe know that solutions of linear ODEs have the form \\[\nu(t) = C_1 e^{\\lambda t} \\quad \\textrm{and} \\quad v(t) = C_2 e^{\\lambda t}\n\\] for some constant \\(C_1\\), \\(C_2\\) and \\(\\lambda\\) are eigenvalues of the corresponding matrix.\nThus we obtain \\[\\begin{eqnarray*}\n\\lambda C_1 & = & - D_n k^2 C_1  + \\chi_0 n^* k^2 C_2,  \\\\\n\\lambda C_2 & = & - D_a k^2 C_2 +  \\mu C_1 - \\delta C_2,\n\\end{eqnarray*}\\]\nwhich can be written\n\\[\n\\left(\n\\begin{array}{cc}\n- D_n k^2 - \\lambda &  \\chi_0 n^* k^2 \\\\\n\\mu & - D_a k^2 -\\delta -\\lambda\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\nC_1 \\\\\nC_2\n\\end{array}\n\\right) = \\bf{0} .\n\\]\nRemark Notice that we obtained that \\(\\tilde n\\) and \\(\\tilde a\\) are of the form \\[\\tilde{n}(x,t) = C_1 e^{\\lambda t} e^{ikx}, \\;\\;\\; \\tilde{a}(x,t) = C_2 e^{\\lambda t} e^{ikx}.\\]\nFor a non-trivial solution (for non-trivial perturbations \\(\\tilde n\\), \\(\\tilde a\\)), i.e. \\(C_1 \\neq 0\\) and \\(C_2 \\neq 0\\), the determinant of the above matrix must be zero, and this leads to the following quadratic equation to be solved for \\(\\lambda\\):\n\\[\n\\lambda^2 + \\left( D_n k^2 + D_a k^2 + \\delta \\right) \\lambda + D_n k^2 \\left( D_a k^2 + \\delta \\right) - \\mu \\chi_0 n^* k^2 = 0.\n\\]\nThis is of the form \\[\n\\lambda^2 + \\alpha \\lambda + \\beta = 0,\n\\]\nand so has roots: \\[\n\\lambda = \\frac{-\\alpha \\pm \\sqrt{\\alpha^2 - 4 \\beta}}{2}.\\]\nNOTE This has two real roots, since \\[\n\\alpha^2 - 4 \\beta &gt; 0\n\\] (see Exercise/Tutorial).\nFor stability, we require both roots to be negative. Since both roots are real, this leads to:\n\\[\n\\lambda &lt; 0  \\Leftrightarrow \\alpha &gt; 0 \\;\\;\\; \\text{and} \\;\\;\\; \\beta &gt;0.\n\\]\nNow \\[\\alpha = D_n k^2 + D_a k^2 + \\delta &gt; 0,\n\\] and so for stability, we require \\(\\beta &gt; 0\\) i.e. \n\\[\\begin{eqnarray*}\n& & D_n k^2 \\left( D_a k^2 + \\delta \\right) - \\mu \\chi_0 n^* k^2 &gt; 0 \\\\\n& & \\Rightarrow \\mu \\chi_0 n^* &lt;  D_n  \\left( D_a k^2 + \\delta \\right)\n\\end{eqnarray*}\\]\nHence, we will have instability when this condition is not satisfied i.e.  \\[\n\\mu \\chi_0 n^* &gt;  D_n  \\left( D_a k^2 + \\delta \\right).\n\\]\nThe precise value of \\(k^2\\) can be determined from the zero-flux boundary conditions i.e. \\[\nk  =  \\frac{m \\pi}{L}, \\;\\;\\; m = 1,2, \\dots\n\\] if we look for non-constant \\(\\phi\\).\nHence, we will have instability whenever \\[\n\\mu \\chi_0 n^* &gt;  D_n  \\left( D_a \\frac{m^2 \\pi^2}{L^2} + \\delta \\right), \\;\\;\\; m = 1,2, \\dots\n\\]\nIt can be shown (see Exercise/Tutorial), that \\(\\lambda (k^2)\\) ( or \\(\\lambda (m^2)\\)) is monotonic decreasing and hence the fastest growing mode is \\(m=1\\) i.e. we have an instability as long as \\[\n\\mu \\chi_0 n^* &gt;  D_n  \\left( \\frac{D_a \\pi^2}{L^2} + \\delta \\right).\n\\]\nIn general, from the above inequality, we can say that there is a likelihood of instability (amoebae aggregation) if:\n\n\\(D_a\\), \\(D_n\\) and \\(\\delta\\) are all ``small’’\nL is ``large’’\n\\(\\chi_0 , \\mu , n^*\\) are ``large’’\n\nConsidering all other parameters to be fixed, in theory the above result states that it is possible to find a large enough value for the chemotactic coefficient \\(\\chi_0\\) to satisfy the instability condition i.e. chemotaxis induces instability and leads to aggregation of the amoebae.\nHowever, there is one type of system where diffusion also has a destabilizing effect…"
  },
  {
    "objectID": "LotkaVolteraPDE.html#nondimensionalization",
    "href": "LotkaVolteraPDE.html#nondimensionalization",
    "title": "4  Lotka Voltera model",
    "section": "4.1 Nondimensionalization",
    "text": "4.1 Nondimensionalization\nConsider the scaling \\[\\begin{eqnarray*}\nx^\\ast = x \\sqrt{\\frac \\rho {D_n}} , \\qquad t^\\ast = \\rho \\, t , \\quad u^\\ast = \\frac uK, \\quad n^\\ast = n \\frac \\alpha \\rho\n\\end{eqnarray*}\\] in one dimension. Upon dropping the asteriked notation \\[\n\\begin{equation}\n\\begin{cases}\n  &\\dfrac{\\partial u}{\\partial t} =  u ( 1 - u - n)  + D \\dfrac{\\partial^2 u}{\\partial x^2}\\; = \\; f(u,n) + D\\dfrac{\\partial^2 u}{\\partial x^2} \\qquad x\\in \\mathbb R , t&gt;0 \\,,  \\\\\n& \\dfrac{\\partial n}{\\partial t} = a\\,  n(u -b) + \\dfrac{\\partial^2  n}{\\partial x^2}\\; =\\; \\;  g(u,n) + \\dfrac{\\partial^2  n}{\\partial x^2}\\;  \\qquad x\\in \\mathbb R , t&gt;0,\n\\end{cases}\n\\end{equation}\n  \\tag{4.2}\\] where \\[\nD= \\dfrac{D_u}{D_n}, \\quad a = \\dfrac{\\beta K}\\rho, \\quad   b = \\dfrac \\gamma{ K \\beta}.\n\\]"
  },
  {
    "objectID": "LotkaVolteraPDE.html#numerical-solutions",
    "href": "LotkaVolteraPDE.html#numerical-solutions",
    "title": "4  Lotka Voltera model",
    "section": "4.2 Numerical solutions",
    "text": "4.2 Numerical solutions\n\nimport numpy as np\nfrom scipy.integrate import odeint\nimport matplotlib.pyplot as plt\n\nT=100\nL=150\n\na=0.2\nb=0.4\nD_u=0.10\n\nN_x=100\nN_t=100\n\nt=np.linspace(1,T,N_t)\nx=np.linspace(0,L,N_x)\n\nu_0=b+(1-b)*0.5*(1+np.tanh(1*0.5*(x-50)))\nn_0=(1-b)*0.5*(1+np.tanh(-1*0.5*(x-50)))\n\nu_0=np.concatenate((u_0,n_0))\n\ndx=L/(N_x-1)\ndt=T/(N_t-1)\n\ndef LVPDErhs(sol,t):\n\n    N_x=int(np.ceil(len(sol)/2))\n\n    u=sol[0:N_x]\n    n=sol[N_x:2*N_x]\n\n\n\n    f_u=np.zeros_like(u)\n    f_n=np.zeros_like(u)\n\n    for i in range(1,N_x-2):\n      f_u[i]=D_u/dx**2*(u[i-1]-2*u[i]+u[i+1]) \n    i=0\n    f_u[i]=D_u/dx**2*(-u[i]+u[i+1]) \n    i=N_x-1\n    f_u[i]=D_u/dx**2*(u[i-1]-u[i])\n\n    for i in range(1,N_x-2):\n      f_n[i]=1/dx**2*(n[i-1]-2*n[i]+n[i+1]) \n    i=0\n    f_n[i]=1/dx**2*(-n[i]+n[i+1]) \n    i=N_x-1\n    f_n[i]=1/dx**2*(n[i-1]-n[i])\n\n    reaction_u=u*(1-u-n)\n    reaction_n=a*n*(u-b)\n\n    f_u=f_u+reaction_u\n    f_n=f_n+reaction_n\n\n    f= np.concatenate((f_u, f_n)) \n    return f  \n\nsol=odeint(LVPDErhs,u_0,t)\n\nu=sol[:,0:N_x]\nn=sol[:,N_x:2*N_x]\n\nprint(np.shape((u)))\n\nfig, ax = plt.subplots(2,1)\n\nax[0].plot(x,u[0,:],'r')\nax[0].plot(x,u[16,:],'b')\nax[0].plot(x,u[32,:],'m')\nax[0].plot(x,u[48,:],'k')\nax[0].set_xlabel('$x$')\nax[0].set_ylabel('$u$')\n\nax[1].plot(x, n[0,:],'r--')\nax[1].plot(x, n[16,:],'b--')\nax[1].plot(x, n[32,:],'m--')\nax[1].plot(x, n[48,:],'k--')\nax[1].set_xlabel('$x$')\nax[1].set_ylabel('$n$')\n\nplt.legend(['t'+ str(t[0]),'t='+ str(t[4]),'t='+ str(t[8]),'t='+ str(t[12])])\nplt.xlabel('$x$')\nplt.grid()\nplt.show()\n\n(100, 100)\n\n\n\n\n\nFigure 4.1: Numerical solution of LV model"
  },
  {
    "objectID": "LotkaVolteraPDE.html#spatially-homogeneous-steady-states",
    "href": "LotkaVolteraPDE.html#spatially-homogeneous-steady-states",
    "title": "4  Lotka Voltera model",
    "section": "4.3 Spatially homogeneous steady states",
    "text": "4.3 Spatially homogeneous steady states\nWe have for spatially homogeneous steady states \\[\nf(u,n) =0 , \\qquad g(u,n) = 0\n\\] Thus \\[\\begin{eqnarray*}\nu(1-u-n) = 0 , && \\quad  u =0, \\quad u+n=1,\\\\\nan(u-b) = 0 , && \\quad n =0, \\quad u =b \\; .\n\\end{eqnarray*}\\] Thus steady states are \\[\n(u_1^\\ast, n_1^\\ast)= (0,0), \\quad (u_2^\\ast, n_2^\\ast)= (1,0), \\quad (u_3^\\ast, n_3^\\ast)= (b,1-b), \\, 0\\leq b &lt;1\n\\]\nStability of steady states to spatially homogeneous perturbations \\[\\begin{equation}\nJ(u_j^\\ast, n^\\ast_j) = \\begin{pmatrix}\n1-2u -n & -u \\\\\nan &a(u-b)\n\\end{pmatrix}_{(u^\\ast_j, n^\\ast_j)}, \\quad j = 1,2,3.\n\\end{equation}\\]\nFor \\((u_1^\\ast, n_1^\\ast)= (0,0)\\) \\[\n\\det(J (0,0) - \\lambda I) = - (1- \\lambda)(\\lambda+ ab) = 0\n\\] and \\[\n\\lambda_1^+ = 1, \\quad \\lambda_1^- = - ab &lt;0.\n\\] Thus \\((0,0)\\) is a saddle point.\nFor \\((u_2^\\ast, n_2^\\ast)= (1,0)\\) \\[\n\\det(J (1,0) - \\lambda I) = - (1+ \\lambda)(a(1-b)- \\lambda) = 0\n\\] and \\[\n\\lambda_2^- =- 1, \\quad \\lambda_2^+ = a(1-b) &gt;0 \\; \\text{ for } \\; 0 \\leq b &lt;1.\n\\] Thus \\((1,0)\\) is a saddle point.\nFor \\((u_3^\\ast, n_3^\\ast)= (b,1-b)\\) \\[\n\\det(J (b,1-b) - \\lambda I) =\\lambda^2 + b \\lambda + ab(1-b) = 0\n\\] and \\[\\begin{eqnarray*}\n\\text{ If } && \\;  4 ab (1-b) \\leq b^2 \\qquad \\lambda_3^{\\pm} &lt; 0 \\quad \\text{ stable node } \\\\\n  \\text{ If }  && \\; 4 ab (1-b) &gt; b^2 \\qquad Re(\\lambda_3^{\\pm}) &lt; 0 , \\;  Im(\\lambda_3^{\\pm}) \\neq 0\\quad \\text{ stable focus (spiral) } , \\\\\n&& \\text{ for } b&gt;0, \\; 1-b&gt;0 \\text{ spiral oscillations  are biologically realistic as long } u&gt;0, \\; n&gt;0\\; .\n\\end{eqnarray*}\\]"
  },
  {
    "objectID": "LotkaVolteraPDE.html#existence-of-travelling-wave-profiles-connection-10-and-b1-b",
    "href": "LotkaVolteraPDE.html#existence-of-travelling-wave-profiles-connection-10-and-b1-b",
    "title": "4  Lotka Voltera model",
    "section": "4.4 Existence of travelling wave profiles connection \\((1,0)\\) and \\((b,1-b)\\)",
    "text": "4.4 Existence of travelling wave profiles connection \\((1,0)\\) and \\((b,1-b)\\)\nConsider travelling wave solutions \\[\\begin{eqnarray*}\nu(t,x) = W(x+ vt) = W(z) , \\quad v&gt;0, \\\\\nn(t,x) = N( x + vt) = N(z) , \\quad v &gt;0.\n\\end{eqnarray*}\\] and \\[\\begin{eqnarray*}\nu(t,x) \\to 1 \\; \\text{ as } x \\to - \\infty,  && \\; \\qquad  W(z)\\to 1 \\; \\text{ as } z \\to - \\infty, \\quad\\\\\nu(t,x) \\to b \\; \\text{ as } x \\to +\\infty, && \\;  \\qquad   W(z)\\to b \\; \\text{ as } z \\to + \\infty \\\\\nn(t,x) \\to 0 \\;  \\text{ as } x \\to - \\infty ,  &&\\qquad  \\;  N(z)\\to 0 \\;  \\text{ as } z \\to - \\infty, \\quad \\\\\nn(t,x) \\to 1-b \\; \\text{ as } x \\to +\\infty, && \\;  \\qquad N(z)\\to 1-b \\;  \\text{ as } z \\to +\\infty\n\\end{eqnarray*}\\]\nThe system Equation 4.2 becomes now \\[\n\\begin{eqnarray}\n\\begin{aligned}\n&v \\frac{dW}{dz} = D \\frac{d^2W}{dz^2} + W(1-W-N) ,\\\\\n& v \\frac{dN}{dz} =  \\frac{d^2N}{dz^2} + a N(W-b),\n\\end{aligned}\\\\\n\\begin{aligned}\\label{TW_pp_BC}\n& W(z)\\to 1 \\; \\text{ as } z \\to - \\infty, \\quad W(z)\\to b \\; \\text{ as } z \\to + \\infty, \\\\\n& N(z)\\to 0 \\;  \\text{ as } z \\to - \\infty, \\quad N(z)\\to 1-b \\;  \\text{ as } z \\to +\\infty\\; .\n  \\end{aligned}\n\\end{eqnarray}\n\\tag{4.3}\\]\nWe shall suppose that the prey species moves much more slowly than the predator species, i.e.  \\[\nD= D_u/D_n \\ll 1\n\\] and simplify Equation 4.3 as\n\\[\n\\begin{eqnarray}\n\\begin{aligned}\n&v \\frac{dW}{dz} =  W(1-W-N) ,\\\\\n& v \\frac{dN}{dz} =  \\frac{d^2N}{dz^2} + a N(W-b),\n\\end{aligned}\n\\end{eqnarray}\n\\tag{4.4}\\]\nWe can rewrite Equation 4.4 as a system of 1st order ODEs: \\[\n\\begin{eqnarray}\n\\begin{aligned}\n& \\frac{dW}{dz} = \\frac 1 v W(1-W-N) &= F(W,N,P),\\\\\n&\\frac{dN}{dz} = P  &= G(W, N,P)\\\\\n&  \\frac{dP}{dz} = v P - a N(W-b)  &= R(W,N,P).\n\\end{aligned}\n\\end{eqnarray}\n\\tag{4.5}\\] Steady states of Equation 4.4 are \\[\n(W^\\ast_1, N^\\ast_1, P^\\ast_1) = (0,0,0), \\quad (W^\\ast_2, N^\\ast_2, P^\\ast_2) = (1,0,0), \\quad (W^\\ast_3, N^\\ast_3, P^\\ast_3) =(b, 1-b, 0).\n\\] Stability of steady states \\[\nJ(W,N,P) = \\begin{pmatrix}\n\\dfrac 1 v - \\dfrac{2W} v - \\dfrac Nv & - \\dfrac Wv & 0 \\\\\n0 & 0 & 1 \\\\\n- aN & a(b-W) & v\n\\end{pmatrix}\n\\] At \\[\n(W^\\ast_1, N^\\ast_1, P^\\ast_1) = (0,0,0)\n\\] we have \\[\n\\det(J(0,0,0) - \\lambda I)= \\left( \\frac 1 v - \\lambda\\right) (\\lambda^2 - \\lambda v - ab) =0\n\\] and \\[\n\\lambda_1^1= \\frac 1 v &gt; 0, \\quad \\lambda_2^{\\pm} = \\frac{ v \\pm \\sqrt{v^2 + 4 ab} } 2\n\\] Thus \\((0,0,0)\\) is a saddle point with a \\(2\\)-dim unstable manifold\nAt \\((W^\\ast_2, N^\\ast_2, P^\\ast_2) = (1,0,0)\\) we have \\[\n\\det(J(1,0,0) - \\lambda I)= \\left(- \\frac 1 v - \\lambda\\right) (\\lambda^2 - \\lambda v + a(1-b)) =0\n\\] and \\[\n\\lambda_1^1= -\\frac 1 v &lt; 0, \\quad \\lambda_2^{\\pm} = \\frac{ v \\pm \\sqrt{v^2 - 4 a(1-b)} } 2\n\\] Thus since, \\(0\\leq b &lt; 1\\) and \\(4(1-b)&gt;0\\), \\[\\begin{eqnarray*}\n\\text{If } &&  v^2 \\geq  4 a(1-b) \\quad (1,0,0) \\text{ is a saddle with $2$-dim unstable manifold},\\\\\n\\text{If } &&  v^2 &lt;  4 a(1-b) \\quad (1,0,0) \\text{ is an unstable focus}\n\\end{eqnarray*}\\]\nFor a travelling wave with \\(W\\geq 0\\) and \\(N \\geq 0\\) to exist we requite \\(v^2 \\geq 4 a(1-b)\\) and obtain a minimal wave speed \\[v_\\text{min}=2\\sqrt{a(1-b)}   \\quad \\text{ with } \\quad  0\\leq b&lt;1.\\]\nAt \\((W^\\ast_3, N^\\ast_3, P^\\ast_3) =(b, 1-b, 0)\\) we have \\[\n\\det(J(b,1-b,0) - \\lambda I)= \\lambda^3 - \\lambda^2(v- \\frac b v) - \\lambda b - \\frac 1 v ab(1-b) = p(\\lambda) =0\n\\] To analyse \\(p(\\lambda)\\) we observe that local min and max of \\(p(\\lambda)\\) are independent of \\(a\\): \\[\np^\\prime(\\lambda) = 3 \\lambda^2 - 2 \\lambda \\left( v - \\frac b v\\right) - b = 0\n\\] and \\[\n\\lambda_{m,M}= \\frac 13 \\left[ \\left(v - \\frac bv \\right) \\pm \\sqrt{ \\left(v - \\frac bv\\right) ^2 + 3 b } \\right]\n\\] If \\(a=0\\) then we have eigenvalues \\[\n\\lambda_3^1 = 0, \\quad \\lambda_3^\\pm = \\frac 12 \\left( v - \\frac bv \\pm \\sqrt{\\left(v - \\frac bv\\right)^2 + 4 b} \\right)\\; .\n\\] Thus there exists a critical value \\(a^\\ast&gt;0\\) such that * for \\(a \\in (0, a^\\ast)\\) we obtain \\(2\\) real negative eigenvalues and \\(1\\) positive real eigenvalue and \\((b, 1-b, 0)\\) is a saddle with \\(2\\)-dim stable manifold and \\(1\\)-dim unstable manifold\n\nfor \\(a&gt;a^\\ast\\) we will have a pair of complex conjugate eigenvalues with negative real part and one real positive eigenvalue corresponding to \\(1\\)-dim unstable manifold.\n\nThis can be easily seen from a sketch of the cubic equation:\n\\[p(\\lambda) = \\lambda^3 - \\lambda^2(v- \\frac b v) - \\lambda b - \\frac 1 v ab(1-b).\\]\nThus we have a possible heteroclinic connection between \\((1,0,0)\\) and \\((b, 1-b, 0)\\), i.e. between \\(2\\)-dim unstable manifold at \\((1,0,0)\\) and \\(2\\)-dim stable manifold at \\((b, 1-b, 0)\\), and therefore an existence of a travelling wave front solution for Equation 4.2 with \\[\\begin{eqnarray*}\nu(t,x) \\to 1 \\; \\text{ as } x \\to - \\infty,  \\quad &&\nu(t,x) \\to b \\; \\text{ as } x \\to +\\infty,  \\\\\nn(t,x) \\to 0 \\;  \\text{ as } x \\to - \\infty ,  \\quad &&\nn(t,x) \\to 1-b \\; \\text{ as } x \\to +\\infty\\; .\n\\end{eqnarray*}\\]"
  }
]