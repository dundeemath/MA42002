{
  "hash": "964ec7076e1fb042c399fa8e16a42dbf",
  "result": {
    "markdown": "---\ntitle: \"Aggregation via Chemotaxis\"\nformat: html\n---\n\n**Dictyostelium discoideum** (Dicty) is a slime-mold that is widely studied experimentally as a model organism.  The individual amoebae that constitute a slime-mold exhibit a range of phenomena also observed in mammalian cells e.g. differentiation, proliferation, migration. \n\nUnder nutirent starvation conditions, Dicty cells undergo complex collective behaviours. Individual amoebae secrete a diffusible chemical, cyclic AMP or cAMP. The amoebae respond chemotactically to cAMP and begin to migrate towards regions of high cAMP concentration via  *chemotaxis*. As they migrate they generate a range of intricate patterns including *spiral waves* and *streaming* aggregation patterns (e.g.  @fig-dicty_spiral).\n\n\nThe movie below depicts slime mold aggregation {{< video https://www.youtube.com/watch?v=bkVhLJLG7ug >}}. Note the aggregation  between 0:35 and 0.48.\n\n\n\nIn @fig-dicty_spiral we can see stills-shot images of spiral patterns. This spirals are dynamic as can be seen {{< video https://www.youtube.com/watch?v=OX5Yiz38fgY >}}. See spiral pattern at around 0:36. \n\n![Spiral wave patterns underly Dictystelium aggregation. Image from @durston2013dictyostelium. ](CG-14-355_F2.jpg){#fig-dicty_spiral}\n\n* can we simulate/model the mechanisms regulate that give rise to cellular aggregation? \n* how do features of patterns that form (e.g. pattern wavelength, speepd of aggregation) depend on individual cell properties?\n\n\n\n\n\n##  Model derivation\n\nWe consider a model for Dicty aggregation  through the secretion of and chemotactic response to cAMP. We denote by $n({\\mathbf{x}}, t)$ the density of amoebae and $a({\\mathbf{x}}, t)$ the concentration of cAMP. The general conservation equation for the amoebae can be written:\n\n$$\n\\frac{\\partial n}{\\partial  t} + \\nabla \\cdot {\\mathbf{J}} = f(n,a),\n$$\nwhere $f(n,a)$ models any reaction terms for the amoebae e.g. proliferation, and the flux is given by\n$$\n{\\mathbf{J}} = {\\mathbf{J}}_{diffusion} + {\\mathbf{J}}_{chemotaxis}.\n$$\n\nAssuming Fickian diffusion and the general chemotactic flux stated earlier (@sec-conservation), the general *reaction-diffusion-chemotaxis* model for the amoebae responding to cAMP is given by:\n\n$$\n\\begin{aligned}\n\\frac{\\partial n}{\\partial  t} &=  \\underbrace{D_n \\nabla^2 n}_{diffusion} - \\underbrace{\\nabla \\cdot \\left( \\chi(a) n \\nabla a \\right)}_{chemotaxis} + f(n,a),   \\\\\n\\frac{\\partial a}{\\partial  t} & =   D_a \\nabla^2 a + g(n,a), \n\\end{aligned}\n$$\n\nwhere we have assumed Fickian diffusion for the cAMP and $g(a,n)$ represents the kinetics i.e. source/sink terms, of cAMP. \n\nOne simple model has the following assumptiond:\n\n$$f(n,a) = 0, \\;\\;\\; g(n,a) = \\mu n - \\delta a, \\;\\;\\; \\chi (a) = \\chi_0$$\n\ni.e. \n\n* there are no kinetics for the amoebae - they simply move randomly via diffusion and undergo chemotaxis in response to cAMP;\n\n* proliferation is neglected; - this is a reasonable assumption given the timescales involved, since they amoebae move on a faster timescale than they proliferate;\n\n* the amoebae are assumed to produce cAMP in proportion to their density, which means the more amoebae there are, the more cAMP (a reasonable first approximation);\n\n* the chemotactic function is taken to be a constant, again a reasonable first approximation;\n\n* $D_a > D_n$ since chemicals diffuse faster than cells move randomly.\n\nUnder such assumptions we obtain the model equation\n\n$$\n\\begin{aligned}\n\\frac{\\partial n}{\\partial  t} & =  D_n \\nabla^2 n - \\chi_0 \\nabla \\cdot \\left( n \\nabla a \\right), \\\\\n\\frac{\\partial a}{\\partial  t} & =   D_a \\nabla^2 a +  \\mu n - \\delta a,\n\\end{aligned}\n$$\n\nwhich becomes, upon considering a 1-dimensional domain $[0,L]$,\n\n$$\n\\begin{aligned}\n\\frac{\\partial n}{\\partial  t} &=  D_n \\frac{\\partial ^2 n}{\\partial x^2} - \\chi_0 \\frac{\\partial}{\\partial x} \\left( n \\frac{\\partial a}{\\partial x} \\right), \\\\\n  & & \\hspace{4.5cm} ( \\dagger ) \\\\\n\\frac{\\partial a}{\\partial  t} &=  D_a \\frac{\\partial ^2 a}{\\partial x^2}  +  \\mu n - \\delta a,\n\\end{aligned}\n$$ {#eq-chemotaxis1d}\n\nwith zero flux boundary conditions:\n\n$$\n\\begin{aligned}\nD_a \\frac{\\partial a}{\\partial  x} & =  0, \\;\\;\\; x = 0,L, \\\\\nD_n \\frac{\\partial n}{\\partial  x} - \\chi_0 n \\frac{\\partial a}{\\partial  x} & =  0, \\;\\;\\; x = 0,L.\n\\end{aligned}\n$$\n\nThese reduce to:\n\n$$\n\\frac{\\partial a}{\\partial  x} = \\frac{\\partial n}{\\partial  x} = 0, \\;\\;\\; x = 0,L.\n$$\n\n## Numerical solutions\n\nIn @fig-bacterialchemotaxispde we plot numerical solution of @eq-chemotaxis1d together with no-flux boundary condition. The initial data are uniformly sampled. Note the emergence of periodic spatial structure in both variables. These correspond to peaks and troughs of cell density. The cells produce chemoattractant, $a$, and the this induces a chemtactic flux up the gradient in $a$. Hence more cells move towards regions where $a$ is high, more chemoattractant is produced in this region etc. \n\n* What is the long-time behaviour of these solutions\n* For which parameters do we expect to see pattern formation?\n* How does spatial pattern depend on the initial data?\n\n::: {.cell execution_count=1}\n\n::: {.cell-output .cell-output-display}\n![Numerical solution of bacterial chemtaxis model](BacterialChemotaxis_files/figure-pdf/fig-bacterialchemotaxispde-output-1.pdf){#fig-bacterialchemotaxispde}\n:::\n:::\n\n\n## Spatially Homogeneous Steady States\n\nDefine the total number of cells, $N$,\n$$\nN= \\int_0^L n(x,t)dx\n$$\nUpon differentiation with respect to time\n$$\n\\begin{aligned}\n\\frac{dN}{dt} &=\\int_0^L \\frac{\\partial n(x,t)}{\\partial t}dx\n&=\\int_0^L  D_n \\frac{\\partial ^2 n}{\\partial x^2} - \\chi_0 \\frac{\\partial}{\\partial x} \\left( n \\frac{\\partial a}{\\partial x} \\right) dx.\n\\end{aligned}\n$$\nUpon integration of the right-hand side w.r.t. $x$, subsequent application of the no-flux boundary condition implies\n$$\n\\frac{dN}{dt}=0.\n$$\nHence the total number of cells in the domain is fixed by the initial data. For a spatially homogeneoud solutions, th4 cells must be uniformly distributed in space, i.e.\n$$\nn^*=N/L\n$$\n\nAdditionaly, the spatially homogeneous steady state solution $(n^* , a^* )$ satisfies:\n\n$$\na^*=\\frac{\\mu}{\\delta} n^*.\n$$\n\nWe now undertake a linear stability analysis to determine whether this is stable or unstable. If the above spatially homogeneous steady state is unstable, this will indicate that aggregation patterns may arise in the system.\n\n## Stability Analysis\n\nIn a similar manner to previous stability analyses, we consider small perturbations around the spatially homogeneous steady state $(n^* , a^* )$, i.e.\n\n$$\nn(x,t) = n^* + \\tilde{n}(x,t), \\;\\;\\; a(x,t) = a^* + \\tilde{a}(x,t)\n$$\n\nwhere $\\tilde{n}(x,t)$ and $\\tilde{a}(x,t)$ are \"small\" so that higher order terms can be neglected.\n\n**NOTE** Unlike previous stability analysis, these perturbations are both *time* and *space* dependent.\n\nSubstituting the above perturbations into equations $( \\dagger )$, we neglect higher order terms and retain only linear terms. This is largely straightforward, but we provide some detail for the linearization of the chemotactic term i.e. \n\n$$\n\\frac{\\partial}{\\partial x} \\left[ ( n^* + \\tilde{n}) \\frac{\\partial}{\\partial x} \\left( a^* + \\tilde{a} \\right) \\right] = \\frac{\\partial}{\\partial x} \\left[ ( n^* + \\tilde{n}) \\frac{\\partial \\tilde{a}}{\\partial x}  \\right] \\approx n^* \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2}.\n$$\n\nThe fully linearized system is then given by:\n$$\n\\begin{aligned}\n\\frac{\\partial \\tilde{n}}{\\partial  t} & =  D_n \\frac{\\partial ^2 \\tilde{n}}{\\partial x^2} - \\chi_0 n^* \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2} \\\\\n\\frac{\\partial \\tilde{a}}{\\partial  t} & =   D_a \\frac{\\partial ^2 \\tilde{a}}{\\partial x^2}  +  \\mu \\tilde{n} - \\delta \\tilde{a}.\n\\end{aligned}\n$$ {#eq-chemotax_linear}\n\nAlthough the above equations are linear, an explicit solution is non-trivial and we are required to make a further \"separation of variables\" *ansatz*. We seek solutions of the form\n$$\n\\tilde{n}(t,x) = u(t) \\phi_1(x)\n$$ \nand \n$$\n\\tilde a (t,x) = v(t) \\phi_2(x)\n$$\n\nUpon substitution\n$$\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}  \\phi_1  =   D_n  u\\frac{\\partial ^2 \\phi_1}{\\partial x^2} - \\chi_0 n^*  v\\frac{\\partial ^2 \\phi_1}{\\partial x^2} \\\\\n& \\frac{\\partial v}{\\partial  t}  \\phi_2=     D_a v \\frac{\\partial ^2  \\phi_2}{\\partial x^2}  +  \\mu u \\,  \\phi_1 - \\delta v\\,  \\phi_2, \\\\\n\\end{aligned}\n$$\nwith boundary conditions\n$$\n\\begin{aligned}\n& u \\frac{\\partial \\phi_1}{\\partial x} = 0, \\quad   v \\frac{\\partial \\phi_2}{\\partial x} = 0 \\quad \\text{ for } \\; x = 0, \\; x=L.\n\\end{aligned}\n$$\n\nWe assume that  \n$$\n\\phi_1 = \\phi_2 = \\phi,\n$$\nwhere $\\phi$ is the solution of the elliptic problem \n$$\n\\begin{aligned}\n\\frac{d^2 \\phi}{dx^2} &= - k^2 \\phi && \\text{ in } \\; (0,L), \\\\\n\\frac{d \\phi}{dx} &= 0  && \\text{ for } \\; x=0, \\; x=L. \n\\end{aligned}\n$$\nWe can compute that solution of the equation for $\\phi$ are of the form \n$$\n\\phi(x) = A \\cos(kx) + B\\sin(kx).\n$$\nSince $\\phi$ satisfied zero Neumann boundary conditions we have that \n$$\n\\phi(x) = A \\cos(kx),\n$$\nwhere $A$ is an arbitrary constanr, and \n$$\nk = \\dfrac {m \\pi} L, \\quad m \\in \\mathbb N.\n$$ \n\nThen we have\n$$\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}  \\phi  =   - k^2 D_n  u \\phi +  \\chi_0 n^* k^2\\,  v \\, \\phi,  \\\\\n& \\frac{\\partial v}{\\partial  t} \\phi =   - k^2 D_a  \\, v \\phi  +  \\mu u \\,  \\phi - \\delta v\\,  \\phi, \n\\end{aligned}\n$$\n and since $\\phi$ is not identically zero on $(0,L)$ we obtain a system of linear ODEs for $(u(t),v(t))$\n$$\n\\begin{aligned}\n&\\frac{\\partial u}{\\partial  t}    =   - k^2 D_n  u  +  \\chi_0 n^* k^2\\,  v,  \\\\\n& \\frac{\\partial v}{\\partial  t} =   - k^2 D_a  \\, v  +  \\mu u  - \\delta v. \n\\end{aligned}\n$$\n\nWe know that solutions of linear ODEs have the form \n$$\nu(t) = C_1 e^{\\lambda t} \\quad \\textrm{and} \\quad v(t) = C_2 e^{\\lambda t}\n$$\n for some constant $C_1$, $C_2$ and $\\lambda$ are eigenvalues of the corresponding matrix. \n\nThus  we obtain \n$$\n\\begin{aligned}\n\\lambda C_1 & =  - D_n k^2 C_1  + \\chi_0 n^* k^2 C_2,  \\\\\n\\lambda C_2 & = - D_a k^2 C_2 +  \\mu C_1 - \\delta C_2,\n\\end{aligned}\n$$\nwhich can be written\n\n$$\n\\left(\n\\begin{array}{cc}\n- D_n k^2 - \\lambda &  \\chi_0 n^* k^2 \\\\\n\\mu & - D_a k^2 -\\delta -\\lambda \n\\end{array}\n\\right) \n\\left(\n\\begin{array}{c}\nC_1 \\\\\nC_2\n\\end{array}\n\\right) = \\mathbf{0} .\n$$\n\n\n **Remark** Notice that we obtained that  $\\tilde n$ and $\\tilde a$ are of the form \n $$\\tilde{n}(x,t) = C_1 e^{\\lambda t} e^{ikx}, \\;\\;\\; \\tilde{a}(x,t) = C_2 e^{\\lambda t} e^{ikx}.$$ \n\n\nFor a non-trivial solution (for non-trivial perturbations $\\tilde n$, $\\tilde a$), i.e. $C_1 \\neq 0$ and $C_2 \\neq 0$, the determinant of the above matrix must be zero, and this leads to the following quadratic equation to be solved for $\\lambda$: \n\n$$\n\\lambda^2 + \\left( D_n k^2 + D_a k^2 + \\delta \\right) \\lambda + D_n k^2 \\left( D_a k^2 + \\delta \\right) - \\mu \\chi_0 n^* k^2 = 0.\n$$\n\nThis is of the form\n$$\n\\lambda^2 + \\alpha \\lambda + \\beta = 0,\n$$\n\nand so has roots:\n$$\n\\lambda = \\frac{-\\alpha \\pm \\sqrt{\\alpha^2 - 4 \\beta}}{2}.$$\n\n**NOTE** This has two *real* roots, since \n$$\n\\alpha^2 - 4 \\beta > 0\n$$ (see Exercise/Tutorial).\n\nFor stability, we require both roots to be negative. Since both roots are real, this leads to:\n\n$$\n\\lambda < 0  \\Leftrightarrow \\alpha > 0 \\;\\;\\; \\text{and} \\;\\;\\; \\beta >0.\n$$\n\nNow \n$$\\alpha = D_n k^2 + D_a k^2 + \\delta > 0,\n$$ \nand so for stability, we require $\\beta > 0$ i.e. \n\n$$\n\\begin{aligned}\n& & D_n k^2 \\left( D_a k^2 + \\delta \\right) - \\mu \\chi_0 n^* k^2 > 0 \\\\\n& & \\Rightarrow \\mu \\chi_0 n^* <  D_n  \\left( D_a k^2 + \\delta \\right)\n\\end{aligned}\n$$\nHence, we will have instability when this condition is not satisfied i.e. \n$$\n\\mu \\chi_0 n^* >  D_n  \\left( D_a k^2 + \\delta \\right).\n$$\n\nThe precise value of $k^2$ can be determined from the zero-flux boundary conditions i.e.\n$$ \nk  =  \\frac{m \\pi}{L}, \\;\\;\\; m = 1,2, \\dots \n$$\nif we look  for non-constant $\\phi$.\n\nHence, we will have instability whenever\n$$\n\\mu \\chi_0 n^* >  D_n  \\left( D_a \\frac{m^2 \\pi^2}{L^2} + \\delta \\right), \\;\\;\\; m = 1,2, \\dots\n$$\n\nIt can be shown (see Exercise/Tutorial), that $\\lambda (k^2)$ ( or $\\lambda (m^2)$) is monotonic decreasing and hence the fastest growing mode is $m=1$ i.e. we have an instability as long as\n$$\n\\mu \\chi_0 n^* >  D_n  \\left( \\frac{D_a \\pi^2}{L^2} + \\delta \\right).\n$$\n\nIn general, from the above inequality, we can say that there is a likelihood of instability (amoebae aggregation) if:\n\n* $D_a$, $D_n$ and $\\delta$ are all ``small''\n* L is ``large''\n* $\\chi_0 , \\mu , n^*$ are ``large''\n\nConsidering all other parameters to be fixed, in theory the above result states that it is possible to find a large enough value for the chemotactic coefficient $\\chi_0$ to satisfy the instability condition i.e. chemotaxis induces instability and leads to aggregation of the amoebae.\n\n## Exercise \nFrom the results we have obtained we deduce that:\n\n* chemotaxis has a destabilizing effect\n* diffusion has a stabilizing effect\non spatially homogeneous solutions\n\nIf this is true then one might expect the numerical results presented in @fig-bacterialchemotaxispde to have spatially homogeneous solutions if the diffusion coefficient is made sufficiently large. \n* Can you test this by running the code for larger values of the parameter $D$?\n* Alternatively, what happens if you make the chemotactic coefficient $\\chi_0$ smaller?\n* what kind of aggregation patterns do you see if the system is solved in two spatial dimensions?\n\n\nHowever, there is one type of system where diffusion also has a destabilizing effect...\n\n",
    "supporting": [
      "BacterialChemotaxis_files/figure-pdf"
    ],
    "filters": []
  }
}