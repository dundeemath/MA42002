<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.3.450" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>MA42002 – 1  Conservation equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script  src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script  src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link  href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet" />

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <h1 class="quarto-secondary-nav-title"></h1>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      MA42002
      </a> 
        <div class="sidebar-tools-main">
    <a href="/MA42002.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/conservationequations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>Conservation equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Single PDE</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/linearreactiondiffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Linear reaction diffusion equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/nonlinearreactiondiffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Non linear reaction diffusion equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Coupled PDE</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/LotkaVolteraPDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>Lotka Voltera model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/BacterialChemotaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>Aggregation via Chemotaxis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/DiffusionDrivenInstability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>6</span>  <span class='chapter-title'>Diffusion driven instability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/SIR_PDE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>7</span>  <span class='chapter-title'>SIR models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/NumericalMethods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>8</span>  <span class='chapter-title'>Numerical methods in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/linearstablityanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>9</span>  <span class='chapter-title'>Linear stability analysis of a system of nonlinear ODES</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#notation" id="toc-notation"><span class="header-section-number">1.1</span> Notation</a></li>
  <li><a href="#derivation-of-conservation-equations" id="toc-derivation-of-conservation-equations"><span class="header-section-number">1.2</span> Derivation of conservation equations</a>
  <ul>
  <li><a href="#modelling-the-growth-of-bacteria-in-a-petri-dish-flask-containing-nutrient-medium" id="toc-modelling-the-growth-of-bacteria-in-a-petri-dish-flask-containing-nutrient-medium"><span class="header-section-number">1.2.1</span> Modelling the growth of bacteria in a petri dish (flask) containing nutrient medium</a></li>
  <li><a href="#chemical-reactions" id="toc-chemical-reactions"><span class="header-section-number">1.2.2</span> Chemical reactions</a></li>
  <li><a href="#spatial-movement" id="toc-spatial-movement"><span class="header-section-number">1.2.3</span> Spatial movement</a></li>
  <li><a href="#boundary-conditions-b.c." id="toc-boundary-conditions-b.c."><span class="header-section-number">1.2.4</span> Boundary conditions (B.C.)</a></li>
  <li><a href="#initial-conditions" id="toc-initial-conditions"><span class="header-section-number">1.2.5</span> Initial conditions</a></li>
  <li><a href="#nondimensionalization" id="toc-nondimensionalization"><span class="header-section-number">1.2.6</span> Nondimensionalization</a></li>
  </ul></li>
  </ul>
</nav>
<section id="notation" class="level2" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Notation</h2>
<p>Throughout this course, we will study {} of biological systems and as such we will consider <span class="math inline">\(x \in \mathbb R^n\)</span>, <span class="math inline">\(t \in [0, \infty)\)</span> and functions <span class="math inline">\(c: \mathbb R^n \times [0, \infty) \to \mathbb R\)</span>, where <span class="math inline">\(n=1,2,3\)</span>. For example:</p>
<ul>
<li><span class="math inline">\(c(t,x)\)</span> - the density of a population [number per volume] at time <span class="math inline">\(t\)</span> and position <span class="math inline">\(x\)</span> (at <span class="math inline">\((t,x)\)</span>)</li>
<li><span class="math inline">\(c(t,x)\)</span> - the concentration of a substance (chemicals, particles) [mass per volume] at time <span class="math inline">\(t\)</span> and position <span class="math inline">\(x\)</span> (at <span class="math inline">\((t,x)\)</span>)</li>
<li><span class="math inline">\(c(t,x)\)</span> - the temperature at <span class="math inline">\((t,x)\)</span>.</li>
</ul>
</section>
<section id="derivation-of-conservation-equations" class="level2" data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span> Derivation of conservation equations</h2>
<p>A conservation equation is the most fundamental statement through which changes in the distribution of the density (or concentration, temperature) is described. <span class="math display">\[
\begin{pmatrix}
\text{rate of change}\\
\text{ in the population density}
\end{pmatrix}
= \begin{pmatrix}
\text{spatial movement}
\end{pmatrix}
+
\begin{pmatrix}
\text{birth, growth, death},\\
\text{production or degradation}\\
  \text{due to chemical reactions}
\end{pmatrix}
\]</span></p>
<p>In this introductory first section, we shall neglect spatial movement and consider examples of growth/death and chemical reactions. Spatial movement will be considered in the next section and subsequently throughout the course.</p>
<section id="modelling-the-growth-of-bacteria-in-a-petri-dish-flask-containing-nutrient-medium" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1"><span class="header-section-number">1.2.1</span> Modelling the growth of bacteria in a petri dish (flask) containing nutrient medium</h3>
<p>Bacteria are found to reproduce by undergoing successive cell divisions.</p>
<p>Denote by <span class="math inline">\(N(t)\)</span> - bacterial density observed at time <span class="math inline">\(t\)</span> [number of cells per volume].</p>
<p>Over a period of one unit time a single bacterial cell divides, then its daughter cells divide, and so forth, leading to a total of <span class="math inline">\(K\)</span> new bacterial cells.</p>
<p>Define <span class="math inline">\(K\)</span> - rate of reproduction per unit time, <span class="math inline">\(K&gt;0\)</span>, and <span id="eq-n_1"><span class="math display">\[
\begin{eqnarray}
\begin{aligned}
N(t+\Delta t) &amp;=  \quad N(t)  &amp; + \quad  &amp;K N(t) \Delta t \\
\text{ density at time } t + \Delta t &amp; \quad   \text{ density at time } t  &amp; &amp;\text{ increase in density due to}\\
&amp;&amp; &amp;\text{reproduction during}\\
&amp;&amp; &amp;\text{ the time interval } \Delta t
\end{aligned}
\end{eqnarray}
\tag{1.1}\]</span></span> Assuming that <span class="math inline">\(N\)</span> is differentiable, dividing <a href="#eq-n_1">Equation <span class="quarto-unresolved-ref">eq-n_1</span></a> by <span class="math inline">\(\Delta t\)</span> and tailing limit as <span class="math inline">\(\Delta t \to 0\)</span> imply <span class="math display">\[
\frac{dN}{dt} = K N
\]</span> {eq-N_2} The growth rate <span class="math inline">\(K\)</span> can take several forms e.g.  * <span class="math inline">\(K = \text{constant}\)</span> * <span class="math inline">\(K = K(t)\)</span> time-dependent * <span class="math inline">\(K= K(N(t))\)</span> depends on bacterial density * <span class="math inline">\(K= K(c(t)):= \kappa c(t), \;\; (\text{with} \;\; \kappa &gt;0 \;\; \text{a constant}\)</span>), which depends on the nutrient concentration <span class="math inline">\(c(t)\)</span> at time <span class="math inline">\(t\)</span> i.e. <span class="math inline">\(K\)</span> depends on the available resources</p>
<p>We denote by <span class="math inline">\(\alpha\)</span> the units of nutrients consumed during the production of one unit of population increment (Note: the quantity <span class="math inline">\(Y= 1/\alpha\)</span> is called the yield) and obtain <span id="eq-C_1"><span class="math display">\[
\begin{eqnarray}
&amp; \frac{dN}{dt} = K(c) N = \kappa \, c \, N,  &amp; \quad N(0) = N_0\label{eq:N_3}\\
&amp; \frac{ dc}{dt} = - \alpha \frac{dN}{dt} = - \alpha   \kappa \, c \, N,  &amp;\quad  c(0)= c_0
\end{eqnarray}
\tag{1.2}\]</span></span></p>
<p>We can determine the nutrient concentration by solving equation <a href="#eq-C_1">Equation <span class="quarto-unresolved-ref">eq-C_1</span></a>. We can integrate <a href="#eq-C_1">Equation <span class="quarto-unresolved-ref">eq-C_1</span></a> with respect to time and obtain <span id="eq-sol_c"><span class="math display">\[
\begin{equation}
c(t)  = - \alpha N(t) + c(0)+ \alpha N(0) = - \alpha N(t) + \beta,
\end{equation}
\tag{1.3}\]</span></span> where <span class="math inline">\(\beta=c_0 +\alpha N_0\)</span>. Using <a href="#eq-sol_c">Equation <span class="quarto-unresolved-ref">eq-sol_c</span></a> in <a href="#eq-C_1">Equation <span class="quarto-unresolved-ref">eq-C_1</span></a> we obtain an equation just for <span class="math inline">\(N\)</span> <span id="eq-N_4"><span class="math display">\[
\begin{eqnarray}
\frac{dN}{dt} = \kappa ( \beta- \alpha N)  N, \qquad  N(0)= N_0\quad  \text{logistic equation (logistic growth)}
\end{eqnarray}
\tag{1.4}\]</span></span> Here we have <span class="math inline">\(K=K(N) = \kappa (\beta - \alpha N)\)</span>.</p>
<p>The last equation can be rewritten as <span id="eq-N_5"><span class="math display">\[  
\begin{eqnarray}
\frac{dN}{dt} = \rho  N \,  (1 - \frac N B)  \qquad \quad N(0)= N_0,
\end{eqnarray}
\tag{1.5}\]</span></span> where <span class="math inline">\(\rho = \kappa \beta\)</span> is the {} and <span class="math inline">\(B = \frac \beta \alpha\)</span> is the {}. The solution of <a href="#eq-N_5">Equation <span class="quarto-unresolved-ref">eq-N_5</span></a> is given by <span class="math display">\[
N(t)= \frac{ N_0 K} { N_0 + (B-N_0) e^{-\rho t}} \; .
\]</span></p>
<p><strong>Death/decay</strong></p>
<p>In addition to growth, we may assume that cells die at rate <span class="math inline">\(d\)</span> and the simple growth <a href="#eq-N_2">Equation <span class="quarto-unresolved-ref">eq-N_2</span></a> can be generalised to <span class="math display">\[
\frac{dN}{dt} = KN - d N ,
\]</span> where <span class="math inline">\(d\)</span> is the mortality (death) rate.</p>
<p><strong>Competition</strong></p>
<p>The fact that individuals compete for food, habitat (i.e. space) or any limited resources, means that an increase in the net mortality of the population may be observed under crowded conditions <span class="math display">\[
\frac{dN}{dt} = KN - d_1 N^2 ,
\]</span> where <span class="math inline">\(d=d_1N\)</span> is the mortality (death) rate and is proportional to the population density.</p>
</section>
<section id="chemical-reactions" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2"><span class="header-section-number">1.2.2</span> Chemical reactions</h3>
<p></p>
<p>Most biochemical reactions involve proteins called {} which act as catalysts of chemical reactions. Enzymes react selectively on specific compounds called {}.</p>
<p>A substrate <span class="math inline">\(S\)</span> reacts, in a {}, with an enzyme <span class="math inline">\(E\)</span> to form a {} <span class="math inline">\(SE\)</span> or <span class="math inline">\(C\)</span>, which in turn is converted into a product <span class="math inline">\(P\)</span>. This may be described as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  S[S]--+--&gt; E(E)
  E --&gt; C{C}
  C --&gt; E
  C --&gt; D[E]
  D --&gt; P[P]
</pre>
</div>
</div>
</div>
</div>
<!--
$$
\begin{eqnarray}
S + E &\reaction{k_{-1}}{k_1}& C \;\;\;\;\; {\rm (reversible)} \nonumber \\
C & \stackrel{k_2}{\rightarrow} & P + E \nonumber 
\end{eqnarray}
$$
-->
<p>where <span class="math inline">\(k_{-1}, k_1\)</span> and <span class="math inline">\(k_2\)</span> are rate constants (<span class="math inline">\(&gt;0\)</span>) determining the rate of the reaction i.e. how fast the reaction proceeds.</p>
<p>%<span class="math inline">\(\longrightleftharpoons\)</span> - reaction is reversible</p>
<p>The law of mass action states that the rate of a reaction is proportional to the product of the concentrations of the reactants. (Note: The law of mass action is only an approximation, but it is a very good one for dilute solutions of the chemical concerned.)</p>
<p>We denote the concentrations $ [ ; ]$ as follows: <span class="math display">\[
s=[S], \quad e=[E], \quad c = [SE], \quad p =[P]
\]</span> and obtain <span class="math display">\[\begin{eqnarray}
\begin{aligned}
\frac{ds}{dt}&amp; = - k_1 es + k_{-1} c, \qquad &amp;&amp; s(0) = s_0,  \label{eq:s}\\
\frac{de}{dt} &amp;= - k_1 es + k_{-1} c + k_2 c, \qquad &amp;&amp; e(0) = e_0, \label{eq:e} \\
\frac{dc}{dt} &amp;=  k_1 es - k_{-1} c - k_2 c, \qquad &amp;&amp; c(0) = 0, \label{eq:c} \\
\frac{dp}{dt} &amp;=  k_{2} c, \qquad &amp;&amp; p(0) = p_0. \label{eq:p}
\end{aligned}
\end{eqnarray}\]</span></p>
<p>A study of this system is given in Homework 1.</p>
</section>
<section id="spatial-movement" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3"><span class="header-section-number">1.2.3</span> Spatial movement</h3>
<p>Consider a spatial domain <span class="math inline">\(V\)</span>. A conservation equation can be written either in terms of the mass or number of particles of a species as follows:</p>
<p><span class="math display">\[
\begin{pmatrix}
\text{rate of change of}\\
\text{number of particles} \\
\text{per unit time }
\end{pmatrix}
= \begin{pmatrix}
\text{rate of entry of}\\
\text{particles into $V$}\\
\text{per unit time}
\end{pmatrix}
- \begin{pmatrix}
\text{rate of exit of }\\
\text{particles from $V$}\\
\text{per unit time}
\end{pmatrix}
+
\begin{pmatrix}
\text{rate of degradation}\\
\text{or creation of particles }\\
  \text{in $V$ per unit time}
\end{pmatrix}
\]</span></p>
<section id="one-dimensional-conservation-equations" class="level4" data-number="1.2.3.1">
<h4 data-number="1.2.3.1"><span class="header-section-number">1.2.3.1</span> One-dimensional conservation equations</h4>
<p>Assume</p>
<ul>
<li>motion takes place in a one-dimensional domain (e.g. a long very thin tube)</li>
<li>the tube has a constant cross-section area</li>
</ul>
<p>Let <span class="math inline">\(x\)</span> be the distance along the tube relative to an origin. We shall consider the interval <span class="math inline">\((x, x+\Delta x)\)</span>, for some <span class="math inline">\(\Delta x &gt;0\)</span>, and a domain <span class="math inline">\(V= (x, x+ \Delta x) \times S\)</span>, where <span class="math inline">\(S\)</span> is the cross-section of the tube with the constant area <span class="math inline">\(A=|S|\)</span>.</p>
<ul>
<li><p><span class="math inline">\(c(t,x)\)</span> - concentration of particles (number of particles per unit volume) at time <span class="math inline">\(t\)</span> and position <span class="math inline">\(x\)</span></p></li>
<li><p><span class="math inline">\(J(t,x)\)</span> - flux of particles per unit time and unit area (number of particles crossing a unit area in the positive <span class="math inline">\(x\)</span>-direction per unit time)</p></li>
<li><p><span class="math inline">\(f(t,x,c(t,x))\)</span> - source/sink (number of particles created or destroyed per unit volume and unit time)</p></li>
</ul>
<p>We consider <span class="math inline">\(S\)</span> to be very small and <span class="math inline">\(c(t,x)\)</span> is assumed to be constant in <span class="math inline">\(S\)</span> (independent of <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>). We also assume that <span class="math inline">\(c\)</span> is continuously differentiable with respect to <span class="math inline">\(t\)</span>.</p>
<p>The volume of <span class="math inline">\(V\)</span> is <span class="math inline">\(A \Delta x\)</span> and number of particles is given by <span class="math display">\[
\int_x^{x+\Delta x} c(t, \tilde x) \,  d \tilde x A.
\]</span></p>
<p>Then the conservation equation for the number of particles in the volume <span class="math inline">\(V\)</span> is given by <span id="eq-concerv_01"><span class="math display">\[
\frac{\partial}{\partial t} \int_x^{x+\Delta x} c(t,\tilde x) A d\tilde x = J(t,x) \, A  - J(t,x+\Delta x) \, A +\int_x^{x + \Delta x}  f(t,\tilde x,c(t, \tilde x))\,  A \, d \tilde x.
\tag{1.6}\]</span></span></p>
<p>i.e. the flux that changes the total population in <span class="math inline">\(V\)</span> is that entering through the cross-section at <span class="math inline">\(x\)</span> and leaving through the cross-section at <span class="math inline">\(x+\Delta x\)</span> (it is assumed that there no flux through the external surface of the tube). Assuming <span class="math inline">\(c\)</span> and <span class="math inline">\(f\)</span> to be sufficiently smooth (continuous in <span class="math inline">\(x\)</span>) and applying The Mean Value Theorem in <a href="#eq-concerv_01">Equation <span class="quarto-unresolved-ref">eq-concerv_01</span></a>, we obtain <span id="eq-concerv_1"><span class="math display">\[
\frac{\partial}{\partial t} c(t,\xi) A \Delta x = J(t,x) \, A  - J(t,x+\Delta x) \, A +  f(t,\eta,c(t, \eta))\,  A \Delta x, \qquad \xi, \eta \in (x, x+ \Delta x).
\tag{1.7}\]</span></span></p>
<p>Dividing <a href="#eq-concerv_01">Equation <span class="quarto-unresolved-ref">eq-concerv_01</span></a> by <span class="math inline">\(A \, \Delta x\)</span> yields <span id="eq-concerv_2"><span class="math display">\[
\frac{\partial}{\partial t} c(t,\xi)  = - \frac  {J(t,x+\Delta x) - J(t,x)} { \Delta x} + f(t,\eta,c(t,\eta)), \qquad \xi, \eta \in (x, x+ \Delta x).
\tag{1.8}\]</span></span> Assuming that <span class="math inline">\(J\)</span> is differentiable with respect to <span class="math inline">\(x\)</span> and taking the limit as <span class="math inline">\(\Delta x \to 0\)</span> (and using the definition of partial derivatives) we obtain a one-dimensional conservation (balance) equation: <span id="eq-concerv_3"><span class="math display">\[
\frac{\partial}{\partial t} c(t,x)  = - \frac  {\partial} { \partial x} J(t,x) + f(t,x,c(t,x)).
\tag{1.9}\]</span></span></p>
</section>
<section id="conservation-equations-in-mathbb-rn" class="level4" data-number="1.2.3.2">
<h4 data-number="1.2.3.2"><span class="header-section-number">1.2.3.2</span> Conservation equations in <span class="math inline">\(\mathbb R^n\)</span></h4>
<p>Let <span class="math inline">\(V \subset \mathbb R^n\)</span> be an arbitrary bounded domain (i.e. satisfying the conditions of the divergence theorem) and let <span class="math inline">\(S\)</span> be the surface enclosing <span class="math inline">\(V\)</span>, i.e <span class="math inline">\(S = \partial V\)</span>.</p>
<ul>
<li><span class="math inline">\(c(t,x)\)</span> – concentration of particles at <span class="math inline">\(x\in V\)</span> and <span class="math inline">\(t&gt;0\)</span> (number of particles per unit volume)</li>
<li><span class="math inline">\(J(t,x)\)</span> – flux vector of particles across <span class="math inline">\(V\)</span> (number of particles per unit area and per unit time entering or leaving through <span class="math inline">\(S\)</span> (the boundary of <span class="math inline">\(V\)</span>).</li>
<li><span class="math inline">\(f(t,x,c(t,x))\)</span> - source/sink term (number of particles created or destroyed per unit volume and per unit time)</li>
</ul>
<p>Then the conservation equation reads <span class="math display">\[
\frac{\partial}{\partial t} \int_V c(t,x) \, dx = - \int_{S} J(t,x) \cdot {\bf n} \, d\sigma + \int_V f(t,x,c),
\]</span> where <span class="math inline">\(\mathbf{n}\)</span> is the outward normal vector to <span class="math inline">\(S\)</span>. The normal component of the flux <span class="math inline">\(J\)</span> on <span class="math inline">\(S\)</span> leads to a change of number of particles ( of mass ) in <span class="math inline">\(V\)</span>. Applying the divergence theorem, i.e. <span class="math display">\[
\int_S J \cdot {\bf n} \, d\sigma = \int_V \text{ div} J \, dx,
\]</span> and using the fact that <span class="math inline">\(V\)</span> is independent of time <span class="math inline">\(t\)</span> we obtain <span class="math display">\[
\int_V \Big(\frac{\partial}{\partial t} c(t,x) + \nabla \cdot  J(t,x) -  f(t,x,c)\Big) dx.
\]</span> Since <span class="math inline">\(V\)</span> can be chosen arbitrary we get the conservation equation in <span class="math inline">\(\mathbb R^n\)</span> (or a subdomain <span class="math inline">\(\Omega \subset \mathbb R^n\)</span>)</p>
<p><span id="eq-conservation_3D"><span class="math display">\[
\frac{\partial}{\partial t} c(t,x) =  - \nabla \cdot  J(t,x)+  f(t,x,c), \quad x\in \mathbb R^n \,  (\text{or } x \in \Omega), \quad t &gt;0.
\tag{1.10}\]</span></span></p>
</section>
<section id="types-of-flux-terms" class="level4" data-number="1.2.3.3">
<h4 data-number="1.2.3.3"><span class="header-section-number">1.2.3.3</span> Types of flux terms</h4>
<ul>
<li><p>Fickian Diffusion</p>
<p>Diffusion is an important and ``metabolically cheap’’ transport mechanism in biological systems. It can be also viewed as the random motion of individual molecules.</p>
<p><span id="eq-diffusion"><span class="math display">\[
{\bf J} = - D\nabla c,
\tag{1.11}\]</span></span> where <span class="math inline">\(D\)</span> is the diffusion coefficient. <span class="math inline">\(D\)</span> depends on the size of the particles, the type of solvent, the temperature, .</p>
<p>Then applying <a href="#eq-diffusion">Equation <span class="quarto-unresolved-ref">eq-diffusion</span></a> in <a href="#eq-conservation_3D">Equation <span class="quarto-unresolved-ref">eq-conservation_3D</span></a> we obtain reaction-diffusion equation <span id="eq-react-diff"><span class="math display">\[
\frac{\partial}{\partial t} c =  - \nabla\cdot ( - D \nabla c(t,x))+  f(t,x,c) = \nabla \cdot ( D \nabla c) + f(t,x,c),
\quad x\in \mathbb R^n, \,  \, t &gt;0.
\tag{1.12}\]</span></span></p>
<p>If <span class="math inline">\(D\)</span> is a constant we can write <span class="math display">\[
\frac{\partial}{\partial t} c(t,x) =  D \Delta c(t,x) + f(t,x,c),
\quad x\in \mathbb R^n \,  (\text{or } x \in \Omega), \quad t &gt;0,
\]</span><br />
where <span class="math display">\[
\Delta c = \sum\limits_{j=1}^n \dfrac{\partial^2 c}{\partial x_j^2}.
\]</span></p></li>
<li><p>Nonlinear diffusion <span class="math display">\[
D = D(c) , \qquad \text{ e.g. }\,   D(c)= D_0 c^m, \quad D_0 &gt;0,
\]</span> and <span id="eq-diff_nonlin"><span class="math display">\[
  \frac{\partial}{\partial t} c = D_0 \nabla\cdot (c^m \nabla c) + f(t,x,c),
\quad x\in \mathbb R^n,  \quad t &gt;0.
\tag{1.13}\]</span></span></p></li>
<li><p>Convection or Advection <span class="math display">\[
J = \textbf{v} c,
\]</span> where <span class="math inline">\(\textbf{v}\)</span> is a velocity vector. Hence <span id="eq-convection"><span class="math display">\[
\frac{\partial}{\partial t} c(t,x) = - \nabla\cdot (\textbf{v}(t,x) c(t,x))  + f(t,x,c),
\quad x\in \mathbb R^n,   \quad t &gt;0.
\tag{1.14}\]</span></span></p>
<p>If <span class="math inline">\(\textbf{v}\)</span> is constant or <span class="math inline">\(\nabla \cdot \textbf{v} = 0\)</span>, then <span class="math display">\[
\frac{\partial}{\partial t} c = - \textbf{v} \nabla c  + f(t,x,c)
\quad x\in \mathbb R^n, \,  \quad t &gt;0.
\]</span></p></li>
<li><p>Taxis - directed movement in response to an external chemical or physical signal.</p>
<ul>
<li>chemotaxis - movement directed by a chemical gradient</li>
<li>haptotaxis - movement directed by a gradient in density, adhesion</li>
</ul>
<p>In the presence of some chemoattractant <span class="math inline">\(a(t,x)\)</span> we have <span class="math display">\[
  {\bf J} = \chi(a) c \nabla a,  
  \]</span> where <span class="math inline">\(\chi(a)\)</span> is a `model-specific’ function of <span class="math inline">\(a\)</span> defining the sensitivity to the signal, and the conservation equation reads <span id="eq-taxis"><span class="math display">\[
  \frac{\partial}{\partial t} c(t,x) = -\nabla \cdot (\chi(a) c(t,x) \nabla a )  + f(t,x,c),
  \quad x\in \mathbb R^n \,  \quad t &gt;0 \; ,
   \tag{1.15}\]</span></span></p></li>
</ul>
<p>We can have any combination of fluxes, depending on the biological system. For example, chemotaxis and diffusion</p>
<p><span id="eq-chemotaxis"><span class="math display">\[
\begin{equation}
\frac{\partial}{\partial t} c = D \Delta c -\nabla \cdot (\chi(a) c \nabla a )  + f(t,x,c),
\quad x\in \mathbb R^n \,  \quad t &gt;0,
\end{equation}
\tag{1.16}\]</span></span> which can be augmented by an equation for the (diffusible) chemoattractant <span class="math inline">\(a\)</span> <span id="eq-chemoattrac"><span class="math display">\[
\begin{equation}
\frac{\partial}{\partial t} a = D \nabla^2 a + g(t,x,a, c),
\quad x\in \mathbb R^n \,  \quad t &gt;0.
\end{equation}
\tag{1.17}\]</span></span> <a href="#eq-chemotaxis">Equation <span class="quarto-unresolved-ref">eq-chemotaxis</span></a> and <a href="#eq-chemoattrac">Equation <span class="quarto-unresolved-ref">eq-chemoattrac</span></a> form a system of equations, a so-called chemotaxis system.</p>
</section>
</section>
<section id="boundary-conditions-b.c." class="level3" data-number="1.2.4">
<h3 data-number="1.2.4"><span class="header-section-number">1.2.4</span> Boundary conditions (B.C.)</h3>
<ul>
<li>Infinite domain (e.g. <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(\mathbb R^2\)</span>, <span class="math inline">\(\mathbb R^3\)</span> ):</li>
</ul>
<p>the density is not influenced by the boundary <span class="math display">\[
c(t,x) \to 0 \qquad \text{ as } \qquad \|x\| \to \infty \quad  \text{decay at infinity}
\]</span></p>
<ul>
<li>Periodic B.C.</li>
</ul>
<p><span class="math inline">\(L\)</span>-periodic function: <span class="math inline">\(c(t,x) = c(t,x+L)\)</span> for any <span class="math inline">\(x\)</span> in the domain</p>
<p>Consider a domain <span class="math inline">\((0,L)\)</span>. <span class="math display">\[
c(t,0) = c(t,L) \qquad  \text{ periodic boundary conditions}
\]</span></p>
<ul>
<li>Dirichlet B.C.</li>
</ul>
<p>density (concentration) is fixed at the boundary</p>
<p>In the <span class="math inline">\(1\)</span>-dim domain <span class="math inline">\((0,L)\)</span> <span class="math display">\[
c(t,0) = c_1, \quad  c(t,L) = c_2
\]</span> can consider two reservoirs placed at the ends of the domain, that are held at constant densities (concentrations) <span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span>, respectively.</p>
<p>For a domain <span class="math inline">\(\Omega\subset \mathbb R^n\)</span> we have <span class="math display">\[
c(t,x) = c_D(t,x) \qquad  x\in  \partial \Omega, \, \, t\geq 0 \; .
\]</span></p>
<ul>
<li>No-flux (homogeneous Neumann) B.C.</li>
</ul>
<p>particles cannot escape from the domain</p>
<p>For a domain <span class="math inline">\(\Omega \subset \mathbb R^n\)</span> <span class="math display">\[
D\nabla c  \cdot {\bf n}  = 0  \quad \text{ on } \quad \partial \Omega, \quad t &gt;0
\]</span> In one-dimensional domain <span class="math inline">\((0,L)\)</span> <span class="math display">\[
\frac{\partial c(t,x)}{\partial x} = 0 \quad \text{ at } \quad x=0  \text{ and } \quad x= L, \quad t &gt;0 \; ,
\]</span></p>
<ul>
<li>Non-homogeneous Neumann B.C.</li>
</ul>
<p>For a domain <span class="math inline">\(\Omega \subset \mathbb R^n\)</span> <span class="math display">\[
D\nabla c \cdot {\bf n} = g(t,x)  \quad \text{ on } \quad \partial \Omega, \quad t &gt;0
\]</span> with a given function <span class="math inline">\(g\)</span> ( <span class="math inline">\(g\)</span> can also be a constant).</p>
<p>In one-dimensional domain <span class="math inline">\((0,L)\)</span> <span class="math display">\[
D \frac{\partial c(t,x)}{\partial x} = g(t,x)  \quad \text{ at } \quad x=0  \text{ and } \quad x= L, \quad t &gt;0 \; ,
\]</span></p>
<ul>
<li>Homogeneous Robin B.C. <span class="math display">\[
D\nabla c(t,x)  \cdot {\bf n}  + k c(t,x)  = 0  \quad \text{ on } \quad \partial \Omega, \quad t &gt;0
\]</span> with some constant <span class="math inline">\(k \in \mathbb R\)</span>.</li>
</ul>
<p>In one-dimensional domain <span class="math inline">\((0,L)\)</span> <span class="math display">\[
D \frac{\partial c(t,x)}{\partial x}  + k c(t,x) = 0  \quad \text{ at } \quad x=0  \text{ and } \quad x= L, \quad t &gt;0 \; ,
\]</span></p>
<ul>
<li>Non-homogeneous Robin B.C. <span class="math display">\[
D\nabla c(t,x)  \cdot {\bf n}  + k c(t,x)  = g(t,x)  \quad \text{ on } \quad \partial \Omega, \quad t &gt;0
\]</span> with some constant <span class="math inline">\(k \in \mathbb R\)</span> and given function <span class="math inline">\(g\)</span> ( <span class="math inline">\(g\)</span> can also be a constant).</li>
</ul>
<p>In one-dimensional domain <span class="math inline">\((0,L)\)</span> <span class="math display">\[
D \frac{\partial c(t,x)}{\partial x}  + k c(t,x) = g(t,x)  \quad \text{ at } \quad x=0  \text{ and } \quad x= L, \quad t &gt;0 \; ,
\]</span></p>
<p> We can also have different types of boundary conditions at different parts of the boundary of the considered domain.</p>
</section>
<section id="initial-conditions" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5"><span class="header-section-number">1.2.5</span> Initial conditions</h3>
<p>For a conservation equation defined in a domain <span class="math inline">\(\Omega \subset \mathbb R^n\)</span>, <span class="math inline">\(n=1,2,3\)</span>, additionally to boundary conditions we need to define an initial concentration, i.e. initial condition <span class="math display">\[
c(0,x) = c_0(x) , \qquad x \in \Omega  \; .
\]</span></p>
</section>
<section id="nondimensionalization" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6"><span class="header-section-number">1.2.6</span> Nondimensionalization</h3>
<p>The variables and parameters in a biological or physical model have units:</p>
<ul>
<li><span class="math inline">\(\#\textrm{velocity} = \dfrac{\#\text{length }}{\#\text{time}}\)</span></li>
<li><span class="math inline">\(\# \textrm{concentration} = \dfrac{ \text{num.moles}}{\#\text{volume}}\)</span></li>
<li><span class="math inline">\(\#\text{density} = \dfrac{\text{number of particles}}{\# \text{volume}}\)</span></li>
<li><span class="math inline">\(\#\text{diffusion coefficient} = \dfrac{\#\text{length}^2}{\#\text{time}}\)</span></li>
<li><span class="math inline">\(\#\text{source/sink (reaction term)} = \dfrac{\#\text{concentration (or density)}}{\#\text{time}}\)</span></li>
<li><span class="math inline">\(\#\text{flux} = \dfrac{\text{mass (number) of particles}}{\#\text{area} \times \# \text{time}}\)</span></li>
</ul>
<p>It is standard to non-dimensionalize a system of differential equations by scaling or non-dimensionalizing both the dependent and independent variables in the model.</p>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">MA42002</span> <span class="hidden" data-render-id="quarto-int-navbar-title">MA42002</span> <span class="hidden" data-render-id="quarto-int-next"><span class="chapter-number">2</span>  <span class="chapter-title">Linear reaction diffusion equations</span></span> <span class="hidden" data-render-id="quarto-int-prev">Preface</span> <span class="hidden" data-render-id="quarto-int-sidebar:/index.html">Preface</span> <span class="hidden" data-render-id="quarto-int-sidebar:/conservationequations.html"><span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-1">Single PDE</span> <span class="hidden" data-render-id="quarto-int-sidebar:/linearreactiondiffusion.html"><span class="chapter-number">2</span>  <span class="chapter-title">Linear reaction diffusion equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/nonlinearreactiondiffusion.html"><span class="chapter-number">3</span>  <span class="chapter-title">Non linear reaction diffusion equations</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-2">Coupled PDE</span> <span class="hidden" data-render-id="quarto-int-sidebar:/LotkaVolteraPDE.html"><span class="chapter-number">4</span>  <span class="chapter-title">Lotka Voltera model</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/BacterialChemotaxis.html"><span class="chapter-number">5</span>  <span class="chapter-title">Aggregation via Chemotaxis</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/DiffusionDrivenInstability.html"><span class="chapter-number">6</span>  <span class="chapter-title">Diffusion driven instability</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/SIR_PDE.html"><span class="chapter-number">7</span>  <span class="chapter-title">SIR models</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-3">Appendices</span> <span class="hidden" data-render-id="quarto-int-sidebar:/NumericalMethods.html"><span class="chapter-number">8</span>  <span class="chapter-title">Numerical methods in Python</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/linearstablityanalysis.html"><span class="chapter-number">9</span>  <span class="chapter-title">Linear stability analysis of a system of nonlinear ODES</span></span> <span class="hidden" data-render-id="quarto-breadcrumbs-f96e03643b4a3fd567e31a5a08ceb5b8"><span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">MA42002 - <span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span> <span class="hidden" data-render-id="quarto-twittercardtitle">MA42002 - <span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span> <span class="hidden" data-render-id="quarto-ogcardtitle">MA42002 - <span class="chapter-number">1</span>  <span class="chapter-title">Conservation equations</span></span> <span class="hidden" data-render-id="quarto-metasitename">MA42002</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
</section>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/linearreactiondiffusion.html" class="pagination-link">
        <span class="nav-page-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Linear reaction diffusion equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->

</body>

</html>